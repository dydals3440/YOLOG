---
title: ë¦¬ì•¡íŠ¸ì—ì„œ DTOê°€ í•„ìš”í•œ ì´ìœ 
date: 2025-12-14
updatedDate: 2025-12-14
tags:
  [
    React,
    TypeScript,
    DTO,
    Data Transfer Object,
    API,
    í”„ë¡ íŠ¸ì—”ë“œ ì•„í‚¤í…ì²˜,
    TanStack Query,
    Zod,
    ts-pattern,
  ]
category: DEVELOPMENT
image: '/images/frontend-dto/thumbnail.webp'
---

# ë¦¬ì•¡íŠ¸ì—ì„œ DTOê°€ í•„ìš”í•œ ì´ìœ 

`DTO(Data Transfer Object)` - ë°ì´í„° ì „ì†¡ ê°ì²´ë¼ê³  ë¶ˆë¦¬ëŠ” ì´ ìš©ì–´ëŠ” ë°±ì—”ë“œ ê°œë°œì—ì„œëŠ” í•„ìˆ˜ì ì¸ ìš”ì†Œì´ë‹¤.

ì ì¬ì ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë˜ì–´ ìˆëŠ” ë‚  ê²ƒ, ë¯¼ê°í•œ ë°ì´í„°ë¥¼ ì•ˆì „í•˜ê²Œ ì†Œë¹„í•  ìˆ˜ ìˆëŠ” êµ¬ì¡°ë¡œ ë³€í™˜í•˜ëŠ” ìˆ˜ë‹¨ ì—­í• ì„ í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

ì´ë²ˆ ê¸€ì—ì„œëŠ” í”„ë¡ íŠ¸ì—”ë“œì—ì„œë„ DTOê°€ í•„ìš”í•œ ì´ìœ ë¥¼ ì„¤ëª…í•œë‹¤. ê·¸ë¦¬ê³  ë°±ì—”ë“œì˜ DTOì™€ í”„ë¡ íŠ¸ì—”ë“œì˜ DTOëŠ” ëª©ì ì´ ë‹¤ë¥´ë‹¤ëŠ” ì ë„ í•¨ê»˜ ë‹¤ë£¬ë‹¤.

ë‹¨, í”„ë¡ íŠ¸ì—”ë“œì—ì„œ DTOë¥¼ ì“°ëŠ” ì´ìœ ëŠ” ì„œë²„ì™€ ë¹„ìŠ·í•œ ë³´ì•ˆì„ ìœ„í•œ ê²ƒì´ ì•„ë‹ˆë‹¤. ì–´ì°¨í”¼ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë‹¤ë£¨ëŠ” ë°ì´í„°ëŠ” ëŒ€ë¶€ë¶„ Publicí•˜ë‹¤.

í•µì‹¬ì€ **ì„œë²„ ì‘ë‹µì„ í”„ë¡ íŠ¸ì—”ë“œê°€ ì“°ê¸° í¸í•œ í˜•íƒœë¡œ ë³€í™˜**í•˜ëŠ” ê²ƒì´ë‹¤.

---

## ì˜ë§Œë“  ë°±ì—”ë“œ DTOì— í”„ë¡ íŠ¸ì—”ë“œ DTO ì–¹ê¸°

> ë°±ì—”ë“œì—ì„œ ì´ë¯¸ DTOë¥¼ ë§Œë“¤ì–´ì„œ ë‚´ë ¤ì£¼ëŠ”ë°, í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë˜ DTOë¥¼ ë§Œë“¤ë¼ê³ ?
> `DB Entity` â†’ `Backend DTO` â†’ `Frontend DTO` (???)

ì²˜ìŒì—ëŠ” ì´ëŸ° ì˜ë¬¸ì´ ë“¤ ê²ƒì´ë‹¤.

> ì–´ì°¨í”¼, ë°±ì—”ë“œì˜ ì‘ë‹µë“¤ì€ ëŒ€ë¶€ë¶„ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì“°ê¸° ì¢‹ì€ í˜•íƒœë¡œ ë³€í™˜ë˜ì–´ ë‚´ë ¤ì˜¤ëŠ”ë°, í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë˜ DTOë¥¼ ë§Œë“¤ë¼ê³ ?

ë¬¼ë¡  ê°„ë‹¨í•œ ì„œë¹„ìŠ¤ì˜ ê²½ìš° ê·¸ëŸ´ ìˆ˜ ìˆë‹¤. ë°±ì—”ë“œ DTOëŠ” `"DB ë°ì´í„°ë¥¼ API ì‘ë‹µìš©ìœ¼ë¡œ ë³€í™˜"`í•œ ê²ƒì´ê³ , í”„ë¡ íŠ¸ì—”ë“œ DTOëŠ” `"API ì‘ë‹µì„ UIì—ì„œ ì“°ê¸° ì¢‹ê²Œ ë³€í™˜"`í•˜ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ í•œë‹¤.

ì—„ì—°íˆ ë‘˜ì˜ ëª©ì ì´ ë‹¤ë¥´ë‹¤.

íŠ¹íˆë‚˜ ì²˜ìŒ ë¦¬ì•¡íŠ¸ë¥¼ ë°°ìš°ê±°ë‚˜, ë¬´ì—‡ì¸ê°€ ì´ëŸ° ì„¤ê³„ì— ëŒ€í•´ ê¹Šê²Œ ê³ ë¯¼í•˜ì§€ ì•Šì•˜ë”ë¼ë©´ í•œ ë²ˆ ì´ìƒì€ **ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ê°€ëŠ¥í•œ ëª¨ë“  ìƒíƒœë¥¼ ì²˜ë¦¬í•˜ë ¤ë‹¤ê°€ ì‹¤ìˆ˜**ë¥¼ ì €ì§€ë¥¸ë‹¤.

### ì´ëŸ° ì½”ë“œë¥¼ ë³¸ ì  ìˆì„ ê²ƒì´ë‹¤

```tsx
// API ì‘ë‹µ ê·¸ëŒ€ë¡œ ì‚¬ìš©
const GrandParent = () => {
  const { data: user } = useQuery({ queryKey: ['user'], queryFn: fetchUser });

  // íŒŒìƒ ë¡œì§ 1
  const fullName = `${user.firstName} ${user.lastName}`;

  return <Parent user={user} fullName={fullName} />;
};

const Parent = ({ user, fullName }) => {
  // íŒŒìƒ ë¡œì§ 2 (ë˜ ê³„ì‚°)
  const balance = `${user.balanceRaw.toLocaleString()}ì›`;

  return <Child user={user} fullName={fullName} balance={balance} />;
};

const Child = ({ user, fullName, balance }) => {
  // íŒŒìƒ ë¡œì§ 3 (ë˜...)
  const isNewUser = Date.now() - new Date(user.createdAt).getTime() < 604800000;

  return (
    <div>
      {fullName} {balance} {isNewUser && 'ğŸ†•'}
    </div>
  );
};
```

ì´ëŸ° ì¼ì´ ë°œìƒí•œë‹¤.

ë¬¼ë¡ , ì§€ê¸ˆ ìœ„ì˜ ì˜ˆì‹œì²˜ëŸ¼ ì»´í¬ë„ŒíŠ¸ ì•ˆì—ì„œ ìƒíƒœë¥¼ íŒŒìƒ(derive)í•˜ëŠ” ê²Œ ë¬´ì¡°ê±´ ì˜ëª»ëœ ê±´ ì•„ë‹ˆë‹¤.

ë‹¤ë§Œ, **DTOë¥¼ ì‚¬ìš©í•˜ê¸° ì‹œì‘í•˜ë©´ ì´ëŸ° ì‘ì—…ì„ ìµœì†Œí™”**í•  ìˆ˜ ìˆë‹¤. ìœ„ ì½”ë“œë¥¼ ë‹¤ì‹œ ë³´ë©´:

1. `GrandParent` ì»´í¬ë„ŒíŠ¸ì—ì„œ `fullName`ì„ íŒŒìƒí•´ì„œ `Parent`ë¡œ ë„˜ê¸´ë‹¤
2. `Parent`ëŠ” `balance`ë¥¼ íŒŒìƒí•´ì„œ `Child`ë¡œ ë„˜ê¸´ë‹¤
3. `Child`ëŠ” `isNewUser`ë¥¼ ë˜ íŒŒìƒí•œë‹¤

ê·¸ëŸ°ë° ë‹¤ë¥¸ ê³³ì—ì„œë„ `fullName`ì´ í•„ìš”í•˜ë‹¤ë©´? `balance`ê°€ í•„ìš”í•˜ë‹¤ë©´?

ë³´í†µì€ **ì¬ì‚¬ìš© ê°€ëŠ¥í•œ í•¨ìˆ˜**ë¥¼ ë§Œë“¤ê±°ë‚˜ **ì»¤ìŠ¤í…€ í›…**ì„ ë§Œë“¤ ê²ƒì´ë‹¤.
í•˜ì§€ë§Œ íŒŒìƒí•´ì•¼ í•  ë°ì´í„° ì¡°ê°ë§ˆë‹¤ ì´ëŸ° ì§“ì„ í•˜ê¸° ì‹œì‘í•˜ë©´:

**1. ìˆ˜ë°± ê°œì˜ ìœ í‹¸ í•¨ìˆ˜ê°€ ì‚¬ë°©ì— í©ì–´ì§„ë‹¤**

```ts
// utils/user.ts, utils/format.ts, utils/date.ts, hooks/useIsNewUser.ts...
```

**2. í•¨ìˆ˜ ì´ë¦„ì„ ëŠì„ì—†ì´ ê¸°ì–µí•´ì•¼ í•œë‹¤**

```ts
// getFullName? getUserName? formatUserName?
import { ??? } from 'utils/user';
```

**3. í”„ë¡œì íŠ¸ì˜ ê°€ë…ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì´ ë§ê°€ì§„ë‹¤**

```ts
import { getFullName } from 'utils/user';
import { formatBalance } from 'utils/format';
import { isNewUser } from 'utils/date';
import { useUserStatus } from 'hooks/useUserStatus';
// ...
```

**4. ì‹œì„ ì˜ ë¶„ì‚°ì´ ê°œë°œìë¥¼ ì§€ì¹˜ê²Œ í•œë‹¤**

```
utils/user.ts â†’ utils/format.ts â†’ hooks/useIsNewUser.ts â†’ ...
```

íŒŒì¼ì„ ê³„ì† ì˜¤ê°€ë©° í™•ì¸í•´ì•¼ í•˜ëŠ” ê±´ ìƒê°ë³´ë‹¤ í° ì¸ì§€ ë¶€í•˜ê³  í”„ë¡œì íŠ¸ê°€ ì»¤ì§ˆìˆ˜ë¡ **ê°œë°œìì—ê²Œ í° í”¼ë¡œê°**ì„ ì¤€ë‹¤.

ê´€ë ¨ëœ ë¡œì§ì€ **í•œ ê³³ì— ì‘ì§‘**ë˜ì–´ ìˆì„ ìˆ˜ë¡ **ê°™ì´ ì¼í•˜ëŠ” ë™ë£Œë“¤ì´ ì½”ë“œë¥¼ ì´í•´í•˜ê³  ìˆ˜ì •í•˜ê¸° ì‰½ë‹¤.** í•˜ì§€ë§Œ í˜„ì‹¤ì—ì„œëŠ” ì´ë ‡ê²Œ íŒŒì¼ì´ í©ì–´ì§€ëŠ” ê²½ìš°ê°€ ë§ë‹¤:

```typescript
// utils/user.ts
export const getFullName = (user: User) => `${user.firstName} ${user.lastName}`;

// utils/format.ts
export const formatBalance = (raw: number) => `${raw.toLocaleString()}ì›`;

// hooks/useIsNewUser.ts
export const useIsNewUser = (createdAt: string) => {
  return Date.now() - new Date(createdAt).getTime() < 604800000;
};

// utils/avatar.ts
export const getAvatarUrl = (user: User) => user.avatar_url ?? '/default.png';

// ... ê·¸ë¦¬ê³  ì´ëŸ° íŒŒì¼ë“¤ì´ ìˆ˜ì‹­ ê°œ ìƒê¸´ë‹¤
```

---

## ëŸ°íƒ€ì„ ê²€ì¦ì„ ê³ ë ¤í•˜ì

ì™¸ë¶€ ì†ŒìŠ¤ì—ì„œ ì˜¤ëŠ” ë°ì´í„°ëŠ” ëŸ°íƒ€ì„ì— ê²€ì¦(validate)í•˜ë©´ ë” ì•ˆì „í•œ ì„œë¹„ìŠ¤ë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆë‹¤. [Zod](https://github.com/colinhacks/zod) ê°™ì€ ìŠ¤í‚¤ë§ˆ ê²€ì¦ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.

`OpenAPI ìë™ ìƒì„± íƒ€ì…`ì´ë“ , `GraphQL Codegen`ì´ë“  ë§ˆì°¬ê°€ì§€ë‹¤. íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ íƒ€ì…ì€ ì»´íŒŒì¼ íƒ€ì„ì—ë§Œ ì¡´ì¬í•˜ê³ , **ëŸ°íƒ€ì„ì—ëŠ” ì•„ë¬´ê²ƒë„ ë³´ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤.**

ë‹¨, ì£¼ì˜í•  ì ì´ ìˆë‹¤. Zodì˜ `parse()`ëŠ” ê²€ì¦ ì‹¤íŒ¨ ì‹œ `ZodError`ë¥¼ ë˜ì§€ê¸° ë•Œë¬¸ì—, ì œëŒ€ë¡œ í•¸ë“¤ë§í•˜ì§€ ì•Šìœ¼ë©´ ì•±ì´ ê¹¨ì§ˆ ìˆ˜ ìˆë‹¤.

ì•±ì„ ê¹¨ëœ¨ë¦¬ì§€ ì•Šìœ¼ë ¤ë©´ `safeParse()`ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜, ì—ëŸ¬ ë°”ìš´ë”ë¦¬ë¡œ ê°ì‹¸ëŠ” ê²ƒì´ ì¢‹ë‹¤.

ê·¸ëŸ¼ì—ë„ ëŸ°íƒ€ì„ ê²€ì¦ì´ ìœ ìš©í•œ ì´ìœ ëŠ” **ë²„ê·¸ê°€ ë°œìƒí–ˆì„ ë•Œ ì›ì¸ì„ ì¦‰ì‹œ íŒŒì•…**í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.

- ìŠ¤í‚¤ë§ˆê°€ í‹€ë ¸ëŠ”ì§€
- íƒ€ì…ì´ ë¬¸ì œì¸ì§€
- ì„œë²„ê°€ íŠ¹ì • ìƒí™©ì—ì„œ ì‹¤íŒ¨í•˜ëŠ”ì§€

ëŸ°íƒ€ì„ ì²´í¬ì™€ ë¡œê¹…ì´ ê°–ì¶°ì ¸ ìˆë‹¤ë©´, ë²„ê·¸ë¥¼ ì¡ê¸°ê°€ í›¨ì”¬ ì‰¬ì›Œì§„ë‹¤.

---

## API ì‘ë‹µì˜ ë¬¸ì œì ë“¤

### schemas.ts - API ì‘ë‹µ ì •ì˜

```typescript
import { z } from 'zod';

export const UserResponseSchema = z.object({
  id: z.string(),
  firstName: z.string(),
  lastName: z.string(),
  email: z.string(),

  // ë¬¸ì œ 1: undefined | null ë‘˜ ë‹¤ ê°€ëŠ¥
  bio: z.string().nullish(),
  avatar_url: z.string().nullish(),

  // ë¬¸ì œ 2: snake_case
  created_at: z.string(),
  is_verified: z.boolean(),

  // ë¬¸ì œ 3: ìˆ«ìë§Œ ì €ì¥ (í‘œì‹œí•  ë•Œë§ˆë‹¤ í¬ë§· í•„ìš”)
  balance_raw: z.number(),

  // ë¬¸ì œ 4: roleì— ë”°ë¼ ë‹¤ë¥¸ í•„ë“œê°€ ì¡´ì¬
  role: z.enum(['user', 'admin', 'moderator']),
  admin_since: z.string().nullish(), // adminë§Œ ì¡´ì¬
  moderated_posts: z.number().nullish(), // moderatorë§Œ ì¡´ì¬
});

export type UserResponse = z.infer<typeof UserResponseSchema>;
```

### ì–´ë–¤ ë¬¸ì œë“¤ì´ ìˆë‚˜?

#### 1. Nullish ê°’ë“¤ (`undefined | null`)

`bio`, `avatar_url`ì´ `nullish`í•˜ë‹¤. ì¦‰ `undefined`ë‚˜ `null`ì¼ ìˆ˜ ìˆë‹¤ëŠ” ëœ»ì¸ë°, ì´ê±´ ì‘ì—…í•˜ê¸° ì •ë§ ê·€ì°®ë‹¤. ê·¸ëƒ¥ `null`ë¡œ ì •ê·œí™”(normalize)í•˜ëŠ” ê²Œ ì¢‹ë‹¤.

**ì™œ ì´ëŸ° ì¼ì´ ìƒê¸°ëŠ”ê°€?**

Swagger(OpenAPI)ì—ì„œ í•„ë“œë¥¼ ì •ì˜í•  ë•Œ ë‘ ê°€ì§€ ì†ì„±ì´ ìˆë‹¤:

- `required: false` â†’ í•„ë“œê°€ ì•„ì˜ˆ ì—†ì„ ìˆ˜ ìˆìŒ â†’ **undefined**
- `nullable: true` â†’ í•„ë“œëŠ” ìˆì§€ë§Œ ê°’ì´ nullì¼ ìˆ˜ ìˆìŒ â†’ **null**

```yaml
# Swagger ì •ì˜ ì˜ˆì‹œ
bio:
  type: string
  nullable: true # null ê°€ëŠ¥
# requiredì— bioê°€ ì—†ìŒ  # í•„ë“œ ìì²´ê°€ ì—†ì„ ìˆ˜ë„ ìˆìŒ
```

ê²°ê³¼ì ìœ¼ë¡œ í”„ë¡ íŠ¸ì—”ë“œì—ì„œëŠ” `string | null | undefined` íƒ€ì…ì„ ë°›ê²Œ ëœë‹¤. ë°±ì—”ë“œ í”„ë ˆì„ì›Œí¬ë§ˆë‹¤, ìƒí™©ë§ˆë‹¤ ì–´ë–¤ ê°’ì´ ì˜¬ì§€ ì˜ˆì¸¡í•˜ê¸° ì–´ë µë‹¤.

**ì™œ ê·€ì°®ì€ê°€?**

```tsx
// ğŸ˜« undefinedì™€ null ë‘˜ ë‹¤ ì²´í¬í•´ì•¼ í•¨
{
  user.bio !== undefined && user.bio !== null && <p>{user.bio}</p>;
}

// ë˜ëŠ” ëŠìŠ¨í•œ ë¹„êµ ì‚¬ìš© (lint ê²½ê³  ë°œìƒí•  ìˆ˜ ìˆìŒ)
{
  user.bio != null && <p>{user.bio}</p>;
}
```

ê·¸ë¦¬ê³  `JSON.stringify` ë™ì‘ë„ ë‹¤ë¥´ë‹¤:

```typescript
JSON.stringify({ a: undefined, b: null });
// ê²°ê³¼: '{"b":null}'  â† undefinedëŠ” ì•„ì˜ˆ ì‚¬ë¼ì§!
```

ì´ëŸ° ë¶ˆì¼ì¹˜ê°€ ë²„ê·¸ì˜ ì›ì¸ì´ ëœë‹¤. **DTOì—ì„œ `?? null`ë¡œ ì •ê·œí™”**í•˜ë©´:

```tsx
// ğŸ˜Š nullë§Œ ì²´í¬í•˜ë©´ ë¨
{
  user.bio && <p>{user.bio}</p>;
}
```

#### 2. snake_case vs camelCase

APIì—ì„œëŠ” `created_at`, `is_verified`, `avatar_url` ê°™ì€ snake_caseë¥¼ ì“°ëŠ”ë°, í”„ë¡ íŠ¸ì—”ë“œ ì»¨ë²¤ì…˜ì€ ë³´í†µ camelCaseë‹¤.

#### 3. í‘œì‹œí•  ë•Œë§ˆë‹¤ ë³€í™˜ í•„ìš”

`balance_raw`ëŠ” ìˆ«ìë§Œ ì €ì¥ë˜ì–´ ìˆë‹¤. í™”ë©´ì— í‘œì‹œí•  ë•Œë§ˆë‹¤ `toLocaleString() + "ì›"` í¬ë§·íŒ…ì„ í•´ì•¼ í•œë‹¤.

#### 4. ì¡°ê±´ë¶€ í•„ë“œ

- `admin_since`: adminì¼ ë•Œë§Œ ì˜ë¯¸ ìˆìŒ
- `moderated_posts`: moderatorì¼ ë•Œë§Œ ì˜ë¯¸ ìˆìŒ

ì´ëŸ° ê±´ **APIì—ì„œ ì‰½ê²Œ í‘œí˜„í•  ìˆ˜ ì—†ê³ **, ê²°êµ­ í´ë¼ì´ì–¸íŠ¸ì—ì„œ `êµ¬ë³„ëœ ìœ ë‹ˆì˜¨(Discriminated Unions)`ìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼ í•œë‹¤.

**ì™œ APIì—ì„œ í‘œí˜„í•˜ê¸° ì–´ë ¤ìš´ê°€?**

APIëŠ” ë³´í†µ ì´ë ‡ê²Œ ì‘ë‹µí•œë‹¤:

```json
// ì¼ë°˜ ìœ ì €
{
  "id": "123",
  "role": "user",
  "admin_since": null,
  "moderated_posts": null
}

// ê´€ë¦¬ì
{
  "id": "456",
  "role": "admin",
  "admin_since": "2024-01-15",
  "moderated_posts": null
}
```

**ëª¨ë“  ìœ ì €ì—ê²Œ ëª¨ë“  í•„ë“œê°€ í•­ìƒ ì¡´ì¬**í•œë‹¤. ì¼ë°˜ ìœ ì €ì¸ë° `admin_since: null`ì´ ìˆê³ , adminì¸ë° `moderated_posts: null`ì´ ìˆë‹¤.

**ì˜ë¯¸ì˜ ëª¨í˜¸í•¨**: `admin_since: null`ì´ ë­˜ ì˜ë¯¸í• ê¹Œ?

- "ì´ ì‚¬ëŒì€ adminì´ ì•„ë‹ˆë¼ì„œ í•´ë‹¹ ì—†ìŒ"?
- "ì´ ì‚¬ëŒì€ adminì¸ë° ì•„ì§ ë‚ ì§œê°€ ì„¤ì •ë˜ì§€ ì•ŠìŒ"?

APIë§Œ ë³´ê³ ëŠ” êµ¬ë¶„ì´ ì•ˆ ëœë‹¤.

**íƒ€ì…ì˜ í•œê³„**: API ìŠ¤í‚¤ë§ˆ(OpenAPI, GraphQL ë“±)ì—ì„œëŠ” ì´ë ‡ê²Œë°–ì— í‘œí˜„ ëª»í•œë‹¤:

```typescript
admin_since: string | null;
moderated_posts: number | null;
```

"roleì´ adminì¼ ë•Œë§Œ admin_sinceê°€ ì¡´ì¬í•œë‹¤"ëŠ” **ì¡°ê±´ë¶€ ê´€ê³„**ë¥¼ íƒ€ì…ìœ¼ë¡œ í‘œí˜„í•  ë°©ë²•ì´ ì—†ë‹¤.

**í´ë¼ì´ì–¸íŠ¸ì˜ ë¶€ë‹´**: ê²°êµ­ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì´ëŸ° ë°©ì–´ ì½”ë“œê°€ ìƒê¸´ë‹¤:

```tsx
// ë§¤ë²ˆ ì´ëŸ° ë°©ì–´ ì½”ë“œë¥¼ ì¨ì•¼ í•¨
{
  user.role === 'admin' && user.admin_since && (
    <span>Admin since {user.admin_since}</span>
  );
}
```

`role === 'admin'`ì´ë©´ `admin_since`ê°€ **ë°˜ë“œì‹œ ìˆë‹¤**ëŠ” ê±¸ ì•Œì§€ë§Œ, íƒ€ì… ì‹œìŠ¤í…œì€ ëª¨ë¥¸ë‹¤. ê·¸ë˜ì„œ `&& user.admin_since`ë¥¼ ë˜ ì²´í¬í•´ì•¼ í•œë‹¤.

---

## í•´ê²°ì±…: DTO ë³€í™˜

### íƒ€ì… ì´ë¦„ì€ ì‚¬ìš©ì ê´€ì ìœ¼ë¡œ

API í•„ë“œì™€ DTO í•„ë“œê°€ ì¼ëŒ€ì¼ë¡œ ë§¤ì¹­ë  í•„ìš”ëŠ” ì—†ë‹¤.

- **API**: ë°ì´í„° ì €ì¥/ì²˜ë¦¬ ê´€ì  (`balance_raw: 150000`, `created_at: "2024-01-15T..."`)
- **DTO**: ì‚¬ìš©ìê°€ í™”ë©´ì—ì„œ ì¸ì‹í•˜ëŠ” í˜•íƒœ (`balance: "150,000ì›"`, `isNewUser: true`)

APIì˜ `balance_raw`ëŠ” ì„œë²„ê°€ ì •ìˆ˜ë¡œ ê¸ˆì•¡ì„ ë‹¤ë£¨ê¸° í¸í•˜ê²Œ ì„¤ê³„ëœ ê²ƒì´ë‹¤. í•˜ì§€ë§Œ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë§¤ë²ˆ `toLocaleString()`ì„ í˜¸ì¶œí•˜ê³  ì‹¶ì§€ëŠ” ì•Šë‹¤. DTOì—ì„œ `balance: "150,000ì›"`ìœ¼ë¡œ ë³€í™˜í•´ë‘ë©´, ì»´í¬ë„ŒíŠ¸ëŠ” ê·¸ëƒ¥ `{user.balance}`ë§Œ ë Œë”ë§í•˜ë©´ ëœë‹¤.

íƒ€ì…ê³¼ í•„ë“œ ì´ë¦„ì€ **ì‚¬ìš©í•˜ëŠ” ê°œë°œì ê´€ì **ìœ¼ë¡œ ì§“ëŠ” ê²Œ ìœ ì§€ë³´ìˆ˜ì— ì¢‹ë‹¤.

### ëª…ëª©ì  íƒ€ì… (Branded Types)

ë¨¼ì € ID íƒ€ì…ì„ êµ¬ë¶„í•˜ì.

```ts
// ë¸Œëœë“œ íƒ€ì… ì •ì˜
type UserId = string & { readonly __brand: unique symbol }; // [!code highlight]
type PostId = string & { readonly __brand: unique symbol }; // [!code highlight]

const UserId = (id: string): UserId => id as UserId;
const PostId = (id: string): PostId => id as PostId;

// í•¨ìˆ˜ëŠ” UserIdë§Œ ë°›ìŒ
function deleteUser(userId: UserId) {
  /* ... */
} // [!code highlight]
function deletePost(postId: PostId) {
  /* ... */
} // [!code highlight]
```

ì™œ í•„ìš”í• ê¹Œ? ì¼ë°˜ `string`ì„ ì“°ë©´ **íƒ€ì… ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤**:

```ts
// âŒ ì¼ë°˜ string - íƒ€ì… ì—ëŸ¬ê°€ ì•ˆ ë‚¨
deleteUser('user-123'); // [!code error]
deleteUser('post-456'); // [!code error]
// userIdì¸ì§€ postIdì¸ì§€ êµ¬ë¶„ ë¶ˆê°€, ì‹¤ìˆ˜ë¡œ postIdë¥¼ ë„£ì–´ë„ ì—ëŸ¬ ì—†ìŒ!
```

ëª…ëª©ì  íƒ€ì…ì„ ì“°ë©´ **ì˜ëª»ëœ IDë¥¼ ë„˜ê¸°ë©´ ì»´íŒŒì¼ ì—ëŸ¬**ê°€ ë‚œë‹¤:

```ts
// âœ… ëª…ëª©ì  íƒ€ì… - íƒ€ì… ì—ëŸ¬ë¡œ ì‹¤ìˆ˜ ë°©ì§€
deleteUser(UserId('user-123')); // [!code highlight]
deleteUser(PostId('post-456')); // [!code error]
// íƒ€ì… ì—ëŸ¬! PostIdëŠ” UserIdì— í• ë‹¹ ë¶ˆê°€
```

ìºì‹œë¥¼ ì—…ë°ì´íŠ¸í•  ë•Œ ì˜ëª»ëœ IDë¥¼ ë„˜ê²¨ì„œ ë²„ê·¸ë¥¼ ë§Œë“œëŠ” ì¼ì´ ìƒê°ë³´ë‹¤ ë§ë‹¤. **íƒ€ì… ë ˆë²¨ì—ì„œ ë²„ê·¸ë¥¼ ìµœì†Œí™”í•  ìˆ˜ ìˆë‹¤ë©´ í•´ì•¼ í•œë‹¤.**

### êµ¬ë³„ëœ ìœ ë‹ˆì˜¨ (Discriminated Unions)

roleì— ë”°ë¼ ë‹¤ë¥¸ íƒ€ì…ì„ ì •ì˜í•˜ì:

```typescript
type BaseUserDTO = {
  id: UserId;
  fullName: string;
  email: string;
  bio: string | null;
  avatarUrl: string | null;
  createdAt: Date;
  isVerified: boolean;
  balance: string; // ì´ë¯¸ "150,000ì›" í˜•íƒœë¡œ ë³€í™˜ë¨
  isNewUser: boolean;
};

type RegularUserDTO = BaseUserDTO & {
  role: 'user';
};

type AdminDTO = BaseUserDTO & {
  role: 'admin';
  adminSince: Date;
  canBanUsers: true;
  canDeletePosts: true;
};

type ModeratorDTO = BaseUserDTO & {
  role: 'moderator';
  moderatedPosts: number;
  canDeletePosts: true;
  canBanUsers: false;
};

export type UserDTO = RegularUserDTO | AdminDTO | ModeratorDTO;
```

ì´ì œ ì»´í¬ë„ŒíŠ¸ì—ì„œ:

```tsx
function UserActions({ user }: { user: UserDTO }) {
  if (user.role === 'admin') {
    // TypeScriptê°€ adminSince, canBanUsers ì¡´ì¬ë¥¼ ë³´ì¥
    return (
      <>
        <span>Admin since {user.adminSince.toLocaleDateString()}</span>
        <BanUserButton />
      </>
    );
  }

  if (user.role === 'moderator') {
    // TypeScriptê°€ moderatedPosts ì¡´ì¬ë¥¼ ë³´ì¥
    return <span>Moderated {user.moderatedPosts} posts</span>;
  }

  return null; // ì¼ë°˜ ìœ ì €ëŠ” ì¶”ê°€ ì•¡ì…˜ ì—†ìŒ
}
```

### [ts-pattern](https://github.com/gvergnaud/ts-pattern)ìœ¼ë¡œ ë§¤í•‘

roleì„ ë§¤í•‘í•  ë•Œ `ts-pattern`ì„ ì‚¬ìš©í•˜ë©´ **ëª¨ë“  ì¼€ì´ìŠ¤ë¥¼ ì²˜ë¦¬í–ˆëŠ”ì§€ ì»´íŒŒì¼ íƒ€ì„ì— í™•ì¸**í•  ìˆ˜ ìˆë‹¤:

```typescript
import { match } from 'ts-pattern';

// ìƒˆë¡œìš´ roleì´ ì¶”ê°€ë˜ë©´ exhaustive()ê°€ íƒ€ì… ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚´!
function mapRole(role: UserResponse['role']) {
  return match(role)
    .with('user', () => 'user' as const)
    .with('admin', () => 'admin' as const)
    .with('moderator', () => 'moderator' as const)
    .exhaustive();
}
```

---

## ì „ì²´ DTO ë³€í™˜ í•¨ìˆ˜

ì•ì„œ ì„¤ëª…í•œ íƒ€ì…ë“¤ê³¼ íŒ¨í„´ë“¤ì„ ëª¨ë‘ ì¡°í•©í•˜ë©´ ì´ëŸ° êµ¬ì¡°ê°€ ëœë‹¤:

```typescript
// dto.ts
import { match } from 'ts-pattern';
import type { UserResponse } from './schemas';
import type { UserDTO, BaseUserDTO } from './types';
import { UserId } from './types';

export function userDto(raw: UserResponse): UserDTO {
  // 1. ê³µí†µ í•„ë“œ ë³€í™˜ (nullish ì •ê·œí™”, íŒŒìƒê°’ ê³„ì‚°)
  const base: BaseUserDTO = {
    id: UserId(raw.id),
    fullName: `${raw.firstName} ${raw.lastName}`,
    email: raw.email,
    bio: raw.bio ?? null,
    avatarUrl: raw.avatar_url ?? null,
    createdAt: new Date(raw.created_at),
    isVerified: raw.is_verified,
    balance: `${raw.balance_raw.toLocaleString()}ì›`,
    isNewUser: Date.now() - new Date(raw.created_at).getTime() < 604800000,
  };

  // 2. roleì— ë”°ë¥¸ êµ¬ë³„ëœ ìœ ë‹ˆì˜¨ ë°˜í™˜
  return match(raw.role)
    .with('user', () => ({ ...base, role: 'user' as const }))
    .with('admin', () => ({
      ...base,
      role: 'admin' as const,
      adminSince: new Date(raw.admin_since!),
      canBanUsers: true as const,
      canDeletePosts: true as const,
    }))
    .with('moderator', () => ({
      ...base,
      role: 'moderator' as const,
      moderatedPosts: raw.moderated_posts!,
      canDeletePosts: true as const,
      canBanUsers: false as const,
    }))
    .exhaustive();
}
```

í•µì‹¬ì€ ë‘ ë‹¨ê³„ë‹¤:

1. **ê³µí†µ í•„ë“œ ë³€í™˜**: `nullish` ì •ê·œí™”, snake_case â†’ camelCase, íŒŒìƒê°’ ê³„ì‚°
2. **êµ¬ë³„ëœ ìœ ë‹ˆì˜¨ ë°˜í™˜**: `ts-pattern`ìœ¼ë¡œ roleë³„ íƒ€ì… ì•ˆì „í•œ ë¶„ê¸°

---

## React Queryì™€ í•¨ê»˜ ì“°ë©´

ì§€ê¸ˆê¹Œì§€ ì„¤ëª…í•œ DTO ë³€í™˜ì„ React Queryì™€ ê²°í•©í•˜ë©´ ì½”ë“œê°€ ì–¼ë§ˆë‚˜ ê¹”ë”í•´ì§€ëŠ”ì§€ ë³´ì.

### Data Access ê³„ì¸µ êµ¬ì¡°

[TanStack Query](https://github.com/TanStack/query) ë˜í¼ë¥¼ ë§Œë“¤ ë•Œ, ê°œì¸ì ìœ¼ë¡œëŠ” ì•„ë˜ì™€ ê°™ì€ í´ë” êµ¬ì¡°ë¥¼ ì„ í˜¸í•œë‹¤.
ë¬¼ë¡  ì‹¤ë¬´ì—ì„œëŠ” `service ë ˆì´ì–´`ë¥¼ í•˜ë‚˜ ë” ì¶”ê°€í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•œë‹¤.

```
src/
â””â”€â”€ features/
    â””â”€â”€ user/
        â”œâ”€â”€ models/
        â”‚   â””â”€â”€ user.model.ts           # í”„ë¡ íŠ¸ì—”ë“œ DTO íƒ€ì… ì •ì˜
        â”œâ”€â”€ repositories/
        â”‚   â””â”€â”€ user.dto.ts             # ì„œë²„ ì‘ë‹µ ê²€ì¦ (Zod) + DTO ë³€í™˜
        â””â”€â”€ presentations/
            â””â”€â”€ hooks/
                â””â”€â”€ use-user-query.ts   # React Query í›…
```

### presentations/hooks/use-user-query.ts

```typescript
import { useQuery } from '@tanstack/react-query';
import type { UserDTO } from '@/features/user/models/user.model';
import {
  UserResponseSchema,
  userDto,
} from '@/features/user/repositories/user.dto';

export function useUserQuery(userId: string) {
  return useQuery({
    queryKey: ['user', userId],
    queryFn: async () => {
      const res = await fetch(`/api/users/${userId}`);
      const json = await res.json();

      // ëŸ°íƒ€ì„ ê²€ì¦
      return UserResponseSchema.parse(json);
    },
    // DTO ë³€í™˜
    select: (data): UserDTO => userDto(data),
  });
}
```

### ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©

ì´ì œ ì²˜ìŒì— ë´¤ë˜ Bad ì˜ˆì œê°€ ì–´ë–»ê²Œ ë°”ë€ŒëŠ”ì§€ ë³´ì:

```tsx
const Child = () => {
  // í•„ìš”í•œ ê³³ì—ì„œ ë°”ë¡œ í˜¸ì¶œ, íŒŒìƒ ë¡œì§ ì—†ìŒ!
  const { data: user } = useUserQuery('123');

  return (
    <div>
      {user.fullName} {user.balance} {user.isNewUser && 'ğŸ†•'}
    </div>
  );
};
```

`React Query`ì˜ ìºì‹± ë•ë¶„ì— ì–´ë””ì„œë“  ê°™ì€ í›…ì„ í˜¸ì¶œí•˜ë©´ ê°™ì€ ë°ì´í„°ë¥¼ ë°›ëŠ”ë‹¤.

`props drilling`ë„ í•„ìš” ì—†ë‹¤.

DTO + React Query ì¡°í•©ì˜ ì¥ì :

- **íŒŒìƒ ë¡œì§ì´ í•œ ê³³ì— ì§‘ì¤‘**: `dto.ts`ì—ì„œ ëª¨ë“  ë³€í™˜ ì²˜ë¦¬
- **ì»´í¬ë„ŒíŠ¸ëŠ” UIì—ë§Œ ì§‘ì¤‘**: ë°ì´í„° ê°€ê³µ ë¡œì§ ì œë¡œ
- **íƒ€ì… ì•ˆì „ì„±**: `UserDTO` íƒ€ì…ìœ¼ë¡œ ìë™ì™„ì„±, ì˜¤íƒ€ ë°©ì§€
- **ì¬ì‚¬ìš©ì„±**: ì–´ë–¤ ì»´í¬ë„ŒíŠ¸ì—ì„œë“  ê°™ì€ í˜•íƒœì˜ ë°ì´í„° ì‚¬ìš©

---

## ìºì‹œ ë°ì´í„° ì²˜ë¦¬

ë§ˆì§€ë§‰ìœ¼ë¡œ ì¤‘ìš”í•œ í¬ì¸íŠ¸.

ìœ ì € ì •ë³´ë¥¼ ìˆ˜ì •í•´ì„œ ìºì‹œë¥¼ ì—…ë°ì´íŠ¸í•´ì•¼ í•  ë•Œ, **ë‚™ê´€ì (optimistic) ë°ì´í„°ë¥¼ ìºì‹œì— ë„£ì„ ë•Œë„ ë°˜ë“œì‹œ ì´ DTO í•¨ìˆ˜ë¥¼ í†µê³¼ì‹œì¼œì•¼ í•œë‹¤.**

```typescript
const mutation = useMutation({
  mutationFn: updateUser,
  onMutate: async (newData) => {
    await queryClient.cancelQueries({ queryKey: ['user', newData.id] });
    const previous = queryClient.getQueryData(['user', newData.id]);

    // ë‚™ê´€ì  ë°ì´í„°ë„ ë°˜ë“œì‹œ DTO ë³€í™˜!
    const optimisticRaw = { ...previous, ...newData };
    queryClient.setQueryData(['user', newData.id], userDto(optimisticRaw));

    return { previous };
  },
});
```

**ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” ëª¨ë“  ë°ì´í„°ë¿ë§Œ ì•„ë‹ˆë¼ ìºì‹œë¥¼ ì¡°ì‘í•˜ëŠ” ëª¨ë“  ì‹œì ì—ì„œë„ DTO ë³€í™˜ ë¡œì§ì„ ì‚¬ìš©í•´ì•¼ ë°ì´í„°ì˜ ì¼ê´€ì„±ì´ ìœ ì§€ëœë‹¤.**

---

## í•µì‹¬ ì •ë¦¬

| ë¬¸ì œ                     | í•´ê²°ì±…                                    |
| ------------------------ | ----------------------------------------- |
| `undefined \| null` í˜¼ìš© | `null`ë¡œ ì •ê·œí™” (`?? null`)               |
| snake_case vs camelCase  | DTOì—ì„œ ì¼ê´„ ë³€í™˜                         |
| ë§¤ë²ˆ íŒŒìƒ ë¡œì§ ë°˜ë³µ      | DTOì—ì„œ ë¯¸ë¦¬ ê³„ì‚° (`fullName`, `balance`) |
| ì¡°ê±´ë¶€ í•„ë“œ              | êµ¬ë³„ëœ ìœ ë‹ˆì˜¨ (Discriminated Unions)      |
| ID íƒ€ì… í˜¼ë™             | ëª…ëª©ì  íƒ€ì… (Branded Types)               |
| ìƒˆë¡œìš´ ì¼€ì´ìŠ¤ ëˆ„ë½       | ts-patternì˜ `.exhaustive()`              |
| ì»´í¬ë„ŒíŠ¸ë§ˆë‹¤ ì¤‘ë³µ íŒŒìƒ   | í•œ ê³³ì—ì„œ ë³€í™˜, ì–´ë””ì„œë“  ì‚¬ìš©             |

### DTOë¥¼ ì‚¬ìš©í•˜ë©´:

1. **ì»´í¬ë„ŒíŠ¸ì—ì„œ íŒŒìƒ ë¡œì§ ìµœì†Œí™”** - ì´ë¯¸ ì •ì œëœ ë°ì´í„°ë¥¼ ë°›ìŒ
2. **íƒ€ì… ì•ˆì „ì„± ê·¹ëŒ€í™”** - ëª…ëª©ì  íƒ€ì…ìœ¼ë¡œ ID í˜¼ë™ ë°©ì§€
3. **ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ** - ë³€í™˜ ë¡œì§ì´ í•œ ê³³ì— ì§‘ì¤‘
4. **ë””ë²„ê¹… ìš©ì´** - ëŸ°íƒ€ì„ ê²€ì¦ + ë¡œê¹…ìœ¼ë¡œ ë²„ê·¸ ì¶”ì  ì‰¬ì›€
5. **ë°ì´í„° ì¼ê´€ì„±** - ìºì‹œ ì¡°ì‘ ì‹œì—ë„ ë™ì¼í•œ ë³€í™˜ ì ìš©

**ì´ê²Œ DTOì˜ ì „ë¶€ë‹¤.** ì´ì œ ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” `userDto()`ë¥¼ í†µí•´ ì´ë¯¸ íŒŒìƒë˜ê³  ì •ë¦¬ëœ ë°ì´í„°ë¥¼ ë°›ê²Œ ëœë‹¤.

---

## ì°¸ê³ ìë£Œ

- [Branded Types in TypeScript: Stronger Type Safety for Your Codebase](https://medium.com/@gvelosa/branded-types-in-typescript-stronger-type-safety-for-your-codebase-3f2125c28b43)
