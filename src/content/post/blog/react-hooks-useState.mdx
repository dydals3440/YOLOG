---
title: useState ìŠ¤ëƒ…ìƒ·, ë°°ì¹­, ë¶ˆë³€ì„± í•œ ë²ˆì— ì •ë¦¬
date: 2025-12-22
updatedDate: 2025-12-22
tags: [ë¦¬ì•¡íŠ¸, React, useState, Hooks, ìƒíƒœê´€ë¦¬, State, Immer]
category: DEVELOPMENT
image: "/images/react-hooks-useState/thumbnail.webp"
---

# useState ìŠ¤ëƒ…ìƒ·, ë°°ì¹­, ë¶ˆë³€ì„± í•œ ë²ˆì— ì •ë¦¬

ë²„íŠ¼ì„ ëˆŒë €ëŠ”ë° í™”ë©´ì´ ì•ˆ ë°”ë€ë‹¤? `console.log` ê°’ì€ ì™œ í•­ìƒ í•œ ë°•ì ëŠë¦´ê¹Œ? ê°™ì€ `setState`ë¥¼ ì„¸ ë²ˆ í˜¸ì¶œí–ˆëŠ”ë° ì™œ í•œ ë²ˆë§Œ ë°˜ì˜ë ê¹Œ?

ì´ëŸ° ê²½í—˜ì´ ìˆë‹¤ë©´ `useState`ì˜ ë™ì‘ ì›ë¦¬ë¥¼ ì œëŒ€ë¡œ ì´í•´í•˜ì§€ ëª»í–ˆì„ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤. ì´ë²ˆ ê¸€ì—ì„œëŠ” ë‹¨ìˆœí•œ ì‚¬ìš©ë²•ì´ ì•„ë‹Œ, useStateë¥¼ ì‚¬ìš©í•  ë•Œ ë§ˆì£¼ì¹˜ëŠ” ë‹¤ì–‘í•œ ë¬¸ì œì™€ ê·¸ ì›ì¸, í•´ê²° ë°©ë²•ì„ ê¹Šì´ ìˆê²Œ ë‹¤ë¤„ë³´ê² ë‹¤.

í•´ë‹¹ ë¸”ë¡œê·¸ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ [useState ì˜ìƒ ê°•ì˜](https://youtu.be/fgjsQoTHcnE?si=-N3xe5-bfGH3iUuF)ë¡œ ê°„ë‹¨í•˜ê²Œ ì•„ë˜ì˜ ë‚´ìš©ì„ ì„¤ëª…í–ˆìœ¼ë‹ˆ ì˜ìƒì„ ì„ í˜¸í•˜ëŠ” ë¶„ë“¤ì€ ì°¸ê³ í•˜ë©´ ì¢‹ê² ë‹¤.

---

## ë¬¸ì œ 1. useStateë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ì„ ë•Œ

ë¨¼ì €, ì™œ useStateë¥¼ í™œìš©í•´ì•¼ í•˜ëŠ”ì§€ë¶€í„° ì´ì•¼ê¸°í•´ë³´ì.

```tsx {4-6}
function App() {
  let count = 0;

  const handleIncrease = () => {
    count++;
    console.log(count); // 1 â†’ 2 â†’ 3 â†’ ... (í´ë¦­ë§ˆë‹¤ ì¦ê°€)
  };

  return (
    <>
      <button onClick={handleIncrease}>ì¦ê°€</button>
      <h1>ì¹´ìš´íŠ¸: {count}</h1> {/* í•­ìƒ 0 */}
    </>
  );
}
```

ì¦ê°€ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ í™”ë©´ì— 0 â†’ 1 â†’ 2 â†’ ... ì´ë ‡ê²Œ ìˆ«ìê°€ ì¦ê°€í•  ê²ƒ ê°™ë‹¤. í•˜ì§€ë§Œ ì‹¤ì œë¡œëŠ” `console.log(count)` ê°’ì€ ì¦ê°€í•˜ì§€ë§Œ, í™”ë©´ì—ëŠ” ê°’ì´ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠëŠ”ë‹¤.

ì´ìœ ëŠ” ê°„ë‹¨í•˜ë‹¤. ë¦¬ì•¡íŠ¸ëŠ” **ìƒíƒœ(state)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë¦¬ë Œë”ë§**ì´ ì¼ì–´ë‚œë‹¤. `count`ë¥¼ ìƒíƒœë¡œ ì„ ì–¸í•œ ê²ƒì´ ì•„ë‹Œ ë‹¨ìˆœí•œ ë¡œì»¬ ë³€ìˆ˜ë¡œ ì„ ì–¸í–ˆê¸° ë•Œë¬¸ì— ë¦¬ì•¡íŠ¸ëŠ” ê°’ì´ ë°”ë€Œì—ˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ì—†ê³ , í™”ë©´ì´ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠëŠ” ê²ƒì´ë‹¤.

---

## useState ì‚¬ìš© ë°©ë²•

[`useState`](https://react.dev/reference/react/useState)ëŠ” ì»´í¬ë„ŒíŠ¸ì— state ë³€ìˆ˜ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” React Hookì´ë‹¤.

```tsx
const [state, setState] = useState(initialState);
```

### 1. ë§¤ê°œë³€ìˆ˜: initialState

useStateëŠ” ë§¤ê°œë³€ìˆ˜ë¡œ `initialState`ë¥¼ ë°›ëŠ”ë‹¤. ì´ë¦„ ê·¸ëŒ€ë¡œ ì´ˆê¸° ìƒíƒœë¥¼ ì •ì˜í•˜ëŠ” ê²ƒì´ë‹¤. ê¸°ë³¸í˜• ë°ì´í„°ë“ , ì°¸ì¡°í˜• ë°ì´í„°ë“  ì–´ë–¤ ìœ í˜•ì˜ ê°’ì´ë“  ì§€ì •í•  ìˆ˜ ìˆë‹¤.

í•¨ìˆ˜ë¥¼ `initialState`ë¡œ ì „ë‹¬í•˜ë©´ ë™ì‘ ë°©ì‹ì´ ì‚´ì§ ë‹¤ë¥´ë‹¤. ì´ëŠ” ì•„ë˜ì—ì„œ ìì„¸íˆ ì„¤ëª…í•˜ê² ë‹¤.

### 2. ë°˜í™˜ê°’

useStateëŠ” ì •í™•íˆ ë‘ ê°œì˜ ê°’ì„ ê°€ì§„ ë°°ì—´ì„ ë°˜í™˜í•œë‹¤.

1. **state**: í˜„ì¬ ìƒíƒœë¥¼ ë°˜í™˜í•œë‹¤. ì²« ë²ˆì§¸ ë Œë”ë§ ì¤‘ì—ëŠ” `initialState`ë¡œ ì •ì˜ëœë‹¤.
2. **setState**: stateë¥¼ ë‹¤ë¥¸ ê°’ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ê³ , ë¦¬ë Œë”ë§ì„ íŠ¸ë¦¬ê±°í•˜ëŠ” setter í•¨ìˆ˜ë‹¤.

---

## í•´ê²° 1. useState í™œìš©í•˜ê¸°

ìœ„ì—ì„œ ë°œìƒí–ˆë˜ ë¬¸ì œëŠ” useStateë¥¼ í™œìš©í•˜ë©´ ì†ì‰½ê²Œ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

```tsx {2,5}
import { useState } from "react";

function App() {
  const [count, setCount] = useState(0);

  const handleIncrease = () => {
    setCount(count + 1);
    console.log(count);
  };

  return (
    <>
      <button onClick={handleIncrease}>ì¦ê°€</button>
      <h1>ì¹´ìš´íŠ¸: {count}</h1>
    </>
  );
}
```

ì´ì œ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ í™”ë©´ì— ì¦ê°€ëœ ê°’ì´ ë°”ë¡œ ë°˜ì˜ëœë‹¤.

### ì ê¹, console.log ê°’ì´ ì´ìƒí•˜ë‹¤?

ëˆˆì¹˜ê°€ ë¹ ë¥¸ ë¶„ì´ë¼ë©´ ë­”ê°€ ì´ìƒí•¨ì„ ëŠê¼ˆì„ ê²ƒì´ë‹¤. í™”ë©´ì—ëŠ” ë¶„ëª… 10ì´ ë³´ì´ëŠ”ë°, `console.log(count)`ì˜ ê²°ê³¼ëŠ” 9ë‹¤. í•­ìƒ í•œ ë°•ì ëŠë¦¬ë‹¤. ì´ê±´ ë²„ê·¸ê°€ ì•„ë‹ˆë¼ Reactì˜ ìƒíƒœ ê´€ë¦¬ ë°©ì‹ ë•Œë¬¸ì´ë‹¤.

### StateëŠ” ìŠ¤ëƒ…ìƒ·ì²˜ëŸ¼ ë™ì‘í•œë‹¤

`setCount`ë¥¼ í˜¸ì¶œí•´ë„ í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ í•¨ìˆ˜ ë‚´ì˜ `count` ê°’ì€ ë³€í•˜ì§€ ì•ŠëŠ”ë‹¤.

```tsx {2-4,7}
const handleIncrease = () => {
  console.log(count); // 0
  setCount(count + 1); // "ë‹¤ìŒ ë Œë”ë§ì—ì„œ 1ë¡œ ë°”ê¿”ì¤˜"ë¼ê³  ìš”ì²­
  console.log(count); // ì—¬ì „íˆ 0

  setTimeout(() => {
    console.log(count); // 1ì´ˆ í›„ì—ë„ ì—¬ì „íˆ 0
  }, 1000);
};
```

ì™œ ì´ëŸ´ê¹Œ? set í•¨ìˆ˜ëŠ” í˜„ì¬ stateë¥¼ ë³€ê²½í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼, **ë‹¤ìŒ ë Œë”ë§ì—ì„œ ë°˜í™˜í•  ê°’ì„ ì˜ˆì•½**í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì´ë‹¤.

ì‰½ê²Œ ë§í•´ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ê°€ ì‹¤í–‰ë˜ëŠ” ì‹œì ì— `count`ëŠ” ì´ë¯¸ **ìŠ¤ëƒ…ìƒ·**ìœ¼ë¡œ ì°í˜€ìˆë‹¤. ê·¸ë˜ì„œ ê·¸ í•¨ìˆ˜ ì•ˆì—ì„œ ì•„ë¬´ë¦¬ `setCount`ë¥¼ í˜¸ì¶œí•´ë„, ì´ë¯¸ ì°íŒ ìŠ¤ëƒ…ìƒ· ê°’(count = 0)ì€ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤.

### Batching: ì—¬ëŸ¬ ì—…ë°ì´íŠ¸ë¥¼ ë¬¶ì–´ì„œ ì²˜ë¦¬

ì—¬ê¸°ì„œ í•œ ê°€ì§€ ë” ì•Œì•„ì•¼ í•  ê°œë…ì´ ìˆë‹¤. ë°”ë¡œ **Batching**ì´ë‹¤.

```tsx {2-4}
const handleClick = () => {
  setCount(count + 1);
  setFlag(true);
  setName("Matthew");
  // 3ë²ˆì˜ setState â†’ ë¦¬ë Œë”ë§ 3ë²ˆ? âŒ
  // Reactê°€ ë¬¶ì–´ì„œ â†’ ë¦¬ë Œë”ë§ 1ë²ˆ! âœ…
};
```

ReactëŠ” ì—¬ëŸ¬ ê°œì˜ state ì—…ë°ì´íŠ¸ë¥¼ í•˜ë‚˜ë¡œ ë¬¶ì–´ì„œ(batch) í•œ ë²ˆë§Œ ë¦¬ë Œë”ë§í•œë‹¤. ë§¤ë²ˆ setStateë§ˆë‹¤ DOMì„ ì—…ë°ì´íŠ¸í•˜ë©´ ì„±ëŠ¥ì´ ë–¨ì–´ì§€ê¸° ë•Œë¬¸ì´ë‹¤.

React 17ê¹Œì§€ëŠ” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì•ˆì—ì„œë§Œ batchingì´ ë™ì‘í–ˆë‹¤. í•˜ì§€ë§Œ React 18ë¶€í„°ëŠ” **Automatic Batching** ë•ë¶„ì— `setTimeout`, `Promise`, `fetch` ë“± ì–´ë””ì„œ í˜¸ì¶œí•˜ë“  ìë™ìœ¼ë¡œ batchingì´ ëœë‹¤.

```tsx
// React 17: 2ë²ˆ ë Œë”ë§
// React 18: 1ë²ˆ ë Œë”ë§ (Automatic Batching)
setTimeout(() => {
  setCount((c) => c + 1);
  setFlag((f) => !f);
}, 1000);
```

---

## ë¬¸ì œ 2. ìˆ«ìê°€ 3 ì¦ê°€í•  ê²ƒ ê°™ì§€ë§Œ...

ìœ„ ë‚´ìš©ì„ ì˜ ì´í•´í–ˆë‹¤ë©´ ì•„ë˜ ì½”ë“œì˜ ë¬¸ì œì ì„ íŒŒì•…í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

```tsx {5-7}
import { useState } from "react";

function App() {
  const [count, setCount] = useState(0);

  const handleIncrease = () => {
    setCount(count + 1); // 0 + 1 = 1
    setCount(count + 1); // 0 + 1 = 1
    setCount(count + 1); // 0 + 1 = 1
  };

  return (
    <>
      <button onClick={handleIncrease}>ì¦ê°€</button>
      <h1>ì¹´ìš´íŠ¸: {count}</h1> {/* í´ë¦­ í›„: 1 (3ì´ ì•„ë‹˜!) */}
    </>
  );
}
```

ì¦ê°€ ë²„íŠ¼ì„ í•œ ë²ˆ í´ë¦­í•˜ë©´ ì¹´ìš´íŠ¸ê°€ 3ì´ ë  ê²ƒ ê°™ì§€ë§Œ, ì‹¤ì œë¡œëŠ” 1ë°–ì— ì¦ê°€í•˜ì§€ ì•ŠëŠ”ë‹¤.

ì„¸ ë²ˆì˜ `setCount` ëª¨ë‘ ê°™ì€ ìŠ¤ëƒ…ìƒ·(`count = 0`)ì„ ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°í•˜ê¸° ë•Œë¬¸ì— `0 + 1 = 1`ì´ ì„¸ ë²ˆ ì ìš©ë  ë¿ì´ë‹¤.

---

## í•´ê²° 2. ì—…ë°ì´í„° í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸°

useStateì˜ setter íƒ€ì…ì„ ë³´ë©´ ê°’ë¿ë§Œ ì•„ë‹ˆë¼ **ì—…ë°ì´í„° í•¨ìˆ˜**ë„ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.

```ts
type SetStateAction<S> = S | ((prevState: S) => S);
```

ì—…ë°ì´í„° í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ì „ stateë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ìŒ stateë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.

```tsx {2-4}
const handleIncrease = () => {
  setCount((prev) => prev + 1); // 0 â†’ 1
  setCount((prev) => prev + 1); // 1 â†’ 2
  setCount((prev) => prev + 1); // 2 â†’ 3
};
```

ReactëŠ” ì—…ë°ì´í„° í•¨ìˆ˜ë¥¼ íì— ë„£ê³ , ë‹¤ìŒ ë Œë”ë§ ì¤‘ì— ìˆœì„œëŒ€ë¡œ í˜¸ì¶œí•œë‹¤.

1. `prev => prev + 1`ì€ ëŒ€ê¸° ì¤‘ì¸ stateë¡œ 0ì„ ë°›ê³  1ì„ ë°˜í™˜í•œë‹¤.
2. `prev => prev + 1`ì€ ëŒ€ê¸° ì¤‘ì¸ stateë¡œ 1ì„ ë°›ê³  2ë¥¼ ë°˜í™˜í•œë‹¤.
3. `prev => prev + 1`ì€ ëŒ€ê¸° ì¤‘ì¸ stateë¡œ 2ë¥¼ ë°›ê³  3ì„ ë°˜í™˜í•œë‹¤.

ì´ì œ ëŒ€ê¸° ì¤‘ì¸ ë‹¤ë¥¸ ì—…ë°ì´íŠ¸ê°€ ì—†ìœ¼ë¯€ë¡œ, ReactëŠ” 3ì„ í˜„ì¬ stateë¡œ ì €ì¥í•˜ê²Œ ëœë‹¤.

ë³€ìˆ˜ëª…ì€ `count`ë³´ë‹¤ ì´ì „ ê°’ì„ì„ ëª…í™•íˆ í•˜ê¸° ìœ„í•´ `prev`ë¥¼ ë¶™ì´ëŠ” ê²ƒì„ ê°œì¸ì ìœ¼ë¡œ ì„ í˜¸í•œë‹¤.

---

## ë¬¸ì œ 3. ë¦¬ë Œë”ë§ë§ˆë‹¤ ë¬´ê±°ìš´ ê³„ì‚°ì´ ë°˜ë³µëœë‹¤

ë¦¬ë Œë”ë§ì´ ë¹„ì‹¼ ë¹„ìš©ì´ë¼ëŠ” ê²ƒì„ ì•Œê²Œ ë˜ì—ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì•„ë˜ ì½”ë“œëŠ” ì–´ë–¨ê¹Œ?

```tsx {3,16}
import { useState } from "react";

// ë¬´ê±°ìš´ ê³„ì‚°: 10ë§Œ ê°œì˜ ì•„ì´í…œ ìƒì„± ë° ì •ë ¬
const generateInitialData = () => {
  console.log("ğŸ”¥ ë¬´ê±°ìš´ ê³„ì‚° ì‹œì‘!");
  const startTime = performance.now();

  const items = Array.from({ length: 100_000 }, (_, i) => ({
    id: i,
    value: Math.random(),
    name: `Item ${i}`,
  }));
  items.sort((a, b) => a.value - b.value);

  const endTime = performance.now();
  console.log(`â±ï¸ ì†Œìš” ì‹œê°„: ${(endTime - startTime).toFixed(2)}ms`);
  return items.slice(0, 10);
};

function App() {
  console.log("ğŸ”„ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§");

  // âŒ ì˜ëª»ëœ ë°©ë²•: ë§¤ ë Œë”ë§ë§ˆë‹¤ 10ë§Œ ê°œ ìƒì„± + ì •ë ¬
  const [topItems, setTopItems] = useState(generateInitialData());
  const [count, setCount] = useState(0);

  return (
    <>
      <h1>ì¹´ìš´íŠ¸: {count}</h1>
      <button onClick={() => setCount((c) => c + 1)}>ì¹´ìš´íŠ¸ ì¦ê°€</button>
      <ul>
        {topItems.map((item) => (
          <li key={item.id}>
            {item.name}: {item.value.toFixed(4)}
          </li>
        ))}
      </ul>
    </>
  );
}
```

```
ì½˜ì†” ê²°ê³¼:
ğŸ”¥ ë¬´ê±°ìš´ ê³„ì‚° ì‹œì‘!
â±ï¸ ì†Œìš” ì‹œê°„: 150.23ms
ğŸ”„ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§

// ë²„íŠ¼ í´ë¦­ (ë‹¨ìˆœíˆ countë§Œ ë°”ê¾¸ëŠ”ë°...)
ğŸ”¥ ë¬´ê±°ìš´ ê³„ì‚° ì‹œì‘!
â±ï¸ ì†Œìš” ì‹œê°„: 148.56ms  â† ë˜ 150ms ë‚­ë¹„!
ğŸ”„ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§
```

`generateInitialData()`ì˜ ê²°ê³¼ê°’ì€ ì´ˆê¸° ë Œë”ë§ì—ì„œë§Œ ì‚¬ìš©ë˜ì§€ë§Œ, í•¨ìˆ˜ í˜¸ì¶œ ìì²´ëŠ” ë§¤ ë Œë”ë§ë§ˆë‹¤ ì¼ì–´ë‚œë‹¤. ë²„íŠ¼ì„ 10ë²ˆ ëˆ„ë¥´ë©´ 1.5ì´ˆë¥¼ ë‚­ë¹„í•˜ëŠ” ì…ˆì´ë‹¤.

---

## í•´ê²° 3. í•¨ìˆ˜ì˜ ì°¸ì¡°ë¥¼ ë„˜ê¸°ì (Lazy Initialization)

ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” `generateInitialData()`ë¥¼ ì‹¤í–‰í•œ ê°’ì´ ì•„ë‹Œ **í•¨ìˆ˜ì˜ ì°¸ì¡°**ë¥¼ ë„˜ê¸°ë©´ ëœë‹¤.

```tsx {5-6}
function App() {
  console.log("ğŸ”„ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§");

  // âœ… ì˜¬ë°”ë¥¸ ë°©ë²•: í•¨ìˆ˜ ì°¸ì¡° ì „ë‹¬ (ì´ˆê¸° ë Œë”ë§ì—ì„œë§Œ ì‹¤í–‰)
  const [topItems, setTopItems] = useState(generateInitialData);
  // ë˜ëŠ” í™”ì‚´í‘œ í•¨ìˆ˜ë¡œ ê°ì‹¸ê¸°: useState(() => generateInitialData())

  const [count, setCount] = useState(0);

  return (
    // ... ë™ì¼
  );
}
```

```
ì½˜ì†” ê²°ê³¼:
ğŸ”¥ ë¬´ê±°ìš´ ê³„ì‚° ì‹œì‘!
â±ï¸ ì†Œìš” ì‹œê°„: 151.34ms
ğŸ”„ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§

// ë²„íŠ¼ í´ë¦­ í›„
ğŸ”„ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§  â† ê³„ì‚° ì—†ì´ ì¦‰ì‹œ ë Œë”ë§! âœ…
```

í•¨ìˆ˜ë¥¼ useStateì— ì „ë‹¬í•˜ë©´ ReactëŠ” ì´ˆê¸°í™” ì¤‘ì—ë§Œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤. `generateInitialData()`ê°€ ì•„ë‹ˆë¼ `generateInitialData`ë¥¼ ì „ë‹¬í•˜ê³  ìˆë‹¤ëŠ” ê²ƒì— ì£¼ëª©í•˜ì.

### ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œ: localStorage

ê°€ì¥ í”í•˜ê²Œ ì‚¬ìš©ë˜ëŠ” íŒ¨í„´ì´ë‹¤.

```tsx {2,5}
// âŒ ë§¤ ë Œë”ë§ë§ˆë‹¤ localStorage ì ‘ê·¼
const [theme, setTheme] = useState(localStorage.getItem("theme") || "light");

// âœ… ì´ˆê¸° ë Œë”ë§ì—ì„œë§Œ localStorage ì ‘ê·¼
const [theme, setTheme] = useState(
  () => localStorage.getItem("theme") || "light"
);
```

ì´ˆê¸°ê°’ ê³„ì‚°ì´ ë‹¨ìˆœí•œ ì›ì‹œê°’ì´ë©´ ê·¸ëƒ¥ ë„£ì–´ë„ ë˜ì§€ë§Œ, í•¨ìˆ˜ í˜¸ì¶œ, API, localStorage ì ‘ê·¼ ë“±ì´ í¬í•¨ë˜ë©´ í•¨ìˆ˜ë¡œ ê°ì‹¸ëŠ” ìŠµê´€ì„ ë“¤ì´ì.

---

## ë¬¸ì œ 4. Stateë¥¼ ì—…ë°ì´íŠ¸í•´ë„ í™”ë©´ì´ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤

Reactë¥¼ ì²˜ìŒ ë°°ìš°ë‹¤ ë³´ë©´ ë¶„ëª…íˆ stateë¥¼ ì—…ë°ì´íŠ¸í–ˆëŠ”ë° í™”ë©´ì´ ë°”ë€Œì§€ ì•ŠëŠ” ê²½ìš°ë¥¼ ë§ˆì£¼í•˜ê²Œ ëœë‹¤. ì´ê±´ Reactì˜ **ë¶ˆë³€ì„±(Immutability)** ì›ì¹™ê³¼ ê´€ë ¨ì´ ìˆë‹¤.

```tsx {8-9,13-14}
import { useState } from "react";

function App() {
  const [formData, setFormData] = useState({
    name: "Matthew",
    age: 27,
  });

  const handleNameChange = () => {
    formData.name = "YongMin"; // âŒ ê¸°ì¡´ ê°ì²´ë¥¼ ì§ì ‘ ë³€ê²½
    setFormData(formData); // âŒ ê°™ì€ ì°¸ì¡°ë¥¼ ë‹¤ì‹œ ì „ë‹¬
  };

  const handleAgeChange = () => {
    formData.age = formData.age + 1; // âŒ ê¸°ì¡´ ê°ì²´ë¥¼ ì§ì ‘ ë³€ê²½
    setFormData(formData);
  };

  return (
    <>
      <h1>Name: {formData.name}</h1>
      <h1>Age: {formData.age}</h1>
      <button onClick={handleNameChange}>ì´ë¦„ ë³€ê²½</button>
      <button onClick={handleAgeChange}>ë‚˜ì´ ë³€ê²½</button>
    </>
  );
}
```

ë²„íŠ¼ì„ í´ë¦­í•´ë„ í™”ë©´ì€ ì „í˜€ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤. ì™œì¼ê¹Œ?

### ì›ì¸: Object.is ë¹„êµ

ReactëŠ” stateê°€ ë³€ê²½ë˜ì—ˆëŠ”ì§€ íŒë‹¨í•  ë•Œ [`Object.is`](https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Object/is)ë¡œ ë¹„êµí•œë‹¤.

```ts
Object.is(ì´ì „state, ë‹¤ìŒstate); // trueë©´ ì—…ë°ì´íŠ¸ ë¬´ì‹œ
```

ë¬¸ì œëŠ” ê°ì²´ë¥¼ ì§ì ‘ ë³€ê²½í•˜ë©´ ì°¸ì¡°(reference)ê°€ ê·¸ëŒ€ë¡œë¼ëŠ” ì ì´ë‹¤.

```tsx
const formData = { name: "Matthew", age: 27 };
formData.name = "YongMin"; // ë‚´ìš©ì€ ë°”ê¿¨ì§€ë§Œ...

Object.is(formData, formData); // true (ì°¸ì¡°ëŠ” ì—¬ì „íˆ ê°™ìŒ)
```

React ì…ì¥ì—ì„œëŠ” "ì–´? ê°™ì€ ê°ì²´ë„¤? ë°”ë€ ê±° ì—†êµ¬ë‚˜" í•˜ê³  ë¦¬ë Œë”ë§ì„ ê±´ë„ˆë›´ë‹¤.

### ì‹œê°ì ìœ¼ë¡œ ì´í•´í•˜ê¸°

```
âŒ ì˜ëª»ëœ ë°©ë²•: ì§ì ‘ ë³€ê²½ (Mutation)

[ë©”ëª¨ë¦¬ ì£¼ì†Œ: 0x001]
{ name: "Matthew", age: 27 }
        â†“
formData.name = "YongMin"
        â†“
[ë©”ëª¨ë¦¬ ì£¼ì†Œ: 0x001]  â† ê°™ì€ ì£¼ì†Œ!
{ name: "YongMin", age: 27 }

React: Object.is(0x001, 0x001) â†’ true â†’ "ë³€ê²½ ì—†ìŒ, ìŠ¤í‚µ!"
```

```
âœ… ì˜¬ë°”ë¥¸ ë°©ë²•: ìƒˆ ê°ì²´ ìƒì„±

[ë©”ëª¨ë¦¬ ì£¼ì†Œ: 0x001]
{ name: "Matthew", age: 27 }
        â†“
{ ...formData, name: "YongMin" }
        â†“
[ë©”ëª¨ë¦¬ ì£¼ì†Œ: 0x002]  â† ìƒˆë¡œìš´ ì£¼ì†Œ!
{ name: "YongMin", age: 27 }

React: Object.is(0x001, 0x002) â†’ false â†’ "ë³€ê²½ë¨, ë¦¬ë Œë”ë§!"
```

---

## í•´ê²° 4-1. ìƒˆë¡œìš´ ê°ì²´ë¥¼ ë§Œë“¤ì

ê°„ë‹¨í•˜ê²Œ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ë§Œë“¤ë©´ ëœë‹¤. ìŠ¤í”„ë ˆë“œ ì—°ì‚°ì(`...`)ë¥¼ í™œìš©í•´ì„œ ì´ì „ ê°’ì„ ë³µì‚¬í•˜ê³  ë³€ê²½í•  ë¶€ë¶„ë§Œ ë®ì–´ì“°ë©´ ëœë‹¤.

```tsx {9-12,15-18}
import { useState } from "react";

function App() {
  const [formData, setFormData] = useState({
    name: "Matthew",
    age: 27,
  });

  const handleNameChange = () => {
    setFormData({
      ...formData, // ê¸°ì¡´ ê°’ ë³µì‚¬
      name: "YongMin", // ë³€ê²½í•  ê°’ë§Œ ë®ì–´ì“°ê¸°
    });
  };

  const handleAgeChange = () => {
    setFormData({
      ...formData,
      age: formData.age + 1,
    });
  };

  return (
    <>
      <h1>Name: {formData.name}</h1>
      <h1>Age: {formData.age}</h1>
      <button onClick={handleNameChange}>ì´ë¦„ ë³€ê²½</button>
      <button onClick={handleAgeChange}>ë‚˜ì´ ë³€ê²½</button>
    </>
  );
}
```

ì´ì œ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ í™”ë©´ì´ ì •ìƒì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ëœë‹¤.

### ì¤‘ì²© ê°ì²´ê°€ ê¹Šì–´ì§€ë©´?

ê°„ë‹¨í•œ ê°ì²´ëŠ” ìŠ¤í”„ë ˆë“œ ì—°ì‚°ìë¡œ ì¶©ë¶„í•˜ë‹¤. í•˜ì§€ë§Œ êµ¬ì¡°ê°€ ë³µì¡í•´ì§€ë©´ ì´ì•¼ê¸°ê°€ ë‹¬ë¼ì§„ë‹¤.

```tsx
const [user, setUser] = useState({
  name: "Matthew",
  address: {
    city: "Seoul",
    district: {
      name: "Gangnam",
      zip: "12345",
    },
  },
  hobbies: ["coding", "reading"],
});

// zipë§Œ ë°”ê¾¸ê³  ì‹¶ì€ë°...
setUser({
  ...user,
  address: {
    ...user.address,
    district: {
      ...user.address.district,
      zip: "67890",
    },
  },
});
```

ë‹¨ìˆœíˆ `zip` í•˜ë‚˜ ë°”ê¾¸ë ¤ê³  ì´ë ‡ê²Œ ì¥í™©í•˜ê²Œ ì‘ì„±í•´ì•¼ í•œë‹¤. ì´ëŸ° ì½”ë“œëŠ” ì‹¤ìˆ˜í•˜ê¸°ë„ ì‰½ê³  ê°€ë…ì„±ë„ ë–¨ì–´ì§„ë‹¤.

---

## í•´ê²° 4-2. Immerë¡œ ê°„í¸í•˜ê²Œ

ì´ëŸ¬í•œ ë¬¸ì œëŠ” `redux-toolkit` ê°™ì€ ìƒíƒœê´€ë¦¬ë¥¼ í™œìš©í•  ë•Œë„ ë°œìƒí•œë‹¤. í•­ìƒ ë¶ˆë³€ì„±ì„ ìœ ì§€í•˜ëŠ” ê²ƒì´ ë¦¬ì•¡íŠ¸ì˜ ìƒíƒœê´€ë¦¬ì— ìˆì–´ì„œ ìƒë‹¹íˆ ì¤‘ìš”í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

ë‹¹ì—°íˆ ìš°ë¦¬ì˜ ì„ ë°° ê°œë°œìë¶„ë“¤ì€ ì´ëŸ¬í•œ ë¬¸ì œë¥¼ ë™ì¼í•˜ê²Œ ê²ªì—ˆê³ , ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ [Immer](https://immerjs.github.io/immer/)ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë§Œë“¤ì—ˆë‹¤. ë¶ˆë³€ì„±ì„ ìœ ì§€í•˜ë©´ì„œë„ ì§ì ‘ ë³€ê²½í•˜ëŠ” ê²ƒì²˜ëŸ¼ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.

```bash
bun install immer use-immer
```

### ê¸°ë³¸ ì‚¬ìš©ë²•: produce

```tsx {2,11-13}
import { useState } from "react";
import { produce } from "immer";

function App() {
  const [formData, setFormData] = useState({
    name: "Matthew",
    age: 27,
  });

  const handleNameChange = () => {
    // âœ… ì§ì ‘ ë³€ê²½í•˜ëŠ” ê²ƒì²˜ëŸ¼ ì‘ì„±í•´ë„ OK
    setFormData(
      produce((draft) => {
        draft.name = "YongMin";
      })
    );
  };

  const handleAgeChange = () => {
    setFormData(
      produce((draft) => {
        draft.age += 1;
      })
    );
  };

  // ...
}
```

`draft`ëŠ” ì›ë³¸ì˜ "ì„ì‹œ ë³µì‚¬ë³¸"ì´ë‹¤. ì´ê±¸ ë§ˆìŒëŒ€ë¡œ ë³€ê²½í•˜ë©´ Immerê°€ ì•Œì•„ì„œ ìƒˆë¡œìš´ ë¶ˆë³€ ê°ì²´ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.

### ë” ê°„í¸í•˜ê²Œ: useImmer

ë¦¬ì•¡íŠ¸ ê³µì‹ë¬¸ì„œì—ì„œëŠ” [use-immer](https://github.com/immerjs/use-immer) íŒ¨í‚¤ì§€ë¥¼ í™œìš©í•  ê²ƒì„ ê¶Œì¥í•œë‹¤. useStateë¥¼ ëŒ€ì²´í•  ìˆ˜ ìˆë‹¤.

```tsx {1,4,8-10}
import { useImmer } from "use-immer";

function App() {
  const [formData, setFormData] = useImmer({
    name: "Matthew",
    age: 27,
  });

  const handleNameChange = () => {
    setFormData((draft) => {
      draft.name = "YongMin";
    });
  };

  const handleAgeChange = () => {
    setFormData((draft) => {
      draft.age += 1;
    });
  };

  return (
    <>
      <h1>Name: {formData.name}</h1>
      <h1>Age: {formData.age}</h1>
      <button onClick={handleNameChange}>ì´ë¦„ ë³€ê²½</button>
      <button onClick={handleAgeChange}>ë‚˜ì´ ë³€ê²½</button>
    </>
  );
}
```

### ì¤‘ì²© ê°ì²´ë„ ê°„ë‹¨í•˜ê²Œ

ì•„ê¹Œ ê·¸ ë³µì¡í–ˆë˜ ì¤‘ì²© ê°ì²´ ì—…ë°ì´íŠ¸ê°€ ì´ë ‡ê²Œ ë°”ë€ë‹¤.

```tsx
// âŒ Immer ì—†ì´
setUser({
  ...user,
  address: {
    ...user.address,
    district: {
      ...user.address.district,
      zip: "67890",
    },
  },
});

// âœ… Immer ì‚¬ìš©
setUser((draft) => {
  draft.address.district.zip = "67890";
});
```

### ë°°ì—´ ì—…ë°ì´íŠ¸ë„ ì§ê´€ì ìœ¼ë¡œ

```tsx {1,4,9,14}
const [items, setItems] = useImmer(["ğŸ", "ğŸŒ", "ğŸ‡"]);

// ì¶”ê°€
setItems((draft) => {
  draft.push("ğŸŠ");
});

// ì‚­ì œ
setItems((draft) => {
  const index = draft.findIndex((item) => item === "ğŸŒ");
  if (index !== -1) draft.splice(index, 1);
});

// ìˆ˜ì •
setItems((draft) => {
  draft[0] = "ğŸ‘";
});
```

---

## í•µì‹¬ ì •ë¦¬

| ê°œë…                    | ì„¤ëª…                                                         |
| :---------------------- | :----------------------------------------------------------- |
| **StateëŠ” ìŠ¤ëƒ…ìƒ·**      | ë Œë”ë§ ì‹œì ì˜ ê°’ì´ ê³ ì •ë˜ì–´ í•¨ìˆ˜ ë‚´ì—ì„œ ë³€í•˜ì§€ ì•ŠìŒ          |
| **Batching**            | ì—¬ëŸ¬ state ì—…ë°ì´íŠ¸ë¥¼ ë¬¶ì–´ì„œ í•œ ë²ˆë§Œ ë¦¬ë Œë”ë§                |
| **ì—…ë°ì´í„° í•¨ìˆ˜**       | ì´ì „ stateë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì•ˆì „í•˜ê²Œ ì—…ë°ì´íŠ¸ (`prev => prev + 1`) |
| **Lazy Initialization** | ë¬´ê±°ìš´ ì´ˆê¸°ê°’ ê³„ì‚°ì€ í•¨ìˆ˜ë¡œ ê°ì‹¸ì„œ ì „ë‹¬                      |
| **ë¶ˆë³€ì„±**              | ê°ì²´/ë°°ì—´ì€ ì§ì ‘ ë³€ê²½í•˜ì§€ ë§ê³  ìƒˆë¡œ ë§Œë“¤ì–´ì„œ êµì²´            |
| **Immer**               | ë³µì¡í•œ ë¶ˆë³€ì„± ê´€ë¦¬ë¥¼ ê°„í¸í•˜ê²Œ í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬              |

ì´ëŸ¬í•œ ê°œë…ë“¤ì„ ì˜ ì´í•´í•˜ê³  í™œìš©í•˜ë©´, ì„±ëŠ¥ ì¢‹ê³  ë²„ê·¸ ì—†ëŠ” React ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

---

## ì°¸ê³ ìë£Œ

- [React ê³µì‹ ë¬¸ì„œ - useState](https://react.dev/reference/react/useState)
- [React ê³µì‹ ë¬¸ì„œ - Updating Objects in State](https://react.dev/learn/updating-objects-in-state)
- [React ê³µì‹ ë¬¸ì„œ - Updating Arrays in State](https://react.dev/learn/updating-arrays-in-state)
- [MDN - Object.is()](https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Object/is)
- [Immer ê³µì‹ ë¬¸ì„œ](https://immerjs.github.io/immer/)
- [use-immer GitHub](https://github.com/immerjs/use-immer)
- [useState ê°•ì˜ ì˜ìƒ](https://youtu.be/fgjsQoTHcnE?si=-N3xe5-bfGH3iUuF)
