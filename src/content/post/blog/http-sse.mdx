---
title: HTTP í†µì‹  ê¸°ë²• - SSE(Server-Sent Events) ì´í•´ì™€ êµ¬í˜„
date: 2025-08-26
updatedDate: 2025-08-26
tags: [HTTP, SSE, Server-Sent Events, ì‹¤ì‹œê°„ í†µì‹ , EventSource]
category: HTTP
image: '/images/http-sse/thumbnail.webp'
---

# HTTP í†µì‹  ê¸°ë²•: SSE(Server-Sent Events) ì´í•´ì™€ êµ¬í˜„

![SSE](/images/http-sse/thumbnail.webp)

## SSEë€?

Server-Sent EventsëŠ” HTML5 ëª…ì„¸ì— ì •ì˜ëœ ê¸°ìˆ ë¡œ, ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ë¡œ ë‹¨ë°©í–¥ ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” í”„ë¡œí† ì½œì´ë‹¤.
[WebSocket](https://www.yolog.co.kr/post/http-websocket)ê³¼ ë‹¬ë¦¬ ì—¬ì „íˆ HTTPë¡œ ë™ì‘í•˜ë©°, ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œë§Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆë‹¤.

### í•µì‹¬ ê°œë…

Server-Sent EventsëŠ” ì„œë²„ê°€ íŠ¹ë³„í•œ HTTP ì‘ë‹µ í—¤ë” ê°’ì„ ì‘ë‹µì— ì‹£ëŠ” ê²ƒìœ¼ë¡œ ì‹œì‘í•œë‹¤.

```http
Content-Type: text/event-stream
```

ë¸Œë¼ìš°ì €ëŠ” [`Content-Type: text/event-stream`](https://developer.mozilla.org/ko/docs/Web/API/Server-sent_events) í—¤ë”ë¥¼ ë³´ê³  "ì„œë²„ê°€ ì–¸ì œë“ ì§€ ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆêµ¬ë‚˜"ë¼ê³  ì´í•´í•œë‹¤.

### ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¼ í˜•ì‹

```http
<
data: ê³ êµ¬ë§ˆ

data: ê³ êµ¬ë§ˆ ì•„ì´ìŠ¤í¬ë¦¼
```

- ê° ì´ë²¤íŠ¸ëŠ” ê°œí–‰ë¬¸ìë¡œ êµ¬ë¶„
- í•˜ë‚˜ì˜ ì´ë²¤íŠ¸ëŠ” ë¹ˆ ì¤„ë¡œ ì¢…ë£Œ

---

## ì´ë²¤íŠ¸ í•„ë“œ

Server-Sent EventsëŠ” ë‹¤ì–‘í•œ í•„ë“œë¥¼ ì œê³µí•œë‹¤ ([MDN ë¬¸ì„œ](https://developer.mozilla.org/ko-KR/docs/Web/API/Server-sent_events/Using_server-sent_events)):

### í•„ë“œë³„ ì„¤ëª…

| í•„ë“œ    | ì„¤ëª…                           | ì˜ˆì‹œ                      |
| ------- | ------------------------------ | ------------------------- |
| `data`  | ì „ì†¡í•  ë©”ì‹œì§€ ë°ì´í„°           | `data: {"msg": "hello"}`  |
| `id`    | ì´ë²¤íŠ¸ ì‹ë³„ì (ì¬ì—°ê²° ì‹œ ì‚¬ìš©) | `id: 12345`               |
| `event` | ì´ë²¤íŠ¸ íƒ€ì… ì§€ì •               | `event: userconnect`      |
| `retry` | ì¬ì—°ê²° ì‹œë„ ê°„ê²© (ë°€ë¦¬ì´ˆ)      | `retry: 10000`            |

```http
retry: 10000
id: 1756035473112
event: message
data: {"text":"ê³ êµ¬ë§ˆ","timestamp":1756035473112}
```

---

## ë¹„ìœ ë¡œ ì´í•´í•˜ê¸°

ë¼ë””ì˜¤ ë°©ì†¡ì„ ìƒê°í•´ë³´ì. ë°©ì†¡êµ­(ì„œë²„)ì€ ê³„ì† ì „íŒŒë¥¼ ì†¡ì¶œí•˜ê³ , ì²­ì·¨ì(í´ë¼ì´ì–¸íŠ¸)ëŠ” ì£¼íŒŒìˆ˜ë¥¼ ë§ì¶°ë‘ë©´ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°©ì†¡ì„ ë“¤ì„ ìˆ˜ ìˆë‹¤.
ì²­ì·¨ìê°€ ë°©ì†¡êµ­ì— ìš”ì²­í•  ìˆœ ì—†ì§€ë§Œ, ë°©ì†¡êµ­ì˜ ëª¨ë“  ì†Œì‹ì„ ë†“ì¹˜ì§€ ì•Šê³  ë°›ì„ ìˆ˜ ìˆë‹¤.

## íš¨ìœ¨ì„±ê³¼ ì œì•½ì‚¬í•­

### í´ë§ ëŒ€ë¹„ ì¥ì 

- **ë„¤íŠ¸ì›Œí¬ íš¨ìœ¨**: ì„œë²„ì— ë³€í™”ê°€ ìˆì„ ë•Œë§Œ ë°ì´í„° ì „ì†¡
- **ì„œë²„ ìì› ì ˆì•½**: ë¶ˆí•„ìš”í•œ ìš”ì²­/ì‘ë‹µ ì‚¬ì´í´ ì œê±°
- **í´ë¼ì´ì–¸íŠ¸ ë¶€ë‹´ ê°ì†Œ**: ë°˜ë³µ ìš”ì²­ ë¶ˆí•„ìš”

### ì œì•½ì‚¬í•­

- **ë‹¨ë°©í–¥ í†µì‹ **: ì„œë²„â†’í´ë¼ì´ì–¸íŠ¸ë§Œ ê°€ëŠ¥ (ì–‘ë°©í–¥ì€ [WebSocket](https://www.yolog.co.kr/post/http-websocket) í•„ìš”)
- **ì—°ê²° ìƒëª…ì£¼ê¸°**: ë¸Œë¼ìš°ì € íƒ­ ë‹«ìœ¼ë©´ ì—°ê²° ì¢…ë£Œ
- **ìœ ì§€ ë¹„ìš©**: ì—°ê²° ìœ ì§€ì— ë”°ë¥¸ ë¦¬ì†ŒìŠ¤ ì†Œë¹„ëŠ” ì—¬ì „íˆ ì¡´ì¬

ì‹¤ì œ êµ¬í˜„í•˜ë©´ì„œ í•œë²ˆ ì•Œì•„ë³´ê² ë‹¤.

---

## ì„œë²„ êµ¬í˜„

### ê¸°ë³¸ êµ¬ì¡°

```js
const http = require('http');
const path = require('path');
const static = require('../shared/serve-static');
const Message = require('../shared/message');

let waitingClients = [];
let message = null;

// í´ë¼ì´ì–¸íŠ¸ì˜ SSE êµ¬ë… ì²˜ë¦¬
const subscribe = (req, res) => {
  // text/event-stream í—¤ë”ë¡œ SSE ì‹œì‘ì„ ì•Œë¦¼
  res.setHeader('Content-Type', 'text/event-stream');
  res.write('\n'); // ë¹ˆ ì¤„ë¡œ í—¤ë” ì¢…ë£Œ

  // response ê°ì²´ë¥¼ ëŒ€ê¸°ì—´ì— ì¶”ê°€ (ìƒˆ ë°ì´í„° ìƒê¸¸ ë•Œê¹Œì§€ ìœ ì§€)
  waitingClients.push(res);

  // ì—°ê²° ì¢…ë£Œ ì²˜ë¦¬ (ë¸Œë¼ìš°ì € íƒ­ ë‹«ê¸°, ë„¤íŠ¸ì›Œí¬ ëŠê¹€ ë“±)
  // 'close' ì´ë²¤íŠ¸ ë°œìƒ ì‹œ ëŒ€ê¸°ì—´ì—ì„œ í•´ë‹¹ í´ë¼ì´ì–¸íŠ¸ ì œê±°
  // ì´ë ‡ê²Œ í•˜ì§€ ì•Šìœ¼ë©´ ëŠê¸´ ì—°ê²°ì— ê³„ì† ë°ì´í„°ë¥¼ ë³´ë‚´ë ¤ë‹¤ ì—ëŸ¬ ë°œìƒ
  req.on('close', () => {
    waitingClients = waitingClients.filter((client) => client !== res);
  });
};
```

ì´ë ‡ê²Œ êµ¬í˜„ì„ í•´ë´¤ê³ , curlë¡œ í•œë²ˆ ìš”ì²­ì„ í•´ë³´ê² ë‹¤.

```bash
curl http://localhost:8080/subscribe -v
```

```
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
> GET /subscribe HTTP/1.1
> Host: localhost:8080
> User-Agent: curl/8.7.1
> Accept: */*
>
* Request completely sent off
< HTTP/1.1 200 OK
< Content-Type: text/event-stream
< Date: Sun, 24 Aug 2025 11:31:35 GMT
< Connection: keep-alive
< Keep-Alive: timeout=5
< Transfer-Encoding: chunked
<
```

ì‘ë‹µìœ¼ë¡œ [`200 OK`](https://developer.mozilla.org/ko/docs/Web/HTTP/Status/200)ë¥¼ ë°›ì•˜ê³ , `Content-Type`ì€ `text/event-stream`ìœ¼ë¡œ ë˜ì–´ìˆë‹¤. ì„œë²„ê°€ ì‘ë‹µ ë³¸ë¬¸ì„ ë‹¤ ë³´ë‚´ì§€ ì•Šì•„ì„œ, ê³„ì† ì—°ê²°ì„ ìœ ì§€í•˜ê³  ìˆë‹¤.

### ë©”ì‹œì§€ ì—…ë°ì´íŠ¸ ë° ë¸Œë¡œë“œìºìŠ¤íŠ¸

ì´ë²ˆì—ëŠ” ìƒˆ ë©”ì‹œì§€ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” update í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ë³´ê² ë‹¤.

```js
const update = (req, res) => {
  let body = '';

  req.on('data', (chunk) => {
    body = body + chunk.toString();
  });

  req.on('end', () => {
    const { text } = JSON.parse(body);

    if (!text) {
      res.statusCode = 400;
      res.setHeader('Content-Type', 'application/json');
      res.write(JSON.stringify({ error: 'text í•„ë“œë¥¼ ì±„ì›Œì£¼ì„¸ìš”' }));
      res.end();
      return;
    }

    message = new Message(text);

    // ëŒ€ê¸° ì¤‘ì¸ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì´ë²¤íŠ¸ ì „ì†¡
    for (const waitingClient of waitingClients) {
      // ë©”ì‹œì§€ë¥¼ ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¼ í˜•ì‹(data í•„ë“œ)ìœ¼ë¡œ ì „ì†¡
      // ê°œí–‰ë¬¸ì 2ê°œë¡œ ì´ë²¤íŠ¸ í•˜ë‚˜ë¥¼ ì¢…ë£Œ
      waitingClient.write([`data: ${message}\n\n`].join(''));
    }

    // update ìš”ì²­í•œ í´ë¼ì´ì–¸íŠ¸ì—ê²ŒëŠ” ì¼ë°˜ ì‘ë‹µ
    res.write(`${message}`);
    res.end();
  });
};

// ë¼ìš°íŒ… í•¸ë“¤ëŸ¬
const handler = (req, res) => {
  const { pathname } = new URL(req.url, `http://${req.headers.host}`);

  if (pathname === '/subscribe') return subscribe(req, res);
  if (pathname === '/update') return update(req, res);

  static(path.join(__dirname, 'public'))(req, res);
};

const server = http.createServer(handler);
server.listen(8080, () => console.log('server is running ::8080'));
```

### í…ŒìŠ¤íŠ¸

ì´ë ‡ê²Œ êµ¬í˜„ì„ í•˜ê³  ì„œë²„ë¥¼ ì¬ì‹¤í–‰í•˜ì—¬, í•œë²ˆ ë‹¤ì‹œ subscribeë¡œ êµ¬ë…ì„ í•´ë³´ê² ë‹¤.

```bash
curl http://localhost:8080/subscribe -v
```

í´ë¼ì´ì–¸íŠ¸ëŠ” ì•„ê¹Œì™€ ë™ì¼í•˜ê²Œ `text/event-stream`ìœ¼ë¡œ ì‘ë‹µì„ ë°›ëŠ”ë‹¤:

```
* Request completely sent off
< HTTP/1.1 200 OK
< Content-Type: text/event-stream
< Date: Sun, 24 Aug 2025 11:36:46 GMT
< Connection: keep-alive
< Keep-Alive: timeout=5
< Transfer-Encoding: chunked
<
```

ë³¸ë¬¸ì´ ì˜¬ ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê³  ìˆë‹¤.

ë‹¤ë¥¸ í´ë¼ì´ì–¸íŠ¸ë¥¼ í•˜ë‚˜ ë” ì—´ì–´ì„œ update APIë¥¼ í˜¸ì¶œí•´ë³´ê² ë‹¤:

```bash
curl http://localhost:8080/update \
  -H "Content-Type: application/json" \
  -d '{"text":"ê³ êµ¬ë§ˆ"}' -v
```

ê·¸ëŸ¬ë©´ ê¸°ë‹¤ë¦¬ê³  ìˆë˜ ì²«ë²ˆì§¸ í´ë¼ì´ì–¸íŠ¸ì— ë³¸ë¬¸ì´ ë„ì°©í•œë‹¤:

```
data: {"text":"ê³ êµ¬ë§ˆ","timestamp":1756035473112}
```

update APIë¥¼ í˜¸ì¶œí•œ í´ë¼ì´ì–¸íŠ¸ë„ JSON ì‘ë‹µì„ ë°›ëŠ”ë‹¤:

```
< HTTP/1.1 200 OK
< Date: Sun, 24 Aug 2025 11:37:53 GMT
< Connection: keep-alive
< Keep-Alive: timeout=5
< Transfer-Encoding: chunked
<
{"text":"ê³ êµ¬ë§ˆ","timestamp":1756035473112}
```

---

## í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„

ë¸Œë¼ìš°ì €ëŠ” [`EventSource`](https://developer.mozilla.org/ko/docs/Web/API/EventSource) í´ë˜ìŠ¤ë¥¼ ì œê³µí•œë‹¤:

```js
const subscribe = () => {
  // EventSourceë¡œ ì„œë²„ì™€ ì—°ê²° (ë¸Œë¼ìš°ì €ê°€ SSE ì´ë²¤íŠ¸ ìˆ˜ì‹  ì¤€ë¹„)
  const eventSource = new EventSource('/subscribe');

  // ì„œë²„ì—ì„œ data í•„ë“œ ì „ì†¡ ì‹œ message ì´ë²¤íŠ¸ ë°œìƒ
  eventSource.addEventListener('message', (event) => {
    // JSON ë¬¸ìì—´ íŒŒì‹± í›„ ë Œë”ë§
    render(JSON.parse(event.data));
  });
};

const render = (message) => {
  const messageElement = document.createElement('div');
  const { text } = message;
  const timestamp = new Date(message.timestamp).toLocaleTimeString();
  messageElement.textContent = `${text} (${timestamp})`;
  document.body.appendChild(messageElement);
};

const init = () => {
  subscribe();
};

// DOM ìƒì„± ì™„ë£Œ ì‹œ SSE êµ¬ë… ì‹œì‘
document.addEventListener('DOMContentLoaded', init);
```

![SSE ì—°ê²° ì„±ê³µ](/images/http-sse/1.webp)

![ì‹¤ì œë¡œ ë©”ì‹œì§€ë¥¼ ë°›ê³ ë„ ê³„ì†í•´ì„œ SSE ì—°ê²°ì´ ìœ ì§€ ë¨](/images/http-sse/2.webp)

ë¸Œë¼ìš°ì €ì—ì„œëŠ” ì„œë²„ë¡œë¶€í„° ìƒˆë¡œìš´ ì•Œë¦¼ì´ ë„ì°©í–ˆê³ , ë„¤íŠ¸ì›Œí¬ ìš”ì²­ë„ ëŠì–´ì§€ì§€ ì•Šê³  ê³„ì† ìœ ì§€ë˜ê³  ìˆë‹¤.

í´ë¼ì´ì–¸íŠ¸ì—ì„œ í•œë²ˆ ë” ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë³´ê² ë‹¤:

```bash
curl http://localhost:8080/update \
  -H "Content-Type: application/json" \
  -d '{"text":"ê³ êµ¬ë§ˆ ì•„ì´ìŠ¤í¬ë¦¼"}' -v
```

ì‘ë‹µ:

```
< HTTP/1.1 200 OK
< Date: Sun, 24 Aug 2025 11:47:01 GMT
< Connection: keep-alive
< Keep-Alive: timeout=5
< Transfer-Encoding: chunked
<
{"text":"ê³ êµ¬ë§ˆ ì•„ì´ìŠ¤í¬ë¦¼","timestamp":1756036021866}
```

![ë‘ë²ˆì§¸ ë©”ì‹œì§€ë„ ì •ìƒ ìˆ˜ì‹ ë¨ì„ í™•ì¸í•  ìˆ˜ ìˆìŒ](/images/http-sse/3.webp)

[í´ë§](https://www.yolog.co.kr/post/http-polling)ì´ë‚˜ [ë¡±í´ë§](https://www.yolog.co.kr/post/http-long-polling)ê³¼ ë¹„êµí–ˆì„ ë•Œ, Server-Sent EventsëŠ” ë” ê°„ë‹¨í•˜ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. í•œë²ˆ ì—°ê²°í•˜ë©´ ê³„ì† ë©”ì‹œì§€ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.

ë§ˆì¹˜ êµ¬ë…í•œ ìœ íŠœë¸Œ ì±„ë„ì—ì„œ ìƒˆ ì˜ìƒì´ ì˜¬ë¼ì˜¤ë©´ ìë™ìœ¼ë¡œ ì•Œë¦¼ì„ ë°›ëŠ” ê²ƒê³¼ ê°™ë‹¤. ê³„ì† í™•ì¸í•  í•„ìš” ì—†ì´ ì„œë²„ê°€ ì•Œì•„ì„œ ë³´ë‚´ì¤€ë‹¤.

---

## ìë™ ì¬ì—°ê²° ê¸°ëŠ¥

### fetchì™€ì˜ ì°¨ì´ì 

fetchë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ìœ¼ë¡œ ì‹œì‘í•´ì„œ, ì„œë²„ì˜ ì‘ë‹µìœ¼ë¡œ HTTP í†µì‹ ì´ ì¢…ë£Œëœë‹¤.
ë‹¤ì‹œ ì—°ê²°í•˜ë ¤ë©´ fetch í•¨ìˆ˜ë¥¼ ë‹¤ì‹œ í˜¸ì¶œí•˜ëŠ” ì½”ë“œë¥¼ ì§ì ‘ ì‘ì„±í•´ì•¼ í•œë‹¤.

í•˜ì§€ë§Œ `EventSource`ëŠ” ì—°ê²°ì´ ëŠê¸°ë©´ ìë™ìœ¼ë¡œ ì¬ì ‘ì†ì„ ì‹œë„í•œë‹¤.
ë¸Œë¼ìš°ì €ê°€ ë„¤íŠ¸ì›Œí¬ ë¬¸ì œë¡œ ì„œë²„ì™€ ì—°ê²°ì´ ëŠê¸°ë©´, ì´ ê°ì²´ëŠ” ì¼ì • ì‹œê°„ í›„ì— ìŠ¤ìŠ¤ë¡œ HTTP ìš”ì²­ì„ ë‹¤ì‹œ ë§Œë“ ë‹¤.

### 1. ìë™ ì¬ì—°ê²° ë™ì‘

ì„œë²„ì™€ ì—°ê²°ëœ ìƒíƒœì—ì„œ ì„œë²„ë¥¼ ì¢…ë£Œì‹œì¼œë³´ê² ë‹¤.

![ì„œë²„ ì¢…ë£Œ í›„ ìë™ ì¬ì—°ê²° ì‹œë„](/images/http-sse/4.webp)

ì„œë²„ë¥¼ ì¢…ë£Œí•˜ë©´ ë¸Œë¼ìš°ì €ëŠ” ê¸°ì¡´ ì—°ê²°ì´ ëŠê¸´ ê²ƒì„ ê°ì§€í•˜ê³ , ìë™ìœ¼ë¡œ ìƒˆë¡œìš´ ìš”ì²­ì„ ìƒì„±í•œë‹¤.
ì„œë²„ê°€ êº¼ì ¸ìˆìœ¼ë‹ˆ ì‹¤íŒ¨í•˜ì§€ë§Œ, ë¸Œë¼ìš°ì €ëŠ” í¬ê¸°í•˜ì§€ ì•Šê³  ê³„ì† ì¬ì—°ê²°ì„ ì‹œë„í•œë‹¤.

![ì„œë²„ ì¬ì‹¤í–‰ ì‹œ ìë™ìœ¼ë¡œ ì—°ê²° ë³µêµ¬](/images/http-sse/5.webp)

ì„œë²„ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ë©´ ëŒ€ê¸° ì¤‘ì´ë˜ ìš”ì²­ì´ ì„±ê³µí•˜ë©° ì—°ê²°ì´ ìë™ ë³µêµ¬ëœë‹¤.

### 2. ì¬ì—°ê²° ê°„ê²© ì„¤ì •

ì„œë²„ì—ì„œ `retry` í•„ë“œë¡œ ì¬ì—°ê²° ê°„ê²©ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤:

```js
for (const waitingClient of waitingClients) {
  waitingClient.write(
    [
      `retry: 10000\n`, // 10ì´ˆ í›„ ì¬ì—°ê²° ì‹œë„
      `data: ${message}\n\n`,
    ].join('')
  );
}
```

ì´ì œ ì„œë²„ë¥¼ ë‹¤ì‹œ ì¢…ë£Œí•˜ë©´ ê¸°ë³¸ê°’ë³´ë‹¤ ëŠ¦ê²Œ(10ì´ˆ í›„) ì¬ì—°ê²°ì„ ì‹œë„í•œë‹¤.

### 3. ëˆ„ë½ ë©”ì‹œì§€ ë³µêµ¬ (Last-Event-ID)

ì—°ê²°ì´ ëŠê¸´ ë™ì•ˆ ë†“ì¹œ ë©”ì‹œì§€ë¥¼ ë°›ì„ ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ìˆë‹¤.

#### ì„œë²„: ì´ë²¤íŠ¸ ID ì „ì†¡

```js
for (const waitingClient of waitingClients) {
  waitingClient.write(
    [
      `retry: 10000\n`,
      `id: ${message.timestamp}\n`, // ì´ë²¤íŠ¸ ì‹ë³„ì
      `data: ${message}\n\n`,
    ].join('')
  );
}
```

#### ì„œë²„: ì¬ì—°ê²° ì‹œ Last-Event-ID ì²˜ë¦¬

```js
const subscribe = (req, res) => {
  const lastEventId = req.headers['last-event-id'];

  if (lastEventId) {
    // ì¬ì—°ê²°: ë†“ì¹œ ë©”ì‹œì§€ë“¤ì„ ì „ì†¡
    console.log('ì¬ì—°ê²° - ë§ˆì§€ë§‰ ì´ë²¤íŠ¸ ID:', lastEventId);
    // ì‹¤ë¬´ì—ì„œëŠ” lastEventId ì´í›„ì˜ ë©”ì‹œì§€ë¥¼ DBì—ì„œ ì¡°íšŒí•˜ì—¬ ì „ì†¡
  }

  res.setHeader('Content-Type', 'text/event-stream');
  res.write('\n');
  waitingClients.push(res);
};
```

#### ë™ì‘ íë¦„

1. **ì²« ì—°ê²° ì‹œ**: ì„œë²„ ì½˜ì†”ì— `lastEventId undefined` ì¶œë ¥
2. **ì„œë²„ ì¢…ë£Œ í›„ ì¬ì‹œì‘**
3. **ë¸Œë¼ìš°ì € ì¬ì—°ê²° ì‹œë„**:

![Last-Event-ID í—¤ë” ì „ì†¡](/images/http-sse/6.webp)

ë¸Œë¼ìš°ì €ê°€ ì¬ì—°ê²°í•  ë•Œ Request Headersì— [`Last-Event-ID: 1756036714406`](https://developer.mozilla.org/ko/docs/Web/API/Server-sent_events/Using_server-sent_events#last_event_id)ë¥¼ í¬í•¨ì‹œí‚¨ë‹¤.
ì´ëŠ” ë§ˆì§€ë§‰ìœ¼ë¡œ ë°›ì€ ì´ë²¤íŠ¸ì˜ IDë¡œ, ì„œë²„ê°€ ë†“ì¹œ ë©”ì‹œì§€ë¥¼ íŒŒì•…í•˜ëŠ” ê¸°ì¤€ì´ ëœë‹¤.

4. **ì„œë²„ ì½˜ì†” ì¶œë ¥**:

```bash
server is running ::8080
lastEventId 1756036714406  # í´ë¼ì´ì–¸íŠ¸ê°€ ë§ˆì§€ë§‰ìœ¼ë¡œ ë°›ì€ ì´ë²¤íŠ¸ ID
```

ì„œë²„ëŠ” ì´ ID ì´í›„ì˜ ë©”ì‹œì§€ë“¤ì„ ì¡°íšŒí•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ì†¡í•˜ë©´ ëœë‹¤.

---

## í†µì‹  ê¸°ë²• ë¹„êµ: Polling vs Long Polling vs Server-Sent Events

| êµ¬ë¶„              | [Polling](https://www.yolog.co.kr/post/http-polling)                   | [Long Polling](https://www.yolog.co.kr/post/http-long-polling)     | Server-Sent Events       |
| ----------------- | ------------------------- | ---------------- | ------------------------ |
| **í†µì‹  ë°©í–¥**     | ì–‘ë°©í–¥                    | ì–‘ë°©í–¥           | ì„œë²„â†’í´ë¼ì´ì–¸íŠ¸ ë‹¨ë°©í–¥   |
| **ì—°ê²° ìœ ì§€**     | ë§¤ë²ˆ ìƒˆ ì—°ê²°              | ì‘ë‹µê¹Œì§€ ìœ ì§€    | ì§€ì†ì  ì—°ê²° ìœ ì§€         |
| **ì‹¤ì‹œê°„ì„±**      | ì£¼ê¸°ì— ë”°ë¼ ì§€ì—°          | ì¦‰ì‹œ ì „ë‹¬        | ì¦‰ì‹œ ì „ë‹¬                |
| **ë„¤íŠ¸ì›Œí¬ íš¨ìœ¨** | ë‚®ìŒ (ë¶ˆí•„ìš”í•œ ìš”ì²­ ë§ìŒ) | ì¤‘ê°„             | ë†’ìŒ (í•„ìš”ì‹œë§Œ ì „ì†¡)     |
| **ì„œë²„ ë¶€ë‹´**     | ë‚®ìŒ                      | ì¤‘ê°„ (ì—°ê²° ìœ ì§€) | ì¤‘ê°„ (ì—°ê²° ìœ ì§€)         |
| **êµ¬í˜„ ë³µì¡ë„**   | ë§¤ìš° ê°„ë‹¨                 | ì¤‘ê°„             | ê°„ë‹¨ (EventSource API)   |
| **ìë™ ì¬ì—°ê²°**   | ìˆ˜ë™ êµ¬í˜„                 | ìˆ˜ë™ êµ¬í˜„        | ìë™ ì§€ì›                |
| **ë¸Œë¼ìš°ì € ì§€ì›** | ëª¨ë“  ë¸Œë¼ìš°ì €             | ëª¨ë“  ë¸Œë¼ìš°ì €    | IE ì œì™¸ ëŒ€ë¶€ë¶„           |
| **í”„ë¡œí† ì½œ**      | HTTP                      | HTTP             | HTTP (text/event-stream) |

---

## SSE ì‹¤ë¬´ í™œìš© ì‚¬ë¡€

### 1. ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œìŠ¤í…œ

```js
// ì„œë²„: ìƒˆ ì•Œë¦¼ ë°œìƒ ì‹œ
eventSource.write(
  `data: ${JSON.stringify({
    type: 'notification',
    title: 'ìƒˆ ë©”ì‹œì§€',
    body: 'ê¹€ì² ìˆ˜ë‹˜ì´ ë©”ì‹œì§€ë¥¼ ë³´ëƒˆìŠµë‹ˆë‹¤',
  })}\n\n`
);
```

### 2. ëŒ€ì‹œë³´ë“œ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸

- **ì£¼ì‹ ì‹œì„¸**: ì‹¤ì‹œê°„ ê°€ê²© ë³€ë™ ìŠ¤íŠ¸ë¦¬ë°
- **ëª¨ë‹ˆí„°ë§**: ì„œë²„ ë©”íŠ¸ë¦­, ì—ëŸ¬ ë¡œê·¸ ì‹¤ì‹œê°„ í‘œì‹œ
- **ë¶„ì„ ëŒ€ì‹œë³´ë“œ**: ì‹¤ì‹œê°„ ë°©ë¬¸ì ìˆ˜, ë§¤ì¶œ í˜„í™©

### 3. ë¼ì´ë¸Œ í”¼ë“œ

- **ì†Œì…œ ë¯¸ë””ì–´**: Twitter, Facebookì˜ ì‹¤ì‹œê°„ íƒ€ì„ë¼ì¸
- **ë‰´ìŠ¤ ì†ë³´**: ì‹¤ì‹œê°„ ë‰´ìŠ¤ ì—…ë°ì´íŠ¸
- **ìŠ¤í¬ì¸  ì¤‘ê³„**: ì‹¤ì‹œê°„ ì ìˆ˜ ì—…ë°ì´íŠ¸

### 4. ì§„í–‰ ìƒíƒœ ì•Œë¦¼

```js
// ì„œë²„: íŒŒì¼ ì—…ë¡œë“œ ì§„í–‰ë¥ 
for (let progress = 0; progress <= 100; progress += 10) {
  client.write(
    `data: ${JSON.stringify({
      type: 'progress',
      value: progress,
    })}\n\n`
  );
}
```

### 5. í˜‘ì—… ë„êµ¬

- **Google Docs**: ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ì»¤ì„œ ìœ„ì¹˜, í¸ì§‘ ë‚´ìš©
- **Trello**: ì¹´ë“œ ì´ë™, ëŒ“ê¸€ ì•Œë¦¼
- **Slack**: íƒ€ì´í•‘ ì¸ë””ì¼€ì´í„°, ì˜¨ë¼ì¸ ìƒíƒœ

---

## Server-Sent Eventsê°€ ì í•©í•œ ê²½ìš° vs ë‹¤ë¥¸ ê¸°ìˆ  ì„ íƒ

### Server-Sent Eventsë¥¼ ì„ íƒí•´ì•¼ í•  ë•Œ

- âœ… **ì„œë²„â†’í´ë¼ì´ì–¸íŠ¸ ë‹¨ë°©í–¥ í†µì‹ **ë§Œ í•„ìš”
- âœ… **HTTP ì¸í”„ë¼**ë§Œ ì‚¬ìš© ê°€ëŠ¥í•œ í™˜ê²½
- âœ… **ìë™ ì¬ì—°ê²°**ì´ ì¤‘ìš”í•œ ì„œë¹„ìŠ¤
- âœ… **í…ìŠ¤íŠ¸ ê¸°ë°˜** ë°ì´í„° ì „ì†¡
- âœ… êµ¬í˜„ **ë‹¨ìˆœì„±**ì´ ì¤‘ìš”

### [WebSocket](https://www.yolog.co.kr/post/http-websocket)ì„ ì„ íƒí•´ì•¼ í•  ë•Œ

- âš¡ **ì–‘ë°©í–¥ ì‹¤ì‹œê°„ í†µì‹ ** í•„ìš” (ì±„íŒ…, ê²Œì„)
- âš¡ **ë°”ì´ë„ˆë¦¬ ë°ì´í„°** ì „ì†¡
- âš¡ **ì´ˆì €ì§€ì—°**ì´ ì¤‘ìš”í•œ ì„œë¹„ìŠ¤
- âš¡ ë†’ì€ ë©”ì‹œì§€ **ë¹ˆë„** (ì´ˆë‹¹ ìˆ˜ì‹­~ìˆ˜ë°± ê°œ)

### [Long Polling](https://www.yolog.co.kr/post/http-long-polling)ì„ ì„ íƒí•´ì•¼ í•  ë•Œ

- ğŸ”„ **ë ˆê±°ì‹œ ë¸Œë¼ìš°ì €** ì§€ì› í•„ìš” (IE ë“±)
- ğŸ”„ **ê°„í—ì  ì—…ë°ì´íŠ¸**ë§Œ í•„ìš”
- ğŸ”„ **í”„ë¡ì‹œ/ë°©í™”ë²½**ì´ ì—„ê²©í•œ í™˜ê²½

---

## ì¥ë‹¨ì  ì •ë¦¬

### ì¥ì 

- âœ… **êµ¬í˜„ ê°„ë‹¨**: EventSource APIë¡œ ì‰½ê²Œ êµ¬í˜„
- âœ… **ìë™ ì¬ì—°ê²°**: ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ ìë™ ë³µêµ¬
- âœ… **í‘œì¤€ HTTP**: íŠ¹ë³„í•œ í”„ë¡œí† ì½œ ë¶ˆí•„ìš”
- âœ… **íš¨ìœ¨ì **: í•„ìš”ì‹œì—ë§Œ ë°ì´í„° ì „ì†¡
- âœ… **ìˆœì„œ ë³´ì¥**: ì´ë²¤íŠ¸ IDë¡œ ìˆœì„œ ê´€ë¦¬

### ë‹¨ì 

- âŒ **ë‹¨ë°©í–¥ í†µì‹ **: ì„œë²„â†’í´ë¼ì´ì–¸íŠ¸ë§Œ ê°€ëŠ¥
- âŒ **í…ìŠ¤íŠ¸ë§Œ ì „ì†¡**: ë°”ì´ë„ˆë¦¬ ë°ì´í„° ë¶ˆê°€
- âŒ **ì—°ê²° ì œí•œ**: ë¸Œë¼ìš°ì €ë‹¹ 6ê°œ ì—°ê²° ì œí•œ
- âŒ **IE ë¯¸ì§€ì›**: Internet Explorer í˜¸í™˜ì„± ì—†ìŒ

---

## ë§ˆì¹˜ë©°

Server-Sent EventsëŠ” ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œ ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ í‘¸ì‹œí•˜ëŠ” ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•ì´ë‹¤.

- [Polling](https://www.yolog.co.kr/post/http-polling)ì˜ ë„¤íŠ¸ì›Œí¬ ë‚­ë¹„ í•´ê²°
- [Long Polling](https://www.yolog.co.kr/post/http-long-polling)ì˜ êµ¬í˜„ ë³µì¡ë„ ê°œì„ 
- [WebSocket](https://www.yolog.co.kr/post/http-websocket)ë³´ë‹¤ ê°„ë‹¨í•œ êµ¬í˜„

íŠ¹íˆ ì‹¤ì‹œê°„ ì•Œë¦¼, ëŒ€ì‹œë³´ë“œ, ë¼ì´ë¸Œ í”¼ë“œ ê°™ì€ ë‹¨ë°©í–¥ ìŠ¤íŠ¸ë¦¬ë°ì— ìµœì í™”ë˜ì–´ ìˆë‹¤.
ì–‘ë°©í–¥ í†µì‹ ì´ í•„ìš” ì—†ë‹¤ë©´, Server-Sent EventsëŠ” ì—¬ì „íˆ í›Œë¥­í•œ ì„ íƒì§€ë‹¤.

ë‹¤ìŒ í¬ìŠ¤íŠ¸ì—ì„œëŠ” ì§„ì •í•œ ì–‘ë°©í–¥ ì‹¤ì‹œê°„ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” [**WebSocket**](https://www.yolog.co.kr/post/http-websocket)ì„ ë‹¤ë£¨ê² ë‹¤.

## í•µì‹¬ ì •ë¦¬

- **SSEë€**: HTML5ì— ì •ì˜ëœ ì„œë²„â†’í´ë¼ì´ì–¸íŠ¸ ë‹¨ë°©í–¥ ì‹¤ì‹œê°„ ë°ì´í„° ì „ì†¡ í”„ë¡œí† ì½œ
- **í•µì‹¬ í—¤ë”**: `Content-Type: text/event-stream`ìœ¼ë¡œ SSE ìŠ¤íŠ¸ë¦¼ ì‹œì‘
- **ì´ë²¤íŠ¸ í•„ë“œ**:
  - `data`: ì „ì†¡í•  ë©”ì‹œì§€ ë°ì´í„°
  - `id`: ì´ë²¤íŠ¸ ì‹ë³„ì (ì¬ì—°ê²° ì‹œ ì‚¬ìš©)
  - `event`: ì´ë²¤íŠ¸ íƒ€ì… ì§€ì •
  - `retry`: ì¬ì—°ê²° ì‹œë„ ê°„ê²© (ë°€ë¦¬ì´ˆ)
- **ìë™ ì¬ì—°ê²°**: EventSourceê°€ ì—°ê²° ëŠê¹€ ì‹œ ìë™ìœ¼ë¡œ ì¬ì ‘ì† ì‹œë„
- **Last-Event-ID**: ì¬ì—°ê²° ì‹œ ë†“ì¹œ ë©”ì‹œì§€ ë³µêµ¬ ê°€ëŠ¥
- **ì‹¤ë¬´ í™œìš©**: ì‹¤ì‹œê°„ ì•Œë¦¼, ëŒ€ì‹œë³´ë“œ, ë¼ì´ë¸Œ í”¼ë“œ, ì§„í–‰ ìƒíƒœ ì•Œë¦¼
- **ì„ íƒ ê¸°ì¤€**:
  - SSE: ì„œë²„â†’í´ë¼ì´ì–¸íŠ¸ ë‹¨ë°©í–¥, ìë™ ì¬ì—°ê²° ì¤‘ìš”, êµ¬í˜„ ë‹¨ìˆœì„±
  - WebSocket: ì–‘ë°©í–¥ í†µì‹ , ë°”ì´ë„ˆë¦¬ ë°ì´í„°, ì´ˆì €ì§€ì—°
  - Long Polling: ë ˆê±°ì‹œ ë¸Œë¼ìš°ì €, ê°„í—ì  ì—…ë°ì´íŠ¸

**SSEëŠ” ë¼ë””ì˜¤ ë°©ì†¡ê³¼ ê°™ë‹¤. ë°©ì†¡êµ­(ì„œë²„)ì´ ì „íŒŒë¥¼ ì†¡ì¶œí•˜ë©´ ì²­ì·¨ì(í´ë¼ì´ì–¸íŠ¸)ëŠ” ì£¼íŒŒìˆ˜ë§Œ ë§ì¶°ë‘ë©´ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°©ì†¡ì„ ë“¤ì„ ìˆ˜ ìˆë‹¤. êµ¬ë…í•œ ì±„ë„ì—ì„œ ìë™ìœ¼ë¡œ ì•Œë¦¼ì„ ë°›ëŠ” ê²ƒì²˜ëŸ¼ ì„œë²„ê°€ ì•Œì•„ì„œ ë³´ë‚´ì¤€ë‹¤.**
