---
title: "React ì „ì—­ ìƒíƒœ ê´€ë¦¬ ì™„ë²½ ê°€ì´ë“œ: Context API vs Zustand vs Jotai"
date: 2025-11-15
updatedDate: 2025-11-15
tags:
  [
    React,
    ìƒíƒœê´€ë¦¬,
    Global State,
    Context API,
    Zustand,
    Jotai,
    Props Drilling,
    ì„±ëŠ¥ìµœì í™”,
  ]
category: DEVELOPMENT
image: "/images/global-state/thumbnail.webp"
---

React ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ë‹¤ ë³´ë©´ ìƒíƒœ ê´€ë¦¬ê°€ ì ì  ë³µì¡í•´ì§„ë‹¤. ì²˜ìŒì—” [`useState`](https://react.dev/reference/react/useState) ëª‡ ê°œë©´ ì¶©ë¶„í–ˆëŠ”ë°, ì–´ëŠìƒˆ propsë¥¼ 5ë‹¨ê³„ì”© ë‚´ë ¤ ì „ë‹¬í•˜ê³  ìˆëŠ” ìì‹ ì„ ë°œê²¬í•œë‹¤. `Context API`ë¥¼ ì“°ë©´ ê°„ë‹¨í•  ê²ƒ ê°™ì€ë° ì„±ëŠ¥ ë¬¸ì œê°€ ê±±ì •ëœë‹¤. `Zustand`? `Jotai`? `Redux`? ì„ íƒì§€ëŠ” ë„ˆë¬´ ë§ê³ , ê°ê° ì–´ë–¤ ì°¨ì´ê°€ ìˆëŠ”ì§€ ëª…í™•í•˜ì§€ ì•Šë‹¤.

ì´ ê¸€ì—ì„œëŠ” **ì™œ** ì „ì—­ ìƒíƒœê°€ í•„ìš”í•œì§€ë¶€í„° ì‹œì‘í•´ì„œ, ê° ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ **ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–»ê²Œ ë™ì‘**í•˜ê¸¸ë˜ ì„±ëŠ¥ ì°¨ì´ê°€ ë‚˜ëŠ”ì§€ê¹Œì§€ ê¹Šì´ ìˆê²Œ ë‹¤ë£¬ë‹¤. ì›ë¦¬ë¥¼ ì´í•´í•˜ë©´ í”„ë¡œì íŠ¸ì— ë§ëŠ” í˜„ëª…í•œ ì„ íƒì„ í•  ìˆ˜ ìˆë‹¤.

---

## ìƒíƒœì˜ ì„¸ ê°€ì§€ ì¢…ë¥˜

ë³¸ê²©ì ìœ¼ë¡œ ì‹œì‘í•˜ê¸° ì „ì—, ìƒíƒœë¥¼ ì„¸ ê°€ì§€ë¡œ êµ¬ë¶„í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.

`ë¡œì»¬ ìƒíƒœ(Local State)`
í•œ ì»´í¬ë„ŒíŠ¸ ì•ˆì—ì„œë§Œ ì‚¬ìš©í•˜ëŠ” ìƒíƒœë‹¤. ë§ˆì¹˜ ê°œì¸ ìˆ˜ì²©ì— ì ì–´ë‘” ë©”ëª¨ì™€ ê°™ë‹¤. ë‹¤ë¥¸ ì‚¬ëŒ(ì»´í¬ë„ŒíŠ¸)ì´ ë³¼ í•„ìš”ê°€ ì—†ë‹¤.

```ts
function LoginForm() {
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");
  // email, passwordëŠ” ì´ í¼ì—ì„œë§Œ í•„ìš”
}
```

`ì „ì—­ ìƒíƒœ(Global State)`
ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ê°€ ê³µìœ í•˜ëŠ” ìƒíƒœë‹¤. íšŒì‚¬ ê³µì§€ ê²Œì‹œíŒì²˜ëŸ¼, ëˆ„êµ¬ë‚˜ ë³¼ ìˆ˜ ìˆê³  ìˆ˜ì •í•˜ë©´ ëª¨ë‘ì—ê²Œ ë°˜ì˜ëœë‹¤.

```ts
// ì¥ë°”êµ¬ë‹ˆëŠ” í—¤ë”, ìƒí’ˆ ëª©ë¡, ê²°ì œ í˜ì´ì§€ì—ì„œ ëª¨ë‘ í•„ìš”
const cart = useCartStore((state) => state.cart);
```

`ì„œë²„ ìƒíƒœ(Server State)`
APIì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„°ë‹¤. ì´ê±´ ì¡°ê¸ˆ íŠ¹ë³„í•œë°, ìš°ë¦¬ê°€ ì™„ì „íˆ í†µì œí•  ìˆ˜ ì—†ë‹¤. ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ë°”ê¿€ ìˆ˜ë„ ìˆê³ , ë„¤íŠ¸ì›Œí¬ê°€ ëŠë¦´ ìˆ˜ë„ ìˆë‹¤.

```ts
// ì‚¬ìš©ì ëª©ë¡ì€ ì„œë²„ì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„°
const { data: users } = useQuery(["users"], fetchUsers);
```

ì´ ê¸€ì—ì„œëŠ” **ë¡œì»¬ ìƒíƒœ**ì™€ **ì „ì—­ ìƒíƒœ**ì— ì§‘ì¤‘í•œë‹¤. ì„œë²„ ìƒíƒœëŠ” ê¸°íšŒê°€ ë˜ë©´ ë‹¤ë¥¸ ê¸€ì—ì„œ ìì„¸íˆ ë‹¤ë£¨ê² ë‹¤.

---

## Local Stateë¡œë§Œ ê´€ë¦¬í•˜ë©´ ë­ê°€ ë¬¸ì œì¼ê¹Œ?

ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•ë¶€í„° ì‹œì‘í•´ë³´ì. `useState`ë¡œ ëª¨ë“  ìƒíƒœë¥¼ ê´€ë¦¬í•˜ë©´ ì•ˆ ë ê¹Œ?

```ts
function App() {
  const [user, setUser] = useState(null);

  return (
    <div>
      <Header user={user} />
      <Dashboard user={user} />
      <Footer user={user} />
    </div>
  );
}
```

ë¬¸ì œì—†ì–´ ë³´ì¸ë‹¤. í•˜ì§€ë§Œ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ê°€ ê¹Šì–´ì§€ë©´ ìƒí™©ì´ ë‹¬ë¼ì§„ë‹¤.

---

## Props Drilling - ì¤‘ê°„ ì „ë‹¬ìë§Œ 3ëª…

ì‹¤ì œ ì•±ì˜ ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°ë¥¼ ë³´ì.

```ts
function App() {
  return <Parent name="ë§¤íŠœ" />;
}

// ParentëŠ” nameì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤
function Parent({ name }: { name: string }) {
  return <Child name={name} />;
}

// Childë„ nameì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤
function Child({ name }: { name: string }) {
  return <GrandChild name={name} />;
}

// ë“œë””ì–´ ì‹¤ì œë¡œ nameì„ ì‚¬ìš©í•œë‹¤
function GrandChild({ name }: { name: string }) {
  return <div>Hello {name}</div>;
}
```

ì´ê²ƒì´ ë°”ë¡œ **Prop Drilling**ì´ë‹¤.

`name`ì„ ì‹¤ì œë¡œ ì‚¬ìš©í•˜ëŠ” ê±´ `GrandChild`ë¿ì¸ë°, `Parent`ì™€ `Child`ëŠ” ë‹¨ì§€ ì „ë‹¬ë§Œ í•œë‹¤. ì¤‘ê°„ ì»´í¬ë„ŒíŠ¸ë“¤ì€ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ì„œë„, ë‹¨ì§€ í•˜ìœ„ë¡œ ì „ë‹¬í•˜ê¸° ìœ„í•´ì„œë§Œ ë°›ì•„ì•¼ í•œë‹¤.

**ë¬¸ì œëŠ” ë¬´ì—‡ì¼ê¹Œ?**

1. **ë¶ˆí•„ìš”í•œ ì˜ì¡´ì„±**: `Parent`, `Child`ëŠ” `name`ì„ ì „í˜€ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë° propsë¡œ ë°›ì•„ì•¼ í•œë‹¤
2. **ì¬ì‚¬ìš© ë¶ˆê°€ëŠ¥**: `Child`ë¥¼ ë‹¤ë¥¸ ê³³ì—ì„œ ì“°ë ¤ë©´? `name` propsë¥¼ ë¬´ì¡°ê±´ ì „ë‹¬í•´ì•¼ í•œë‹¤
3. **íƒ€ì… ë³€ê²½ ì‹œ í­íƒ„ ëŒë¦¬ê¸°**: `name` íƒ€ì…ì´ ë°”ë€Œë©´ ëª¨ë“  ì¤‘ê°„ ì»´í¬ë„ŒíŠ¸ë¥¼ ìˆ˜ì •í•´ì•¼ í•œë‹¤
4. **ì½”ë“œ ê°€ë…ì„± ì €í•˜**: ì´ ì»´í¬ë„ŒíŠ¸ê°€ ì‹¤ì œë¡œ ë­˜ ì‚¬ìš©í•˜ëŠ”ì§€ í•œëˆˆì— ì•ˆ ë“¤ì–´ì˜¨ë‹¤

ê·¸ë ‡ë‹¤ë©´ ì–´ë–»ê²Œ í•´ê²°í• ê¹Œ? ë°”ë¡œ ì „ì—­ ìƒíƒœì˜ ë“±ì¥ ë°°ê²½ì´ë‹¤.

---

## Context APIëŠ” ì™œ ëŠë¦´ê¹Œ?

[`createContext`](https://react.dev/reference/react/createContext)ëŠ” React 16.3ì—ì„œ ì¶”ê°€ëœ ê³µì‹ í•´ê²°ì±…ì´ë‹¤. Props Drilling ì—†ì´ ë°ì´í„°ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.

```ts
import { createContext, useContext, useState } from "react";

interface User {
  name: string;
  role: string;
}

const UserContext = createContext<{
  user: User | null;
  setUser: (user: User | null) => void;
} | null>(null);

export function UserProvider({ children }) {
  const [user, setUser] = useState<User | null>(null);

  return (
    <UserContext.Provider value={{ user, setUser }}>
      {children}
    </UserContext.Provider>
  );
}

export function useUser() {
  const context = useContext(UserContext);
  if (!context) {
    throw new Error("useUserëŠ” UserProvider ì•ˆì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤");
  }
  return context;
}
```

ì´ì œ ì¤‘ê°„ ì»´í¬ë„ŒíŠ¸ë“¤ì´ propsë¥¼ ì „ë‹¬í•  í•„ìš”ê°€ ì—†ë‹¤.

```ts
function App() {
  return (
    <UserProvider>
      <Parent />
    </UserProvider>
  );
}

// ParentëŠ” nameì„ ëª°ë¼ë„ ëœë‹¤
function Parent() {
  return <Child />;
}

// Childë„ nameì„ ëª°ë¼ë„ ëœë‹¤
function Child() {
  return <GrandChild />;
}

// GrandChildë§Œ ì§ì ‘ ê°€ì ¸ê°„ë‹¤
function GrandChild() {
  const { user } = useUser();
  return <div>Hello {user?.name}</div>;
}
```

ê¹”ë”í•˜ë‹¤! Props Drilling ë¬¸ì œê°€ ì™„ë²½íˆ í•´ê²°ëë‹¤.

í•˜ì§€ë§Œ ì—¬ê¸°ì—” í•œê³„ê°€ ìˆë‹¤.

---

## Context APIì˜ í•œê³„ - ì„ íƒì  êµ¬ë… ë¶ˆê°€ëŠ¥

Context APIëŠ” í¸ë¦¬í•˜ì§€ë§Œ, ê·œëª¨ê°€ ì»¤ì§€ë©´ ì„±ëŠ¥ ì´ìŠˆê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤. **ì™œ ê·¸ëŸ´ê¹Œ?** Reactì˜ ë‚´ë¶€ ë Œë”ë§ ë©”ì»¤ë‹ˆì¦˜ì„ ì´í•´í•´ì•¼ í•œë‹¤.

### Contextì˜ ë Œë”ë§ ë©”ì»¤ë‹ˆì¦˜

Reactì˜ ContextëŠ” `êµ¬ë…-ë°œí–‰ íŒ¨í„´(Publish-Subscribe Pattern)`ìœ¼ë¡œ ë™ì‘í•œë‹¤. í•˜ì§€ë§Œ ì¤‘ìš”í•œ ì°¨ì´ê°€ ìˆë‹¤.

```ts
function UserProvider({ children }) {
  const [user, setUser] = useState<User | null>(null);
  const [theme, setTheme] = useState<"light" | "dark">("light");

  // value ê°ì²´ê°€ ìƒˆë¡œ ìƒì„±ë˜ë©´, Contextë¥¼ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ì¬í‰ê°€ëœë‹¤
  const value = { user, setUser, theme, setTheme };

  return <UserContext.Provider value={value}>{children}</UserContext.Provider>;
}
```

**í•µì‹¬ ë¬¸ì œ**: `user`ë‚˜ `theme` ì¤‘ **í•˜ë‚˜ë§Œ** ë°”ë€Œì–´ë„ `value` ê°ì²´ê°€ ìƒˆë¡œ ìƒì„±ëœë‹¤. ê·¸ëŸ¬ë©´ [`useContext`](https://react.dev/reference/react/useContext)ë¥¼ ì‚¬ìš©í•˜ëŠ” **ëª¨ë“ ** ì»´í¬ë„ŒíŠ¸ê°€ ì¬ë Œë”ë§ëœë‹¤.

```ts
// ParentëŠ” userë§Œ ì‚¬ìš©í•œë‹¤
function Parent() {
  const { user } = useUser(); // themeë„ valueì— í¬í•¨ë˜ì–´ ìˆìŒ
  return <div>{user?.name}</div>;
}

// ChildëŠ” themeë§Œ ì‚¬ìš©í•œë‹¤
function Child() {
  const { theme, setTheme } = useUser(); // userë„ valueì— í¬í•¨ë˜ì–´ ìˆìŒ
  return (
    <button onClick={() => setTheme(theme === "light" ? "dark" : "light")}>
      {theme} ëª¨ë“œ
    </button>
  );
}
```

**ë¬¸ì œ ë°œìƒ ì‹œë‚˜ë¦¬ì˜¤**:

1. `Child`ì—ì„œ í…Œë§ˆë¥¼ ë³€ê²½í•œë‹¤ (`light` â†’ `dark`)
2. `theme` stateê°€ ë³€ê²½ë˜ì–´ `value` ê°ì²´ê°€ ìƒˆë¡œ ìƒì„±ëœë‹¤
3. `Parent`ë„ ì¬ë Œë”ë§ëœë‹¤ (themeì„ ì „í˜€ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë°!)
4. ë°˜ëŒ€ë¡œ `user`ê°€ ë³€ê²½ë˜ë©´ `Child`ë„ ì¬ë Œë”ë§ëœë‹¤

### ì™œ ì„ íƒì  êµ¬ë…ì´ ì•ˆ ë ê¹Œ?

Reactì˜ ContextëŠ” **ê°’ ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ë‹¨ìœ„ë¡œ ì·¨ê¸‰**í•œë‹¤. `value` ê°ì²´ì˜ ì°¸ì¡°ê°€ ë°”ë€Œë©´, ê·¸ ì•ˆì˜ ì–´ë–¤ ì†ì„±ì´ ë°”ë€Œì—ˆëŠ”ì§€ ìƒê´€ì—†ì´ ëª¨ë“  Consumerê°€ ì¬í‰ê°€ëœë‹¤.

ë§ˆì¹˜ ìš°ìœ  í•œ íŒ©ì— ì—¬ëŸ¬ ê°€ì§€ê°€ ë“¤ì–´ìˆëŠ”ë°, í•˜ë‚˜ë§Œ ìƒí–ˆëŠ”ì§€ í™•ì¸í•˜ë ¤ë©´ ì „ì²´ë¥¼ ë‹¤ì‹œ ê²€ì‚¬í•´ì•¼ í•˜ëŠ” ê²ƒê³¼ ê°™ë‹¤.

### í•´ê²° ë°©ë²•ë“¤

1. Context ë¶„ë¦¬

```ts
// UserContextì™€ ThemeContextë¥¼ ë”°ë¡œ ë§Œë“ ë‹¤
const UserContext = createContext<UserContextType | null>(null);
const ThemeContext = createContext<ThemeContextType | null>(null);

function App() {
  return (
    <UserProvider>
      <ThemeProvider>
        <Dashboard />
      </ThemeProvider>
    </UserProvider>
  );
}
```

í•˜ì§€ë§Œ Contextê°€ ë§ì•„ì§€ë©´ **Provider Hell**ì´ ë°œìƒí•œë‹¤.

2. [`useMemo`](https://react.dev/reference/react/useMemo)ë¡œ ìµœì í™”

```ts
function UserProvider({ children }) {
  const [user, setUser] = useState<User | null>(null);

  // userë‚˜ setUserê°€ ë°”ë€” ë•Œë§Œ value ì¬ìƒì„±
  const value = useMemo(() => ({ user, setUser }), [user]);

  return <UserContext.Provider value={value}>{children}</UserContext.Provider>;
}
```

ë„ì›€ì´ ë˜ì§€ë§Œ, ê·¼ë³¸ì ì¸ í•´ê²°ì±…ì€ ì•„ë‹ˆë‹¤. **valueì˜ ì–´ë–¤ ë¶€ë¶„ì´ ë°”ë€Œì—ˆëŠ”ì§€ ì—¬ì „íˆ ì¶”ì í•  ìˆ˜ ì—†ë‹¤**.

3. ë” ë‚˜ì€ ëŒ€ì•ˆ - ì „ë¬¸ ë¼ì´ë¸ŒëŸ¬ë¦¬

Context APIì˜ í•œê³„ëŠ” ëª…í™•í•˜ë‹¤. `ì„ íƒì  êµ¬ë…(Selective Subscription)`ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ì „ì—­ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì€ ë°”ë¡œ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë§Œë“¤ì–´ì¡Œë‹¤.

---

## React 18ì˜ useSyncExternalStore - ê²Œì„ ì²´ì¸ì €

ì „ì—­ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì´ ì–´ë–»ê²Œ ì„ íƒì  êµ¬ë…ì„ êµ¬í˜„í•˜ëŠ”ì§€ ì´í•´í•˜ë ¤ë©´, React 18ì—ì„œ ì¶”ê°€ëœ [`useSyncExternalStore`](https://react.dev/reference/react/useSyncExternalStore) í›…ì„ ì•Œì•„ì•¼ í•œë‹¤.

### React 18 ì´ì „ì˜ ë¬¸ì œ - Tearing

React 18 ì´ì „ì—ëŠ” ì™¸ë¶€ ìŠ¤í† ì–´(React ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ ë°–ì˜ ìƒíƒœ)ë¥¼ êµ¬ë…í•  ë•Œ **Tearing** ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤.

**Tearingì´ë€?** ë™ì¼í•œ ìƒíƒœë¥¼ êµ¬ë…í•˜ëŠ” ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ê°€ **ì„œë¡œ ë‹¤ë¥¸ ê°’**ì„ í‘œì‹œí•˜ëŠ” í˜„ìƒì´ë‹¤.

```ts
// ì™¸ë¶€ ìŠ¤í† ì–´ (React ë°–)
let count = 0;
const listeners = new Set();

export const store = {
  getState: () => count,
  setState: (newCount) => {
    count = newCount;
    listeners.forEach((listener) => listener());
  },
  subscribe: (listener) => {
    listeners.add(listener);
    return () => listeners.delete(listener);
  },
};

// React 18 ì´ì „: useEffectë¡œ êµ¬ë… ì‹œë„
function useStore() {
  const [state, setState] = useState(store.getState());

  useEffect(() => {
    const unsubscribe = store.subscribe(() => {
      setState(store.getState());
    });
    return unsubscribe;
  }, []);

  return state;
}

// ë¬¸ì œ: Concurrent Rendering ì‹œ ì¼ì‹œì ìœ¼ë¡œ ë‹¤ë¥¸ ê°’ í‘œì‹œ ê°€ëŠ¥
function Parent() {
  const count = useStore(); // count: 5
  return <div>{count}</div>;
}

function Child() {
  const count = useStore(); // count: 4 (ì¼ì‹œì ìœ¼ë¡œ ë‹¤ë¥¸ ê°’!)
  return <div>{count}</div>;
}
```

Reactê°€ ë Œë”ë§ì„ ì¤‘ë‹¨í•˜ê³  ì¬ê°œí•  ë•Œ, ì™¸ë¶€ ìŠ¤í† ì–´ì˜ ê°’ì´ ë°”ë€Œë©´ ì»´í¬ë„ŒíŠ¸ë§ˆë‹¤ **ë‹¤ë¥¸ ìŠ¤ëƒ…ìƒ·**ì„ ë³´ê²Œ ë˜ëŠ” ê²ƒì´ë‹¤.

### useSyncExternalStoreì˜ í•´ê²°ì±…

React 18ì€ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ `useSyncExternalStore`ë¥¼ ì œê³µí•œë‹¤.

```ts
import { useSyncExternalStore } from "react";

function useStore() {
  return useSyncExternalStore(
    store.subscribe, // êµ¬ë… í•¨ìˆ˜
    store.getState, // ìƒíƒœ ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
    store.getState // ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ìš© (ì„ íƒ)
  );
}
```

**í•µì‹¬ ë™ì‘**:

1. `subscribe` í•¨ìˆ˜ë¡œ ì™¸ë¶€ ìŠ¤í† ì–´ ë³€ê²½ì„ êµ¬ë…í•œë‹¤
2. `getState` í•¨ìˆ˜ë¡œ í˜„ì¬ ìƒíƒœë¥¼ ê°€ì ¸ì˜¨ë‹¤
3. **Reactê°€ ë Œë”ë§ì„ ì¤‘ë‹¨/ì¬ê°œí•´ë„ í•­ìƒ ë™ì¼í•œ ìŠ¤ëƒ…ìƒ·ì„ ë³´ì¥**í•œë‹¤

### `Zustand`ì™€ `Jotai`ëŠ” ì–´ë–»ê²Œ í™œìš©í• ê¹Œ?

`Zustand`ëŠ” React 18 ì´í›„ ê¶Œì¥ë˜ëŠ” ë°©ì‹ëŒ€ë¡œ `useSyncExternalStore` ê¸°ë°˜ìœ¼ë¡œ ì™¸ë¶€ ìŠ¤í† ì–´ë¥¼ êµ¬í˜„í•˜ê³  ìˆë‹¤.

`Jotai`ëŠ” í˜„ì¬ `useReducer` + `useEffect` ê¸°ë°˜ì˜ ì»¤ìŠ¤í…€ êµ¬ë… ëª¨ë¸ì„ ì‚¬ìš©í•˜ì§€ë§Œ, `useSyncExternalStore`ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ëŠ” RFCê°€ ì—´ë¦° ìƒíƒœë‹¤.

> ì°¸ê³ : [Jotai RFC - Migrate to useSyncExternalStore](https://github.com/pmndrs/jotai/issues/2551)

**`Zustand`ì˜ ê²½ìš°**:

```ts
// ë‹¨ìˆœí™”í•œ Zustand êµ¬í˜„
function create(createState) {
  let state = createState(setState);
  const listeners = new Set();

  function setState(partial) {
    state = { ...state, ...partial };
    listeners.forEach((listener) => listener());
  }

  function subscribe(listener) {
    listeners.add(listener);
    return () => listeners.delete(listener);
  }

  function getState() {
    return state;
  }

  // useSyncExternalStore í™œìš©
  return function useStore(selector) {
    return useSyncExternalStore(
      subscribe,
      () => selector(getState()), // selectorë¡œ ì„ íƒí•œ ë¶€ë¶„ë§Œ
      () => selector(getState())
    );
  };
}
```

**`Jotai`ì˜ ê²½ìš°** (ì‹¤ì œ êµ¬í˜„ì´ ì•„ë‹ˆë¼, ê°œë…ì„ ì„¤ëª…í•˜ê¸° ìœ„í•œ ë‹¨ìˆœí™”ëœ ì˜ì‚¬ ì½”ë“œ):

```ts
// ë‹¨ìˆœí™”í•œ Jotai atom êµ¬í˜„ (ì‹¤ì œ êµ¬í˜„ê³¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ)
function atom(initialValue) {
  let value = initialValue;
  const listeners = new Set();

  return {
    read: () => value,
    write: (newValue) => {
      value = newValue;
      listeners.forEach((listener) => listener());
    },
    subscribe: (listener) => {
      listeners.add(listener);
      return () => listeners.delete(listener);
    },
  };
}

// ê°œë…ì  ì˜ˆì‹œ: ì‹¤ì œë¡œëŠ” useReducer ê¸°ë°˜ì´ì§€ë§Œ, ì™¸ë¶€ ìŠ¤í† ì–´ì²˜ëŸ¼ ë™ì‘í•œë‹¤ëŠ” ê°œë…
function useAtom(atom) {
  const [value, setValue] = useState(atom.read());

  useEffect(() => {
    return atom.subscribe(() => setValue(atom.read()));
  }, [atom]);

  return [value, atom.write];
}
```

`Jotai`ëŠ” ì‹¤ì œë¡œëŠ” **WeakMap ê¸°ë°˜ì˜ atom ìƒíƒœ í…Œì´ë¸”**ê³¼ **ì˜ì¡´ì„± ê·¸ë˜í”„**ë¥¼ ê´€ë¦¬í•˜ëŠ” í›¨ì”¬ ë³µì¡í•œ êµ¬í˜„ì„ ê°€ì§€ê³  ìˆë‹¤. ì´ ì½”ë“œëŠ” "ê° atomì´ ë…ë¦½ì ì¸ ì™¸ë¶€ ìŠ¤í† ì–´ì²˜ëŸ¼ ë™ì‘í•˜ê³ , í›…ì—ì„œ ì´ë¥¼ êµ¬ë…í•œë‹¤"ëŠ” ê°œë…ë§Œ ì´í•´í•˜ë©´ ëœë‹¤.

### ì™œ ì´ê²Œ ì¤‘ìš”í• ê¹Œ?

`useSyncExternalStore` ë•ë¶„ì— **`Zustand`ëŠ”**:

1. **Concurrent Renderingê³¼ í˜¸í™˜**ë˜ëŠ” ì™¸ë¶€ ìŠ¤í† ì–´ íŒ¨í„´ì„ ê³µì‹ì ìœ¼ë¡œ ë”°ë¥´ê³ 
2. **Tearing ì—†ì´** ì•ˆì „í•˜ê²Œ ìƒíƒœë¥¼ ì½ì„ ìˆ˜ ìˆìœ¼ë©°
3. **ì„ íƒì  êµ¬ë…**(selector ê¸°ë°˜)ì´ ê°€ëŠ¥í•˜ë‹¤

`Jotai` ì—­ì‹œ Concurrent Renderingì„ ê³ ë ¤í•œ ì„¤ê³„ë¥¼ í•˜ê³  ìˆì§€ë§Œ, ê¸°ë³¸ êµ¬í˜„ì€ ì•„ì§ `useSyncExternalStore` ê¸°ë°˜ì´ ì•„ë‹ˆê³ , í–¥í›„ ì´ë¥¼ ë„ì…í•˜ëŠ” RFCê°€ ë…¼ì˜ ì¤‘ì´ë‹¤.

`Context API`ëŠ” Reactê°€ ë‚´ë¶€ì ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ ë•ë¶„ì— ì•ˆì „í•˜ì§€ë§Œ, **ê°’ ì „ì²´ë¥¼ í•œ ë©ì–´ë¦¬ë¡œë§Œ ì „ë‹¬**í•˜ê¸° ë•Œë¬¸ì— "í•„ë“œ ë‹¨ìœ„ë¡œ ì„ íƒí•´ì„œ êµ¬ë…í•˜ëŠ” ê²ƒ" ê°™ì€ ë¯¸ì„¸í•œ ì œì–´ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•˜ì§€ ì•ŠëŠ”ë‹¤.

ë°˜ë©´ `Zustand`ì™€ `Jotai`ëŠ” `useSyncExternalStore`(ë˜ëŠ” ì´ì— ì¤€í•˜ëŠ” ì™¸ë¶€ ìŠ¤í† ì–´ íŒ¨í„´)ë¥¼ í™œìš©í•´ **React ë°–ì— ìƒíƒœ ì €ì¥ì†Œë¥¼ ë‘ê³ **, ê° ì»´í¬ë„ŒíŠ¸ê°€ **í•„ìš”í•œ ë¶€ë¶„ë§Œ ì„ íƒì ìœ¼ë¡œ êµ¬ë…**í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì–´ ìˆë‹¤.

---

## Zustand - useSyncExternalStoreë¡œ í•´ê²°í•˜ë‹¤

[Zustand](https://zustand.docs.pmnd.rs/)ëŠ” ë…ì¼ì–´ë¡œ "ìƒíƒœ"ë¥¼ ëœ»í•œë‹¤. 2025ë…„ ê°€ì¥ ë¹ ë¥´ê²Œ ì„±ì¥í•˜ëŠ” ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë‹¤.

**í•µì‹¬ ì² í•™**: "ê³°ì˜ í•„ìˆ˜í’ˆ(Bear necessities)" - ì •ë§ í•„ìš”í•œ ê¸°ëŠ¥ë§Œ ë‚¨ê¸°ê³  ëª¨ë‘ ì œê±°í–ˆë‹¤.

```ts
import { create } from "zustand";

interface User {
  name: string;
  role: string;
}

interface UserStore {
  user: User | null;
  theme: "light" | "dark";
  setUser: (user: User | null) => void;
  setTheme: (theme: "light" | "dark") => void;
}

export const useUserStore = create<UserStore>((set) => ({
  user: null,
  theme: "light",
  setUser: (user) => set({ user }),
  setTheme: (theme) => set({ theme }),
}));
```

ì´ê²Œ ì „ë¶€ë‹¤. Providerë„ í•„ìš” ì—†ë‹¤.

```ts
function Parent() {
  const user = useUserStore((state) => state.user);
  return <div>{user?.name}</div>;
}

function Child() {
  const theme = useUserStore((state) => state.theme);
  const setTheme = useUserStore((state) => state.setTheme);

  return (
    <button onClick={() => setTheme(theme === "light" ? "dark" : "light")}>
      {theme} ëª¨ë“œ
    </button>
  );
}
```

### `Zustand`ì˜ ë‚´ë¶€ ë™ì‘ ì›ë¦¬ - ì™œ ë¹ ë¥¼ê¹Œ?

`Zustand`ê°€ `Context API`ë³´ë‹¤ ë¹ ë¥¸ ì´ìœ ëŠ” `ì„ íƒì  êµ¬ë…(Selective Subscription)`ì´ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

1. Module-level ì €ì¥ì†Œ

`Zustand`ì˜ storeëŠ” **React ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ ì™¸ë¶€**ì— ì¡´ì¬í•œë‹¤.

```ts
// storeëŠ” ëª¨ë“ˆ ë ˆë²¨ì— ìƒì„±ë˜ì–´ ì „ì—­ì ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥
const store = createStore((set) => ({
  user: null,
  theme: "light",
  // ...
}));
```

ì´ëŠ” `Context API`ì™€ ê·¼ë³¸ì ìœ¼ë¡œ ë‹¤ë¥´ë‹¤. `Context`ëŠ” **Provider ì»´í¬ë„ŒíŠ¸ ì•ˆì—** ìƒíƒœê°€ ìˆì§€ë§Œ, `Zustand`ëŠ” **ë…ë¦½ì ì¸ ì €ì¥ì†Œ**ë¥¼ ê°–ëŠ”ë‹¤.

2. Selector ê¸°ë°˜ êµ¬ë…

`Zustand`ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ **í•„ìš”í•œ ë¶€ë¶„ë§Œ ì„ íƒí•´ì„œ êµ¬ë…**í•  ìˆ˜ ìˆë‹¤.

```ts
// userë§Œ êµ¬ë… - themeì´ ë°”ë€Œì–´ë„ ì¬ë Œë”ë§ ì•ˆ ë¨
const user = useUserStore((state) => state.user);

// themeë§Œ êµ¬ë… - userê°€ ë°”ë€Œì–´ë„ ì¬ë Œë”ë§ ì•ˆ ë¨
const theme = useUserStore((state) => state.theme);
```

**ì‹¤ì œ `Zustand` ë‚´ë¶€ êµ¬í˜„** (useSyncExternalStore ê¸°ë°˜):

```ts
import { useSyncExternalStore } from "react";

function create(createState) {
  // 1. ì™¸ë¶€ store ìƒì„± (React ë°–)
  let state;
  const listeners = new Set();

  const setState = (partial) => {
    const nextState = typeof partial === "function" ? partial(state) : partial;
    if (!Object.is(nextState, state)) {
      const previousState = state;
      state = Object.assign({}, state, nextState);
      // ëª¨ë“  êµ¬ë…ìì—ê²Œ ì•Œë¦¼
      listeners.forEach((listener) => listener(state, previousState));
    }
  };

  const getState = () => state;

  const subscribe = (listener) => {
    listeners.add(listener);
    return () => listeners.delete(listener); // cleanup
  };

  // ì´ˆê¸° ìƒíƒœ ì„¤ì •
  state = createState(setState, getState);

  // 2. React í›… ë°˜í™˜
  return function useStore(selector = (s) => s) {
    // useSyncExternalStoreë¡œ ì™¸ë¶€ ìŠ¤í† ì–´ êµ¬ë…
    return useSyncExternalStore(
      subscribe, // êµ¬ë… í•¨ìˆ˜
      () => selector(getState()), // í˜„ì¬ ìŠ¤ëƒ…ìƒ·
      () => selector(getState()) // SSRìš© ìŠ¤ëƒ…ìƒ·
    );
  };
}
```

**í•µì‹¬ ë™ì‘ ì›ë¦¬**:

1. **ì™¸ë¶€ ìŠ¤í† ì–´ ìƒì„±**: `state`ì™€ `listeners`ëŠ” React ì»´í¬ë„ŒíŠ¸ ë°–ì— ì¡´ì¬í•œë‹¤
2. **useSyncExternalStore í™œìš©**: Tearing ì—†ì´ ì•ˆì „í•˜ê²Œ ì™¸ë¶€ ìŠ¤í† ì–´ êµ¬ë…
3. **Selector ê¸°ë°˜ êµ¬ë…**: `selector(getState())`ë¡œ í•„ìš”í•œ ë¶€ë¶„ë§Œ ì„ íƒ
4. **ìë™ ë¹„êµ**: `useSyncExternalStore`ê°€ ë‚´ë¶€ì ìœ¼ë¡œ `Object.is()`ë¡œ ë¹„êµí•´ì„œ ë³€ê²½ëœ ê²½ìš°ì—ë§Œ ì¬ë Œë”ë§

**ì™œ ë¹ ë¥¼ê¹Œ?**

```ts
// user ë³€ê²½ ì‹œ
setState({ user: newUser });
// â†“
// listenersì—ê²Œ ì•Œë¦¼
// â†“
// ê° ì»´í¬ë„ŒíŠ¸ì˜ useSyncExternalStoreê°€ ì‹¤í–‰
// â†“
// selector(getState()) ì¬ê³„ì‚°
// â†“
// Object.is(newValue, oldValue) ë¹„êµ
// â†“
// userë¥¼ êµ¬ë…í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë§Œ ì¬ë Œë”ë§
```

- `Parent`ì˜ selector: `(state) => state.user` â†’ ë³€ê²½ë¨ â†’ ì¬ë Œë”ë§ âœ…
- `Child`ì˜ selector: `(state) => state.theme` â†’ ë³€ê²½ ì•ˆ ë¨ â†’ ì¬ë Œë”ë§ ì•ˆ í•¨ âŒ

ì´ê²ƒì´ `Context API`ì™€ì˜ ê²°ì •ì  ì°¨ì´ë‹¤. `Context`ëŠ” `value` ê°ì²´ ì „ì²´ë¥¼ ë¹„êµí•˜ì§€ë§Œ, `Zustand`ëŠ” **selectorê°€ ë°˜í™˜í•œ ê°’ë§Œ** ë¹„êµí•œë‹¤.

### ì„±ëŠ¥ ë¹„êµ: `Context API` vs `Zustand`

100ê°œì˜ ì»´í¬ë„ŒíŠ¸ê°€ ìˆê³ , ê°ê° ë‹¤ë¥¸ ìƒíƒœë¥¼ êµ¬ë…í•œë‹¤ê³  ê°€ì •í•˜ì.

**`Context API`**:

```ts
// user í•˜ë‚˜ë§Œ ë°”ë€Œì–´ë„
setUser(newUser);

// userë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” 99ê°œ ì»´í¬ë„ŒíŠ¸ë„ ì¬í‰ê°€ëœë‹¤
// (ì‹¤ì œ ì¬ë Œë”ë§ì€ React.memoë¡œ ë§‰ì„ ìˆ˜ ìˆì§€ë§Œ, ì¬í‰ê°€ëŠ” ë°œìƒ)
```

**`Zustand`**:

```ts
// user í•˜ë‚˜ë§Œ ë°”ë€Œë©´
setUser(newUser);

// userë¥¼ êµ¬ë…í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë§Œ ì¬ë Œë”ë§ëœë‹¤
// ë‚˜ë¨¸ì§€ 99ê°œëŠ” selectorê°€ ë‹¤ë¥¸ ê°’ì„ ë°˜í™˜í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ë¬´ì‹œ
```

**ì‹¤ì œ ì¸¡ì • ê²°ê³¼** (ì»¤ë®¤ë‹ˆí‹° ë²¤ì¹˜ë§ˆí¬):

- `Context API`: 50ê°œ í•„ë“œ í¼ì—ì„œ í•˜ë‚˜ ë³€ê²½ ì‹œ ~280ms
- `Zustand`: ë™ì¼ ìƒí™©ì—ì„œ ~45ms (ì•½ **6ë°° ë¹ ë¦„**)
- ë²ˆë“¤ ì‚¬ì´ì¦ˆ: `Zustand`ëŠ” **~1KB**ë¡œ `Context API`ë³´ë‹¤ ì‘ìŒ (`Context`ëŠ” React ë‚´ì¥)

> ì°¸ê³ : [React ìƒíƒœ ê´€ë¦¬ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬](https://github.com/dai-shi/will-this-react-global-state-work-in-concurrent-rendering)

### `Zustand`ì˜ ì¶”ê°€ ì¥ì 

1. ë¯¸ë“¤ì›¨ì–´ ì§€ì›

```ts
import { persist, devtools } from "zustand/middleware";

export const useUserStore = create<UserStore>()(
  devtools(
    persist(
      (set) => ({
        user: null,
        setUser: (user) => set({ user }),
      }),
      { name: "user-storage" } // localStorageì— ìë™ ì €ì¥
    )
  )
);
```

2. React ì™¸ë¶€ì—ì„œ ì‚¬ìš© ê°€ëŠ¥

```ts
// ì»´í¬ë„ŒíŠ¸ ë°–ì—ì„œë„ storeì— ì ‘ê·¼
const currentUser = useUserStore.getState().user;
useUserStore.getState().setUser(newUser);
```

3. íƒ€ì… ì•ˆì •ì„±

TypeScriptì™€ ì™„ë²½í•˜ê²Œ í†µí•©ëœë‹¤. íƒ€ì… ì¶”ë¡ ì´ ìë™ìœ¼ë¡œ ë™ì‘í•œë‹¤.

---

## Jotai - Atom ì˜ì¡´ì„± ê·¸ë˜í”„ì˜ ë§ˆë²•

[Jotai](https://jotai.org/)ëŠ” ì¼ë³¸ì–´ë¡œ "ìƒíƒœ"ë¥¼ ëœ»í•œë‹¤. Recoilì—ì„œ ì˜ê°ì„ ë°›ì•„ ë§Œë“¤ì–´ì¡Œì§€ë§Œ, ë” ê°€ë³ê³  ê°„ë‹¨í•˜ë‹¤.

**í•µì‹¬ ì² í•™**: **Bottom-up ì›ìì (Atomic) ìƒíƒœ ê´€ë¦¬** - í•„ìš”í•œ atomë§Œ ë§Œë“¤ê³ , ì¡°í•©í•´ì„œ ì‚¬ìš©í•œë‹¤.

```ts
import { atom } from "jotai";

// ê¸°ë³¸ atom
export const userAtom = atom<User | null>(null);
export const themeAtom = atom<"light" | "dark">("light");

// íŒŒìƒ atom - userAtomì´ ë³€ê²½ë˜ë©´ ìë™ìœ¼ë¡œ ì¬ê³„ì‚°
export const isLoggedInAtom = atom((get) => {
  const user = get(userAtom);
  return user !== null;
});

// Write atom - ë¡œì§ ìº¡ìŠí™”
export const logoutAtom = atom(
  null, // read í•¨ìˆ˜
  (get, set) => {
    set(userAtom, null);
  }
);
```

ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•˜ê¸°:

```ts
import { useAtom, useAtomValue, useSetAtom } from "jotai";

function Parent() {
  const [user, setUser] = useAtom(userAtom);
  const isLoggedIn = useAtomValue(isLoggedInAtom);

  return (
    <div>
      {isLoggedIn ? (
        <p>Hello {user?.name}</p>
      ) : (
        <button onClick={() => setUser({ name: "ë§¤íŠœ", role: "admin" })}>
          ë¡œê·¸ì¸
        </button>
      )}
    </div>
  );
}

function Child() {
  const [theme, setTheme] = useAtom(themeAtom);

  return (
    <button onClick={() => setTheme(theme === "light" ? "dark" : "light")}>
      {theme} ëª¨ë“œ
    </button>
  );
}
```

### `Jotai`ì˜ ë‚´ë¶€ ë™ì‘ ì›ë¦¬ - WeakMapê³¼ ì˜ì¡´ì„± ê·¸ë˜í”„

`Jotai`ì˜ í•µì‹¬ì€ **WeakMap ê¸°ë°˜ Atom Store**ì™€ **ì˜ì¡´ì„± ìë™ ì¶”ì **ì´ë‹¤.

**1. WeakMap ê¸°ë°˜ Atom Store**

ê° atomì€ ë…ë¦½ì ì¸ ì„¤ì •(config) ê°ì²´ì¼ ë¿ì´ë‹¤. ì‹¤ì œ ê°’ì€ `WeakMap`ì— ì €ì¥ëœë‹¤.

```ts
import { useSyncExternalStore } from "react";

// Atomì€ ê·¸ì € ì„¤ì • ê°ì²´
function atom(initialValue) {
  return {
    init: initialValue,
    read: (get) => get(atom), // ê¸°ë³¸ read í•¨ìˆ˜
    write: (get, set, update) => set(atom, update), // ê¸°ë³¸ write í•¨ìˆ˜
  };
}

// ì‹¤ì œ ê°’ê³¼ ì˜ì¡´ì„±ì€ WeakMapì— ì €ì¥
const atomStateMap = new WeakMap(); // atom -> { value, listeners, dependencies }

function getAtomState(atom) {
  if (!atomStateMap.has(atom)) {
    atomStateMap.set(atom, {
      value: atom.init,
      listeners: new Set(),
      dependencies: new Set(), // ì´ atomì´ ì˜ì¡´í•˜ëŠ” ë‹¤ë¥¸ atomë“¤
    });
  }
  return atomStateMap.get(atom);
}
```

**ì™œ WeakMapì¼ê¹Œ?**

- atom ê°ì²´ê°€ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ë˜ë©´ ìë™ìœ¼ë¡œ ìƒíƒœë„ ì œê±°ëœë‹¤
- ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¥¼ ë°©ì§€í•œë‹¤
- Providerë³„ë¡œ ë…ë¦½ì ì¸ WeakMapì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤ (ìŠ¤ì½”í”„ ë¶„ë¦¬)

**2. íŒŒìƒ Atomì˜ ì˜ì¡´ì„± ìë™ ì¶”ì **

```ts
const countAtom = atom(0);
const doubleCountAtom = atom((get) => {
  const count = get(countAtom); // get í˜¸ì¶œ ì‹œ ì˜ì¡´ì„± ê¸°ë¡
  return count * 2;
});
```

**ë‚´ë¶€ ë™ì‘**:

```ts
function useAtom(atom) {
  const getAtomValue = (targetAtom) => {
    const atomState = getAtomState(targetAtom);

    // íŒŒìƒ atomì´ë©´ ì˜ì¡´ì„± ì¶”ì í•˜ë©° ê³„ì‚°
    if (typeof targetAtom.read === "function") {
      const dependencies = new Set();

      const get = (dependencyAtom) => {
        dependencies.add(dependencyAtom); // ì˜ì¡´ì„± ê¸°ë¡
        return getAtomValue(dependencyAtom); // ì¬ê·€ì ìœ¼ë¡œ ê°’ ê°€ì ¸ì˜¤ê¸°
      };

      const value = targetAtom.read(get);
      atomState.dependencies = dependencies; // ì˜ì¡´ì„± ì €ì¥
      atomState.value = value;

      // ì˜ì¡´í•˜ëŠ” atomë“¤ì„ êµ¬ë…
      dependencies.forEach((dep) => {
        const depState = getAtomState(dep);
        depState.listeners.add(() => {
          // ì˜ì¡´ì„±ì´ ë³€ê²½ë˜ë©´ ì´ atomë„ ì¬ê³„ì‚°
          notify(targetAtom);
        });
      });
    }

    return atomState.value;
  };

  const notify = (targetAtom) => {
    const atomState = getAtomState(targetAtom);
    atomState.listeners.forEach((listener) => listener());
  };

  // useSyncExternalStoreë¡œ atom êµ¬ë…
  const value = useSyncExternalStore(
    (callback) => {
      const atomState = getAtomState(atom);
      atomState.listeners.add(callback);
      return () => atomState.listeners.delete(callback);
    },
    () => getAtomValue(atom),
    () => getAtomValue(atom)
  );

  const setValue = (update) => {
    const atomState = getAtomState(atom);
    atomState.value =
      typeof update === "function" ? update(atomState.value) : update;
    notify(atom);
  };

  return [value, setValue];
}
```

**3. ì˜ì¡´ì„± ê·¸ë˜í”„ ì˜ˆì‹œ**

```ts
const userAtom = atom({ name: "ë§¤íŠœ", age: 30 });

const userNameAtom = atom((get) => get(userAtom).name);
const doubleAgeAtom = atom((get) => get(userAtom).age * 2);
```

**ê·¸ë˜í”„ êµ¬ì¡°**:

```
userAtom
  â”œâ”€> userNameAtom (ì˜ì¡´)
  â””â”€> doubleAgeAtom (ì˜ì¡´)
```

**ë³€ê²½ ì „íŒŒ**:

```ts
// userAtom ë³€ê²½
setUserAtom({ name: "ì¡´", age: 35 });
// â†“
// userAtomì˜ listeners ì‹¤í–‰
// â†“
// userNameAtomê³¼ doubleAgeAtom ì¬ê³„ì‚°
// â†“
// ê° atomì„ êµ¬ë…í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë§Œ ì¬ë Œë”ë§
```

**í•µì‹¬ ì°¨ì´**:

- Zustand: **í•˜ë‚˜ì˜ í° store**ë¥¼ selectorë¡œ ìª¼ê°œì„œ êµ¬ë…
- Jotai: **ì‘ì€ atomë“¤**ì„ ì¡°í•©í•´ì„œ ì˜ì¡´ì„± ê·¸ë˜í”„ í˜•ì„±

```ts
// Zustand: Top-down
const useStore = create((set) => ({
  user: { name: "ë§¤íŠœ", age: 30 },
  theme: "light",
}));

const userName = useStore((s) => s.user.name); // selectorë¡œ ìª¼ê°œê¸°

// Jotai: Bottom-up
const userAtom = atom({ name: "ë§¤íŠœ", age: 30 });
const themeAtom = atom("light");
const userNameAtom = atom((get) => get(userAtom).name); // atom ì¡°í•©
```

3. Providerë¡œ ìŠ¤ì½”í”„ ë¶„ë¦¬ (ì„ íƒì )

```ts
import { Provider } from "jotai";

function App() {
  return (
    <Provider>
      <Dashboard />
    </Provider>
  );
}
```

Providerë¥¼ ì‚¬ìš©í•˜ë©´ atom ê°’ì„ **íŠ¹ì • ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ì— ê²©ë¦¬**í•  ìˆ˜ ìˆë‹¤. í…ŒìŠ¤íŠ¸ë‚˜ SSRì— ìœ ìš©í•˜ë‹¤.

### `Zustand` vs `Jotai` - ì–¸ì œ ë¬´ì—‡ì„ ì“¸ê¹Œ?

ë‘ ë¼ì´ë¸ŒëŸ¬ë¦¬ ëª¨ë‘ í›Œë¥­í•˜ì§€ë§Œ, ì² í•™ì´ ë‹¤ë¥´ë‹¤.

**`Zustand`: Top-down, ë‹¨ì¼ ì €ì¥ì†Œ**

```ts
// í•˜ë‚˜ì˜ storeì— ëª¨ë“  ìƒíƒœ
const useStore = create((set) => ({
  user: null,
  theme: "light",
  cart: [],
  notifications: [],
  // ... ëª¨ë“  ì „ì—­ ìƒíƒœê°€ ì—¬ê¸° ìˆìŒ
}));
```

**ì¥ì **:

- í•œëˆˆì— ëª¨ë“  ìƒíƒœë¥¼ ë³¼ ìˆ˜ ìˆë‹¤
- ë””ë²„ê¹…ì´ ì‰½ë‹¤ (í•˜ë‚˜ì˜ storeë§Œ í™•ì¸)
- ëŸ¬ë‹ ì»¤ë¸Œê°€ ë‚®ë‹¤

**ë‹¨ì **:

- ê·œëª¨ê°€ ì»¤ì§€ë©´ storeê°€ ê±°ëŒ€í•´ì§„ë‹¤
- íŒŒìƒ ìƒíƒœë¥¼ ë§Œë“¤ê¸° ë‹¤ì†Œ ë²ˆê±°ë¡­ë‹¤

**`Jotai`: Bottom-up, ì›ì ë‹¨ìœ„**

```ts
// ê°ê° ë…ë¦½ì ì¸ atom
const userAtom = atom(null);
const themeAtom = atom("light");
const cartAtom = atom([]);
const notificationsAtom = atom([]);
```

**ì¥ì **:

- íŒŒìƒ ìƒíƒœê°€ ê°„ë‹¨í•˜ë‹¤ (atomì„ ì¡°í•©)
- í•„ìš”í•œ ê²ƒë§Œ importí•´ì„œ ì‚¬ìš©
- React Suspenseì™€ ì™„ë²½ í†µí•©

**ë‹¨ì **:

- atomì´ ë§ì•„ì§€ë©´ ê´€ë¦¬ê°€ ë³µì¡í•  ìˆ˜ ìˆë‹¤
- ì´ˆë³´ìì—ê²Œ ê°œë…ì´ ë‹¤ì†Œ ìƒì†Œí•¨

**ì„ íƒ ê¸°ì¤€**:

| ìƒí™©                     | ì¶”ì²œ             |
| ------------------------ | ---------------- |
| ê°„ë‹¨í•œ ì „ì—­ ìƒíƒœ ëª‡ ê°œ   | `Zustand`        |
| ë³µì¡í•œ íŒŒìƒ ìƒíƒœê°€ ë§ìŒ  | `Jotai`          |
| íŒ€ì´ Redux íŒ¨í„´ì— ìµìˆ™í•¨ | `Zustand`        |
| React Suspense ì ê·¹ í™œìš© | `Jotai`          |
| ë²ˆë“¤ í¬ê¸°ê°€ ì •ë§ ì¤‘ìš”í•¨  | `Zustand` (~1KB) |
| íƒ€ì… ì•ˆì •ì„±ì´ ìµœìš°ì„      | ë‘˜ ë‹¤ í›Œë¥­í•¨     |

---

## ì„¸ ë¼ì´ë¸ŒëŸ¬ë¦¬, ë Œë”ë§ ë©”ì»¤ë‹ˆì¦˜ ë¹„êµ

ì§€ê¸ˆê¹Œì§€ ë°°ìš´ ë‚´ìš©ì„ ì •ë¦¬í•˜ì.

### ë Œë”ë§ ë©”ì»¤ë‹ˆì¦˜ ë¹„êµ

**`Context API`**:

```ts
// Providerì˜ valueê°€ ë°”ë€Œë©´
<UserContext.Provider value={{ user, theme }}>

// useContextë¥¼ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ì¬í‰ê°€ëœë‹¤
const { user } = useContext(UserContext); // themeì´ ë°”ë€Œì–´ë„ ì¬ë Œë”ë§
```

**`Zustand`**:

```ts
// selectorê°€ ë°˜í™˜í•˜ëŠ” ê°’ì´ ë°”ë€” ë•Œë§Œ ì¬ë Œë”ë§
const user = useUserStore((state) => state.user); // theme ë³€ê²½ â†’ ì¬ë Œë”ë§ ì•ˆ ë¨
const theme = useUserStore((state) => state.theme); // user ë³€ê²½ â†’ ì¬ë Œë”ë§ ì•ˆ ë¨
```

**`Jotai`**:

```ts
// êµ¬ë…í•œ atomì´ ë³€ê²½ë  ë•Œë§Œ ì¬ë Œë”ë§
const [user] = useAtom(userAtom); // themeAtom ë³€ê²½ â†’ ì¬ë Œë”ë§ ì•ˆ ë¨
const [theme] = useAtom(themeAtom); // userAtom ë³€ê²½ â†’ ì¬ë Œë”ë§ ì•ˆ ë¨
```

### ë‚´ë¶€ ë™ì‘ ë©”ì»¤ë‹ˆì¦˜ ë¹„êµ

|                     | Context API                   | Zustand                            | Jotai                                                       |
| ------------------- | ----------------------------- | ---------------------------------- | ----------------------------------------------------------- |
| **ì €ì¥ì†Œ ìœ„ì¹˜**     | React Component Tree          | Module-level (ì™¸ë¶€)                | WeakMap (ì „ì—­)                                              |
| **êµ¬ë… ë°©ì‹**       | `useContext(MyContext)`       | `useStore(selector)`               | `useAtom(myAtom)`                                           |
| **ì¬ë Œë”ë§ ì¡°ê±´**   | Provider value ë³€ê²½           | selector ë°˜í™˜ê°’ ë³€ê²½ (`Object.is`) | atom ê°’ ë³€ê²½ (`Object.is`)                                  |
| **ì„ íƒì  êµ¬ë…**     | âŒ ë¶ˆê°€ëŠ¥                     | âœ… selectorë¡œ ê°€ëŠ¥                 | âœ… atom ë‹¨ìœ„ë¡œ ê°€ëŠ¥                                         |
| **ì£¼ìš” API**        | `createContext`, `useContext` | `create`, `useStore`, `setState`   | `atom`, `useAtom`, `useSetAtom`                             |
| **ë™ê¸°í™” ë©”ì»¤ë‹ˆì¦˜** | Reactì˜ ë Œë”ë§ ì‚¬ì´í´         | `useSyncExternalStore`             | ì»¤ìŠ¤í…€ êµ¬ë… ëª¨ë¸ (í–¥í›„ `useSyncExternalStore` ë„ì… ë…¼ì˜ ì¤‘) |
| **íŒŒìƒ ìƒíƒœ**       | ìˆ˜ë™ ê³„ì‚° (useMemo)           | selector í•¨ìˆ˜                      | atom ì¡°í•© (ìë™ ì˜ì¡´ì„± ì¶”ì )                                |
| **êµ¬ë…ì ê´€ë¦¬**     | React ë‚´ë¶€                    | `Set<listener>`                    | atomë³„ `Set<listener>` (WeakMap)                            |
| **ìƒíƒœ ë¹„êµ**       | ì°¸ì¡° ë¹„êµ (===)               | `Object.is(prev, next)`            | `Object.is(prev, next)`                                     |
| **ë²ˆë“¤ í¬ê¸°**       | 0KB (ë‚´ì¥)                    | **~1KB**                           | **~4KB**                                                    |

**í•µì‹¬ ì°¨ì´ì **:

- **`Context API`**: Reactì˜ ë Œë”ë§ ì‹œìŠ¤í…œì— ì˜ì¡´. valueê°€ ë°”ë€Œë©´ ëª¨ë“  Consumerê°€ ì¬í‰ê°€ëœë‹¤.
- **`Zustand`**: `useSyncExternalStore`ë¡œ ì™¸ë¶€ ì €ì¥ì†Œë¥¼ êµ¬ë…. selector ë°˜í™˜ê°’ë§Œ ë¹„êµí•´ì„œ ì •ë°€í•œ ì¬ë Œë”ë§.
- **`Jotai`**: WeakMapì— atom ìƒíƒœë¥¼ ì €ì¥í•˜ê³ , ì˜ì¡´ì„± ê·¸ë˜í”„ë¥¼ í†µí•´ ë³€ê²½ ì‚¬í•­ì„ ì „íŒŒ.

### ì‹¤ì œ ì„±ëŠ¥ ì°¨ì´ (ì»¤ë®¤ë‹ˆí‹° ë²¤ì¹˜ë§ˆí¬)

**ì„±ëŠ¥ ë¹„êµ ì˜ˆì‹œ** (ë¼ì´ë¸ŒëŸ¬ë¦¬ ì €ìê°€ ë§Œë“  ë²¤ì¹˜ë§ˆí¬ ì¤‘ í•˜ë‚˜ì—ì„œ):

- **`Context API`**: ìˆ˜ë°± ms ìˆ˜ì¤€ (ëª¨ë“  Consumer ì¬í‰ê°€)
- **`Context API` + ë¶„ë¦¬/ìµœì í™”**: ìˆ˜ì‹­~100ms ì•ˆìª½
- **`Zustand` / `Jotai`**: ê°™ì€ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ìˆ˜ì‹­ ms ìˆ˜ì¤€

ì •í™•í•œ ìˆ«ìëŠ” ë²¤ì¹˜ë§ˆí¬ í™˜ê²½ê³¼ ì‹œë‚˜ë¦¬ì˜¤ì— ë”°ë¼ ë‹¬ë¼ì§€ì§€ë§Œ, ê³µí†µì ìœ¼ë¡œ "Contextì— í•˜ë‚˜ë¡œ ëª°ì•„ë„£ëŠ” ê²ƒë³´ë‹¤, ì„ íƒì  êµ¬ë…ì´ ê°€ëŠ¥í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì´ ì¬ë Œë”ë§ ë¹„ìš©ì„ í›¨ì”¬ ë‚®ì¶œ ìˆ˜ ìˆë‹¤"ëŠ” ë°©í–¥ì„±ì€ ì¼ê´€ë˜ê²Œ ë‚˜íƒ€ë‚œë‹¤.

**ë²ˆë“¤ í¬ê¸°** (ëŒ€ëµ, min+gzip):

- `Context API`: 0KB (React ë‚´ì¥)
- `Zustand`: **~1KB**
- `Jotai`: **~4KB**
- Redux Toolkit: **~13KB**

> ì°¸ê³ : [React ìƒíƒœ ê´€ë¦¬ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬](https://github.com/dai-shi/will-this-react-global-state-work-in-concurrent-rendering)

### ì–¸ì œ ë¬´ì—‡ì„ ì¨ì•¼ í• ê¹Œ?

**`Context API`ë¥¼ ì¨ë„ ë˜ëŠ” ê²½ìš°**:

- ìƒíƒœê°€ ìì£¼ ë³€ê²½ë˜ì§€ ì•ŠëŠ”ë‹¤ (í…Œë§ˆ, ì–¸ì–´ ì„¤ì •, í˜„ì¬ ì‚¬ìš©ì)
- ì†Œê·œëª¨ ì•± (5ê°œ ì´í•˜ì˜ ì „ì—­ ìƒíƒœ)
- ì¶”ê°€ ì˜ì¡´ì„±ì„ ì›í•˜ì§€ ì•ŠëŠ”ë‹¤

**`Zustand`ë¥¼ ì¨ì•¼ í•˜ëŠ” ê²½ìš°**:

- ìƒíƒœê°€ ìì£¼ ë³€ê²½ëœë‹¤ (ì¥ë°”êµ¬ë‹ˆ, ì‹¤ì‹œê°„ ì•Œë¦¼)
- ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ê°€ ë‹¤ì–‘í•œ ìƒíƒœë¥¼ êµ¬ë…í•œë‹¤
- ê°„ë‹¨í•œ APIë¥¼ ì›í•œë‹¤
- ë²ˆë“¤ í¬ê¸°ê°€ ì¤‘ìš”í•˜ë‹¤

**`Jotai`ë¥¼ ì¨ì•¼ í•˜ëŠ” ê²½ìš°**:

- íŒŒìƒ ìƒíƒœê°€ ë§ë‹¤ (ê³„ì‚°ëœ ê°’, í•„í„°ë§ëœ ëª©ë¡)
- React Suspenseë¥¼ í™œìš©í•œë‹¤
- Bottom-up ì„¤ê³„ë¥¼ ì„ í˜¸í•œë‹¤
- ì›ì ë‹¨ìœ„ë¡œ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ê³  ì‹¶ë‹¤

---

## í”í•œ ì‹¤ìˆ˜ë“¤

ì‹¤ë¬´ì—ì„œ ìì£¼ ë³´ëŠ” ì•ˆí‹°íŒ¨í„´ì„ í”¼í•˜ì.

### ì‹¤ìˆ˜ 1: ëª¨ë“  ê²ƒì„ ì „ì—­ìœ¼ë¡œ

```ts
// âŒ ë‚˜ìœ ì˜ˆ - ëª¨ë‹¬ ì—´ë¦¼/ë‹«í˜ë„ ì „ì—­ìœ¼ë¡œ
const useUIStore = create((set) => ({
  isLoginModalOpen: false,
  isSignupModalOpen: false,
  isDeleteConfirmOpen: false,
  // ... ëª¨ë“  UI ìƒíƒœë¥¼ ì „ì—­ìœ¼ë¡œ
}));

// âœ… ì¢‹ì€ ì˜ˆ - ë¡œì»¬ë¡œ ì¶©ë¶„í•œ ê²ƒì€ ë¡œì»¬ë¡œ
function LoginButton() {
  const [isModalOpen, setIsModalOpen] = useState(false);

  return (
    <>
      <button onClick={() => setIsModalOpen(true)}>ë¡œê·¸ì¸</button>
      {isModalOpen && <LoginModal onClose={() => setIsModalOpen(false)} />}
    </>
  );
}
```

**ì›ì¹™**: ìƒíƒœë¥¼ ê°€ëŠ¥í•œ í•œ ê°€ê¹Œìš´ ê³³ì— ë‘¬ë¼. ì´ë¥¼ [`State Colocation`](https://kentcdodds.com/blog/state-colocation-will-make-your-react-app-faster)ì´ë¼ê³  í•œë‹¤.

### ì‹¤ìˆ˜ 2: ì„œë²„ ìƒíƒœë¥¼ í´ë¼ì´ì–¸íŠ¸ ìƒíƒœì²˜ëŸ¼

```ts
// âŒ ë‚˜ìœ ì˜ˆ - API ë°ì´í„°ë¥¼ useStateì— ì €ì¥
function ProductList() {
  const [products, setProducts] = useState([]);
  const [loading, setLoading] = useState(false);

  useEffect(() => {
    setLoading(true);
    fetch("/api/products")
      .then((res) => res.json())
      .then((data) => {
        setProducts(data);
        setLoading(false);
      });
  }, []);

  return loading ? <div>ë¡œë”© ì¤‘...</div> : <ul>{/* ... */}</ul>;
}
```

**ì£¼ì˜**: [`useEffect`](https://react.dev/reference/react/useEffect)ì—ì„œ ìƒíƒœë¥¼ ì„¤ì •í•  ë•Œ ì˜ì¡´ì„± ë°°ì—´ì„ ì •í™•íˆ ì§€ì •í•´ì•¼ í•œë‹¤.

ì´ ì½”ë“œì˜ ë¬¸ì œì :

- ìºì‹±ì´ ì—†ë‹¤ (ì»´í¬ë„ŒíŠ¸ unmount ì‹œ ë°ì´í„° ì†Œì‹¤)
- ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ ê°™ì€ ë°ì´í„°ë¥¼ ì¤‘ë³µ ìš”ì²­í•œë‹¤
- ì—ëŸ¬ ì²˜ë¦¬, ì¬ì‹œë„, ë‚™ê´€ì  ì—…ë°ì´íŠ¸ê°€ ë³µì¡í•˜ë‹¤
- ë™ì¼í•œ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ì—ì„œ ê°ê° ê´€ë¦¬í•˜ë©´ ë¶ˆì¼ì¹˜ê°€ ë°œìƒí•œë‹¤

```ts
// âœ… ì¢‹ì€ ì˜ˆ - TanStack Query ì‚¬ìš©
import { useQuery } from "@tanstack/react-query";

function ProductList() {
  const { data: products, isLoading } = useQuery({
    queryKey: ["products"],
    queryFn: () => fetch("/api/products").then((res) => res.json()),
  });

  if (isLoading) return <div>ë¡œë”© ì¤‘...</div>;
  return <ul>{/* ... */}</ul>;
}
```

**í•µì‹¬**: ì„œë²„ì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„°ëŠ” **ìºì‹œ**ë‹¤. ìš°ë¦¬ê°€ ì™„ì „íˆ í†µì œí•  ìˆ˜ ì—†ë‹¤.

### ì‹¤ìˆ˜ 3: `Context`ë¥¼ ì„±ëŠ¥ ê³ ë ¤ ì—†ì´ ë‚¨ë°œ

```ts
// âŒ ë‚˜ìœ ì˜ˆ - ëª¨ë“  ìƒíƒœë¥¼ í•˜ë‚˜ì˜ Contextì—
const AppContext = createContext({
  user: null,
  theme: "light",
  language: "ko",
  cart: [],
  notifications: [],
  sidebar: { isOpen: false },
  // ... 10ê°œ ì´ìƒì˜ ìƒíƒœ
});

// themeë§Œ ë°”ë€Œì–´ë„ user, cartë¥¼ ì‚¬ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë„ ì¬ë Œë”ë§
```

```ts
// âœ… ì¢‹ì€ ì˜ˆ - Context ë¶„ë¦¬ ë˜ëŠ” Zustand ì‚¬ìš©
const useAppStore = create((set) => ({
  user: null,
  theme: "light",
  language: "ko",
  cart: [],
  // ... selectorë¡œ ì„ íƒì  êµ¬ë…
}));
```

### ì‹¤ìˆ˜ 4: ì¸¡ì •í•˜ì§€ ì•Šê³  ìµœì í™”

```ts
// âŒ ë‚˜ìœ ì˜ˆ - ì„±ëŠ¥ ë¬¸ì œë„ ì—†ëŠ”ë° ê³¼ë„í•œ ìµœì í™”
const memoizedUser = useMemo(() => user, [user]);
const memoizedTheme = useMemo(() => theme, [theme]);
const memoizedCallback = useCallback(() => {}, []);
// ... ëª¨ë“  ê²ƒì— useMemo, useCallback
```

**ì›ì¹™**: "ì¡°ê¸° ìµœì í™”ëŠ” ë§Œì•…ì˜ ê·¼ì›" - ë¨¼ì € ì¸¡ì •í•˜ê³ , ë¬¸ì œê°€ ìˆì„ ë•Œë§Œ ìµœì í™”í•˜ë¼.

[React DevTools Profiler](https://react.dev/learn/react-developer-tools)ë¡œ ì¸¡ì • í›„ íŒë‹¨í•˜ì.

ìµœê·¼ì—ëŠ” `React Compiler`ë¥¼ í™œìš©í•˜ëŠ” ë°©ë²•ë„ ë°©ë²•ì¼ ìˆ˜ ìˆë‹¤.

---

## ì–¸ì œ ë¬´ì—‡ì„ ì„ íƒí•  ê²ƒì¸ê°€

ì§€ê¸ˆê¹Œì§€ ë°°ìš´ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ì‹¤ì „ ì „ëµì„ ì •ë¦¬í•˜ì.

### ë‹¨ê³„ë³„ ì˜ì‚¬ê²°ì • í”Œë¡œìš°

```
1. ì´ ìƒíƒœë¥¼ ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ê°€ ê³µìœ í•˜ë‚˜?
   NO â†’ useState (ë¡œì»¬ ìƒíƒœ)
   YES â†’ ë‹¤ìŒìœ¼ë¡œ

2. ìƒíƒœê°€ ìì£¼ ë³€ê²½ë˜ë‚˜? (1ì´ˆì— ì—¬ëŸ¬ ë²ˆ)
   NO â†’ `Context API`ë„ ì¶©ë¶„
   YES â†’ ë‹¤ìŒìœ¼ë¡œ

3. íŒŒìƒ ìƒíƒœê°€ ë§ë‚˜? (ê³„ì‚°ëœ ê°’, í•„í„°ë§)
   YES â†’ `Jotai` (ì›ìì  ìƒíƒœ + ì˜ì¡´ì„± ê·¸ë˜í”„)
   NO â†’ `Zustand` (ê°„ë‹¨í•œ ì „ì—­ ìƒíƒœ)

4. ì„œë²„ì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„°ì¸ê°€?
   YES â†’ TanStack Query (ë‹¤ìŒ ê¸€ì—ì„œ ë‹¤ë£¸)
```

### `Context API`ë¥¼ ì„ íƒí•´ì•¼ í•˜ëŠ” ê²½ìš°

**ì „ì—­ì ìœ¼ë¡œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ì— ì˜í–¥ì„ ì£¼ëŠ” ìƒíƒœ**ì¼ ë•Œ:

```ts
// âœ… ì¢‹ì€ ì˜ˆ - ì¸ì¦ ìƒíƒœ
function App() {
  return (
    <AuthProvider>
      <Header /> {/* ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¼ UI ë³€ê²½ */}
      <Sidebar /> {/* ê¶Œí•œì— ë”°ë¼ ë©”ë‰´ í‘œì‹œ */}
      <Content /> {/* ì‚¬ìš©ì ì •ë³´ í‘œì‹œ */}
    </AuthProvider>
  );
}
```

**ì í•©í•œ ì‚¬ë¡€**:

- **ì¸ì¦ ìƒíƒœ**: ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ ì‹œ ì „ì²´ ì•±ì˜ UIê°€ ë³€ê²½ëœë‹¤
- **í…Œë§ˆ**: light/dark ì „í™˜ ì‹œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ì˜ ìŠ¤íƒ€ì¼ì´ ë°”ë€ë‹¤
- **ë‹¤êµ­ì–´ ì„¤ì •**: ì–¸ì–´ ë³€ê²½ ì‹œ ëª¨ë“  í…ìŠ¤íŠ¸ê°€ ë³€ê²½ëœë‹¤
- **í˜„ì¬ ì‚¬ìš©ì ì •ë³´**: í”„ë¡œí•„ ì´ë¯¸ì§€, ì´ë¦„ ë“± ì—¬ëŸ¬ ê³³ì—ì„œ í‘œì‹œëœë‹¤

**ì£¼ì˜ì‚¬í•­**:

- ìƒíƒœ ë³€ê²½ ë¹ˆë„ê°€ **ë‚®ì•„ì•¼** í•œë‹¤ (í•˜ë£¨ì— ëª‡ ë²ˆ ì •ë„)
- ì •ë§ë¡œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ì˜í–¥ì„ ë°›ëŠ”ì§€ í™•ì¸í•˜ë¼
- ìì£¼ ë³€ê²½ë˜ëŠ” ìƒíƒœ(ì¥ë°”êµ¬ë‹ˆ, ì•Œë¦¼)ëŠ” í”¼í•˜ë¼

### `Zustand`ë¥¼ ì„ íƒí•´ì•¼ í•˜ëŠ” ê²½ìš°

**ë¹ ë¥´ê²Œ ë³€ê²½ë˜ëŠ” ì „ì—­ ìƒíƒœ**ë¥¼ ë‹¤ë£° ë•Œ:

```ts
// âœ… ì¢‹ì€ ì˜ˆ - ì¥ë°”êµ¬ë‹ˆ
const useCartStore = create((set) => ({
  items: [],
  addItem: (item) =>
    set((state) => ({
      items: [...state.items, item],
    })),
  // updateQuantity, removeItem, clearCart ë“± ì¶”ê°€ ì•¡ì…˜ë“¤...
}));

// ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ê°€ ì„œë¡œ ë‹¤ë¥¸ ë¶€ë¶„ë§Œ êµ¬ë…
function CartButton() {
  const itemCount = useCartStore((s) => s.items.length);
  return <button>ì¥ë°”êµ¬ë‹ˆ ({itemCount})</button>;
}

function TotalPrice() {
  const total = useCartStore((s) =>
    s.items.reduce((sum, item) => sum + item.price * item.quantity, 0)
  );
  return <div>ì´ {total}ì›</div>;
}
```

**ì í•©í•œ ì‚¬ë¡€**:

- **ì¥ë°”êµ¬ë‹ˆ**: ì‹¤ì‹œê°„ ìˆ˜ëŸ‰ ë³€ê²½, ìƒí’ˆ ì¶”ê°€/ì‚­ì œê°€ ë¹ˆë²ˆí•˜ë‹¤
- **ì•Œë¦¼ ì‹œìŠ¤í…œ**: ìƒˆ ì•Œë¦¼ ë„ì°©, ì½ìŒ ì²˜ë¦¬ê°€ ìì£¼ ë°œìƒí•œë‹¤
- **UI ìƒíƒœ**: ì‚¬ì´ë“œë°” ì—´ë¦¼/ë‹«í˜, ëª¨ë‹¬ ê´€ë¦¬, íƒ­ ì „í™˜
- **í•„í„°/ì •ë ¬ ìƒíƒœ**: ê²€ìƒ‰ í•„í„°, ì •ë ¬ ê¸°ì¤€ì´ ìì£¼ ë°”ë€ë‹¤

**ì¥ì **:

- ë²ˆë“¤ í¬ê¸° **1KB ì•ˆíŒìœ¼ë¡œ** ê°€ë³ë‹¤ (ì¶”ê°€ ì˜ì¡´ì„± ë¶€ë‹´ ì—†ìŒ)
- Redux íŒ¨í„´ì— ìµìˆ™í•œ íŒ€ì´ ì‰½ê²Œ ì ìš©í•  ìˆ˜ ìˆë‹¤
- DevTools ì§€ì›ìœ¼ë¡œ ë””ë²„ê¹…ì´ í¸í•˜ë‹¤
- ê°„ë‹¨í•œ API (ëŸ¬ë‹ ì»¤ë¸Œê°€ ë‚®ìŒ)

### `Jotai`ë¥¼ ì„ íƒí•´ì•¼ í•˜ëŠ” ê²½ìš°

**ë³µì¡í•œ íŒŒìƒ ìƒíƒœ**ê°€ ë§ì„ ë•Œ:

```ts
// âœ… ì¢‹ì€ ì˜ˆ - íŒŒìƒ ìƒíƒœ ì¡°í•©
const productsAtom = atom([
  /* ì œí’ˆ ë¦¬ìŠ¤íŠ¸ */
]);
const categoryFilterAtom = atom("ì „ìê¸°ê¸°");
const minPriceAtom = atom(0);
const maxPriceAtom = atom(1000000);

// atomì„ ì¡°í•©í•´ì„œ íŒŒìƒ ìƒíƒœ ìƒì„±
const filteredProductsAtom = atom((get) => {
  const products = get(productsAtom);
  const category = get(categoryFilterAtom);
  const minPrice = get(minPriceAtom);
  const maxPrice = get(maxPriceAtom);

  return products.filter(
    (p) => p.category === category && p.price >= minPrice && p.price <= maxPrice
  );
});

// avgPriceAtom, totalCountAtom ë“± ì¶”ê°€ íŒŒìƒ atomë„ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ì¡°í•© ê°€ëŠ¥
```

ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” ì´ atomë“¤ì„ ì¡°í•©í•´ì„œ ì‚¬ìš©í•œë‹¤. `categoryFilterAtom`ì´ ë°”ë€Œë©´ `filteredProductsAtom`ì´ ìë™ìœ¼ë¡œ ì¬ê³„ì‚°ë˜ê³ , ì´ë¥¼ êµ¬ë…í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë§Œ ì¬ë Œë”ë§ëœë‹¤.

**ì í•©í•œ ì‚¬ë¡€**:

- **í•„í„°ë§ëœ ë¦¬ìŠ¤íŠ¸**: ê²€ìƒ‰ì–´, ì¹´í…Œê³ ë¦¬, ì •ë ¬ ê¸°ì¤€ì„ ì¡°í•©í•œ ë³µì¡í•œ í•„í„°
- **ê³„ì‚°ëœ ê°’**: í•©ê³„, í‰ê· , í†µê³„ë¥¼ ì—¬ëŸ¬ atomì—ì„œ íŒŒìƒ
- **ì˜ì¡´ì„± ì²´ì¸**: A atom â†’ B atom â†’ C atomì²˜ëŸ¼ ì—°ì‡„ì ì¸ ì˜ì¡´ì„±
- **ë¹„ë™ê¸° ìƒíƒœ + Suspense**: ë°ì´í„° ë¡œë”©ì„ Suspenseë¡œ ì²˜ë¦¬

**ì¥ì **:

- íŒŒìƒ ìƒíƒœ ê´€ë¦¬ê°€ **ë§¤ìš° ê°„ë‹¨**í•˜ë‹¤ (atom ì¡°í•©ë§Œìœ¼ë¡œ í•´ê²°)
- TypeScriptì™€ **ì™„ë²½ í˜¸í™˜**ëœë‹¤
- React Suspenseì™€ **ì™„ë²½ í†µí•©**ëœë‹¤
- í•„ìš”í•œ atomë§Œ ë§Œë“¤ì–´ì„œ ì‚¬ìš© (Bottom-up)

### ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¡°í•© ì˜ˆì‹œ

```ts
// Client StateëŠ” Zustandë¡œ
const useUIStore = create((set) => ({
  sidebar: { isOpen: false },
  modal: { activeModal: null },
  theme: "light",
}));

// Server StateëŠ” TanStack Queryë¡œ
function ProductList() {
  const { data, isLoading } = useQuery({
    queryKey: ["products"],
    queryFn: fetchProducts,
  });

  const sidebar = useUIStore((state) => state.sidebar);

  // Server Stateì™€ Client Stateë¥¼ í•¨ê»˜ ì‚¬ìš©
}
```

**í•µì‹¬**: í•œ ê°€ì§€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë§Œ ì¨ì•¼ í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤. **ëª©ì ì— ë§ê²Œ ì¡°í•©**í•˜ëŠ” ê²ƒì´ í˜„ëª…í•˜ë‹¤.

---

## ë§ˆë¬´ë¦¬ - ì„œë²„ ìƒíƒœì˜ ì„¸ê³„ë¡œ

ì§€ê¸ˆê¹Œì§€ **ë¡œì»¬ ìƒíƒœ**ì™€ **ì „ì—­ ìƒíƒœ**ë¥¼ ê¹Šì´ ìˆê²Œ ë‹¤ë¤˜ë‹¤. Props Drilling ë¬¸ì œë¶€í„° ì‹œì‘í•´ì„œ, Context APIì˜ ì„±ëŠ¥ í•œê³„, Zustandì™€ Jotaiì˜ ë‚´ë¶€ ë™ì‘ ì›ë¦¬ê¹Œì§€ ì‚´í´ë´¤ë‹¤.

í•˜ì§€ë§Œ ì‹¤ë¬´ì—ì„œ ê°œë°œí•˜ë‹¤ ë³´ë©´ ë˜ ë‹¤ë¥¸ ë¬¸ì œë¥¼ ë§ˆì£¼í•œë‹¤.

**ì´ëŸ° ê²½í—˜ ìˆì§€ ì•Šë‚˜?**

ì¢‹ì•„ìš” ë²„íŠ¼ì„ ëˆŒë €ë‹¤. ë„¤íŠ¸ì›Œí¬ íƒ­ì„ ë³´ë‹ˆ API ìš”ì²­ì€ ì„±ê³µí–ˆë‹¤ (`200 OK`). ê·¸ëŸ°ë° UIì—ëŠ” ì•„ë¬´ ë³€í™”ê°€ ì—†ë‹¤. ìƒˆë¡œê³ ì¹¨ì„ í•´ë³´ë‹ˆ ì¢‹ì•„ìš”ê°€ **ì·¨ì†Œ**ë˜ì–´ ìˆë‹¤. ë¶„ëª…íˆ ëˆŒë €ëŠ”ë°!

```ts
// ì´ë ‡ê²Œ ì‘ì„±í–ˆì„ ê²ƒì´ë‹¤
function LikeButton({ postId }) {
  const [isLiked, setIsLiked] = useState(false);

  const handleLike = async () => {
    setIsLiked(true); // ë¨¼ì € UI ì—…ë°ì´íŠ¸

    try {
      await fetch(`/api/posts/${postId}/like`, { method: "POST" });
    } catch (error) {
      setIsLiked(false); // ì‹¤íŒ¨í•˜ë©´ ë˜ëŒë¦¬ê¸°
      // ê·¸ëŸ°ë° ì„±ê³µí–ˆëŠ”ë°ë„ ì„œë²„ ìƒíƒœì™€ ì•ˆ ë§ëŠ” ê²½ìš°ëŠ”?
    }
  };

  return <button onClick={handleLike}>{isLiked ? "â¤ï¸" : "ğŸ¤"}</button>;
}
```

**ë¬¸ì œì˜ ë³¸ì§ˆ**: ì§€ê¸ˆê¹Œì§€ ë‹¤ë£¬ ìƒíƒœ ê´€ë¦¬ëŠ” ëª¨ë‘ **í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ**ì˜€ë‹¤. ìš°ë¦¬ê°€ ì™„ì „íˆ í†µì œí•  ìˆ˜ ìˆëŠ” ìƒíƒœ. í…Œë§ˆë¥¼ `light`ë¡œ ì„¤ì •í•˜ë©´, ë‹¤ë¥¸ ìš”ì¸ì— ì˜í•´ ê°‘ìê¸° `dark`ë¡œ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤.

í•˜ì§€ë§Œ **ì„œë²„ ìƒíƒœ**ëŠ” ë‹¤ë¥´ë‹¤:

- ìš°ë¦¬ê°€ ì™„ì „íˆ í†µì œí•  ìˆ˜ ì—†ë‹¤ (ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ë°”ê¿€ ìˆ˜ ìˆìŒ)
- ë„¤íŠ¸ì›Œí¬ ì§€ì—°ì´ ìˆë‹¤ (ë¹„ë™ê¸°)
- ì‹ ì„ ë„ê°€ ìˆë‹¤ (ì‹œê°„ì´ ì§€ë‚˜ë©´ ë§Œë£Œë¨)
- ìºì‹±ì´ í•„ìš”í•˜ë‹¤ (ê°™ì€ ë°ì´í„°ë¥¼ ë°˜ë³µ ìš”ì²­í•˜ë©´ ë‚­ë¹„)

`useState`ë‚˜ `Zustand`ë¡œ ì„œë²„ ë°ì´í„°ë¥¼ ê´€ë¦¬í•˜ë ¤ë©´:

- ìˆ˜ë™ìœ¼ë¡œ ìºì‹± ë¡œì§ì„ ì‘ì„±í•´ì•¼ í•œë‹¤
- ë‚™ê´€ì  ì—…ë°ì´íŠ¸(Optimistic Update)ë¥¼ ì§ì ‘ êµ¬í˜„í•´ì•¼ í•œë‹¤
- ë°ì´í„° ë™ê¸°í™”(ì„œë²„ â†” í´ë¼ì´ì–¸íŠ¸)ë¥¼ ì‹ ê²½ ì¨ì•¼ í•œë‹¤
- ì—ëŸ¬ ì²˜ë¦¬, ì¬ì‹œë„, ë¡œë”© ìƒíƒœë¥¼ ëª¨ë‘ ê´€ë¦¬í•´ì•¼ í•œë‹¤

**ì´ê²ƒì´ ë°”ë¡œ TanStack Query(React Query), SWR, RTK Query ê°™ì€ ë„êµ¬ê°€ í•„ìš”í•œ ì´ìœ ë‹¤.**

---

## í•µì‹¬ ì •ë¦¬

**ë¡œì»¬ ìƒíƒœ**ëŠ” í•œ ì»´í¬ë„ŒíŠ¸ì—ì„œë§Œ ì‚¬ìš©í•œë‹¤. í¼ ì…ë ¥ê°’, ëª¨ë‹¬ ì—´ë¦¼/ë‹«í˜ì²˜ëŸ¼ ê³µìœ í•  í•„ìš” ì—†ëŠ” ìƒíƒœëŠ” `useState`ë¡œ ì¶©ë¶„í•˜ë‹¤.

**Props Drilling**ì€ ì—¬ëŸ¬ ë‹¨ê³„ë¥¼ ê±°ì³ propsë¥¼ ì „ë‹¬í•´ì•¼ í•˜ëŠ” ë¬¸ì œë‹¤. ì¤‘ê°„ ì»´í¬ë„ŒíŠ¸ê°€ ì‚¬ìš©í•˜ì§€ë„ ì•ŠëŠ” ê°’ì„ ì „ë‹¬ë§Œ í•˜ê²Œ ëœë‹¤.

`Context API`ëŠ” Props Drillingì„ í•´ê²°í•˜ì§€ë§Œ, `Provider`ì˜ valueê°€ ë°”ë€Œë©´ ëª¨ë“  Consumerê°€ ì¬í‰ê°€ëœë‹¤. **ì„ íƒì  êµ¬ë…ì´ ë¶ˆê°€ëŠ¥**í•˜ë‹¤.

`Zustand`ëŠ” **module-level ì €ì¥ì†Œ**ì™€ **selector ê¸°ë°˜ êµ¬ë…**ìœ¼ë¡œ ì„±ëŠ¥ ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤. í•„ìš”í•œ ê°’ë§Œ ì„ íƒí•´ì„œ êµ¬ë…í•˜ë¯€ë¡œ, ë‹¤ë¥¸ ê°’ì´ ë°”ë€Œì–´ë„ ì¬ë Œë”ë§ë˜ì§€ ì•ŠëŠ”ë‹¤. ë²ˆë“¤ í¬ê¸° ì•½ 1KBë¡œ ë§¤ìš° ê°€ë³ë‹¤.

`Jotai`ëŠ” **ì›ì ë‹¨ìœ„ ìƒíƒœ**ì™€ **ì˜ì¡´ì„± ê·¸ë˜í”„**ë¡œ íŒŒìƒ ìƒíƒœë¥¼ ìš°ì•„í•˜ê²Œ ê´€ë¦¬í•œë‹¤. Bottom-up ë°©ì‹ìœ¼ë¡œ í•„ìš”í•œ atomë§Œ ë§Œë“¤ê³  ì¡°í•©í•œë‹¤. React Suspenseì™€ ì™„ë²½ í†µí•©ëœë‹¤.

**ì„±ëŠ¥ ì°¨ì´**ëŠ” ë Œë”ë§ ë©”ì»¤ë‹ˆì¦˜ì—ì„œ ë‚˜ì˜¨ë‹¤:

- `Context API`: value ë³€ê²½ â†’ ëª¨ë“  Consumer ì¬í‰ê°€
- `Zustand`: selector ê°’ ë³€ê²½ â†’ í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ë§Œ ì¬ë Œë”ë§
- `Jotai`: atom ë³€ê²½ â†’ ì˜ì¡´í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë§Œ ì¬ë Œë”ë§

**ì„ íƒ ê¸°ì¤€**:

- ì „ì—­ì ìœ¼ë¡œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ì— ì˜í–¥ (ì¸ì¦, í…Œë§ˆ) â†’ `Context API`
- ë¹ ë¥´ê²Œ ë³€ê²½ë˜ëŠ” ì „ì—­ ìƒíƒœ (ì¥ë°”êµ¬ë‹ˆ, ì•Œë¦¼) â†’ `Zustand`
- ë³µì¡í•œ íŒŒìƒ ìƒíƒœ (í•„í„°ë§, ê³„ì‚°) â†’ `Jotai`
- ì„œë²„ ë°ì´í„° (API ì‘ë‹µ, ìºì‹±) â†’ **TanStack Query**

**í•µì‹¬ ì›ì¹™**: ê°€ì¥ ê°„ë‹¨í•œ í•´ê²°ì±…ë¶€í„° ì‹œì‘í•˜ë¼. `useState` â†’ `Context API` â†’ `Zustand`/`Jotai` ìˆœì„œë¡œ ë³µì¡ë„ë¥¼ ë†’ì—¬ê°„ë‹¤. ì„±ëŠ¥ ë¬¸ì œëŠ” **ì¸¡ì • í›„ì—** ìµœì í™”í•œë‹¤.
